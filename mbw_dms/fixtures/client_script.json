[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Customer",
  "enabled": 1,
  "modified": "2024-03-27 16:15:00.499451",
  "module": "MBW DMS",
  "name": "Button iframe",
  "script": "\nfrappe.ui.form.on('Customer', {\n\trefresh(frm) {\n\t\t// your code here\n\t\tlet d = new frappe.ui.Dialog({\n\t\t    fields: [\n\t\t        {\n\t\t\t\t\t\t\n\t\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\t\tfieldname: \"html_1\",\n\t\t\t\t\t\toptions: '<div id=\"tab1-content\" style=\"height:100vh;width:100vw;\">Tổng hợp</div>'\n\t\t\t\t\t},\n\t\t        ]\n\t\t})\n\t\tconsole.log(frm.doc)\n\t\td.$wrapper.find('.modal-dialog').css(\"max-width\",\"100%\");\n\t\tlet address;\n\t\tif(frm.doc.customer_primary_address) {\n\t\t    address = frm.doc.customer_primary_address.split(\"-\")[0]\n\t\t}\n\t\tlet location\n\t\tif(frm.doc.customer_location_primary) {\n\t\t    let jsonLocation = JSON.parse(frm.doc.customer_location_primary);\n\t\t    location =[jsonLocation.long,jsonLocation.lat]\n\t\t}\n\t\t\t\tlet data ={\n        \"info_customer\": [\n                  {\n                    \"name\":frm.doc.name,\n                    \"address\": address || \"\",\n                    \"coordinate\": location || []\n                  }\n                ],\n                \"type_categories\": [\n                  \"supermarket\"\n                ],\n                \"isochones\": [\n                  {\n                    \"type\": \"distance\",\n                    \"vehicle\": \"bike\",\n                    \"value\": 500,\n                    \"color_outline\": \"db1616\"\n                  },\n                  {\n                    \"type\": \"time\",\n                    \"vehicle\": \"bike\",\n                    \"value\": 180,\n                    \"color_outline\": \"b915ab\"\n                  },\n                  {\n                    \"type\": \"radius\",\n                    \"value\": 1000,\n                    \"color_outline\": \"2e0beb\"\n                  }\n                ]\n              }\n  \n\tlet html_1 = `<div style=\"height:90vh;width:100%;\"><iframe src=\"https://analytic.apps.vgm.ai/EmbedCode/dashboard?config_dashboard=${encodeURIComponent(JSON.stringify(data))}\" title=\"Location Intelligence\" height=\"100%\" width=\"100%\"></iframe></div>`\n\t\tfrm.add_custom_button(__('VGM.AI'), function(){\n        d.fields_dict.html_1.$wrapper.html(html_1);\n        d.show()\n    });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Customer",
  "enabled": 1,
  "modified": "2024-01-22 10:53:06.689361",
  "module": "MBW DMS",
  "name": "Customer Location Script",
  "script": "frappe.ui.form.on(\"Customer\", {\n  refresh: function (frm) {\n     \n  },\nonload:async function(frm) {\n    console.log('list_address',frm.doc.__onload.addr_list)\n    let primaryAddressObj = frm.doc.__onload.addr_list.find(address => address.is_primary_address == 1)\n    if(primaryAddressObj) {\n        frm.set_value('customer_location_primary',primaryAddressObj.address_location)\n        frm.doc.save()\n    }\n\n},\n\n});",
  "view": "Form"
 }
]