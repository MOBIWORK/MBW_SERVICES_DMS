import{X as s,aS as V,a1 as Y,L as e,R as i,Q as n,P as o,a3 as A,a2 as K,O as L,U as c,a4 as P,br as z,a7 as O}from"./index-bp7WH_TP.js";import{H as X}from"./header-page-hHa6iPlP.js";import{a as $,b as G}from"./index.esm-Z04EGz0E.js";import{d as w}from"./dayjs.min-f0mYtcnE.js";import{u as Q}from"./useDebount-VSXmz3KJ.js";import{V as U}from"./VerticalAlignBottomOutlined-wfmQOJN5.js";import{D as x}from"./index-CkoHV6-M.js";import{I as p}from"./index-fCaYQ9X1.js";const J=[{title:"STT",dataIndex:"stt",key:"stt",render:(h,u,m)=>m+1},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code"},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name"},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type"},{title:"Địa chỉ",dataIndex:"customer_address",key:"customer_address"}];function W(){const[h,u]=s.useState([]),[m]=V(),[f,j]=s.useState(),[_,g]=s.useState(),[N,y]=s.useState(),[b,F]=s.useState(),[k,v]=s.useState(),[I,D]=s.useState(),[T,C]=s.useState([]),[S,M]=s.useState(""),d=t=>{console.log(t)},[q,R]=s.useState("");Q(q,500);const B=t=>{console.log("dataTableChid",t);const l=[{title:"STT",dataIndex:"stt",key:"stt",render:(a,r,H)=>H+1},{title:"Mã sản phẩm",dataIndex:"item_code",key:"item_code"},{title:"Tên sản phẩm",dataIndex:"item_name",key:"item_name"},{title:"Hạn sử dụng",dataIndex:"exp_time",key:"exp_time",render:(a,r)=>e.jsx("p",{children:w(r.exp_time*1e3).format("DD/MM/YYYY")})},{title:"Đơn vị tính",dataIndex:"item_unit",key:"item_unit"},{title:"Tồn",dataIndex:"quantity",key:"quantity"},{title:"Giá sản phẩm",dataIndex:"item_price",key:"item_price",render:(a,r)=>e.jsx("p",{children:Intl.NumberFormat().format(r.item_price)})},{title:"Tổng giá trị",dataIndex:"total",key:"total",render:(a,r)=>e.jsx("p",{children:Intl.NumberFormat().format(r.quantity*r.item_price)})},{title:"Ngày cập nhật",dataIndex:"update_at",key:"update_at",render:(a,r)=>e.jsx("p",{children:w(r.update_at*1e3).format("DD/MM/YYYY")})},{title:"Người cập nhật",dataIndex:"update_byname",key:"update_byname"}];return e.jsx(z,{columns:l,dataSource:t.items.map(a=>({...a,key:a.item_code})),pagination:!1})},E=t=>{if(console.log("val:",t),t.expire_from){let l=Date.parse(t.expire_from.$d)/1e3;j(l)}else j(void 0);if(t.expire_to){let l=Date.parse(t.expire_to.$d)/1e3;g(l)}else g(void 0);t.qty_inven_from?y(t.qty_inven_from):y(void 0),t.qty_inven_to?F(t.qty_inven_to):F(void 0),t.total_from?v(t.total_from):v(void 0),t.total_to?D(t.total_to):D(void 0)};return s.useEffect(()=>{(async()=>{const t=await Y.get("/api/method/mbw_dms.api.selling.product.list_product");let{result:l}=t;C(l.data.map(a=>({value:a.item_code,label:a.item_name,des:a.item_code})))})()},[]),s.useEffect(()=>{(async()=>{const t=await Y.get("/api/method/mbw_dms.api.report.inventory.get_customer_inventory",{params:{expire_from:f,expire_to:_,qty_inven_from:N,qty_inven_to:b,total_from:k,total_to:I,item_code:S}});u(t.result.map(l=>({...l,key:l.name})))})()},[f,_,N,b,k,I,S]),console.log("keydataCustomer",h),e.jsxs(e.Fragment,{children:[e.jsx(X,{title:"Báo cáo tồn kho khách hàng",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(U,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-xl pt-4",children:[e.jsxs(i,{className:"justify-between items-center w-full",children:[e.jsx(n,{span:14,children:e.jsx(i,{gutter:8,children:e.jsx(n,{span:8,children:e.jsx("div",{className:"flex justify-start items-center",children:e.jsx(o,{className:"w-[200px] border-none p-4",children:e.jsx(A,{filterOption:!1,onChange:t=>{M(t)},showSearch:!0,defaultValue:"",notFoundContent:null,onSearch:t=>R(t),options:[{label:"Sản phẩm",value:""},...T],optionRender:t=>(console.log("option:",t),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{role:"img","aria-label":t.data.label,className:"my-1",children:t.data.label}),e.jsx("span",{className:"text-xs !font-semibold",children:t.data.des})]})}))})})})})})}),e.jsx(n,{className:"mr-5",children:e.jsx("div",{className:"flex flex-wrap items-center",children:e.jsxs("div",{className:"flex justify-center items-center mr-4",children:[e.jsx(K,{placement:"bottom",dropdownRender:()=>e.jsxs("div",{className:"p-4 rounded-xl !bg-white w-[400px]",children:[e.jsx("div",{className:"text-base font-medium text-[#212B36] leading-5",children:"Bộ lọc"}),e.jsx("div",{className:"pt-6",children:e.jsxs(L,{form:m,onFinish:E,children:[e.jsx("div",{className:"font-semibold text-sm leading-5 text-[#212B36]",children:"Hạn sử dụng"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Ngày bắt đầu"}),e.jsx(o,{className:"pt-2",name:"expire_from",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:d})})]}),e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Kết thúc"}),e.jsx(o,{className:"pt-2",name:"expire_to",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:d})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Ngày cập nhật"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Ngày bắt đầu"}),e.jsx(o,{className:"pt-2",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:d})})]}),e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Kết thúc"}),e.jsx(o,{className:"pt-2",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:d})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Số lượng tồn kho"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Từ"}),e.jsx(o,{className:"pt-2",name:"qty_inven_from",children:e.jsx(p,{controls:!1,className:"w-full",placeholder:"0"})})]}),e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Đến"}),e.jsx(o,{className:"pt-2",name:"qty_inven_to",children:e.jsx(p,{controls:!1,className:"w-full",placeholder:"0"})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Tổng giá trị"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Từ"}),e.jsx(o,{className:"pt-2",name:"total_from",children:e.jsx(p,{controls:!1,className:"!bg-[#F5F7FA] w-full",placeholder:"0",suffix:"VND"})})]}),e.jsxs(n,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Đến"}),e.jsx(o,{className:"pt-2",name:"total_to",children:e.jsx(p,{controls:!1,className:"!bg-[#F5F7FA] w-full",placeholder:"0",suffix:"VND"})})]})]}),e.jsxs(i,{className:"justify-between pt-6 pb-4",children:[e.jsx("div",{}),e.jsxs("div",{children:[e.jsx(c,{className:"mr-3",onClick:t=>{t.preventDefault(),m.resetFields()},children:"Đặt lại"}),e.jsx(c,{type:"primary",onClick:()=>{m.submit()},children:"Áp dụng"})]})]})]})})]}),children:e.jsx(c,{onClick:t=>t.preventDefault(),className:"flex items-center text-nowrap !text-[13px] !leading-[21px] !font-normal  border-r-[0.1px] rounded-r-none h-9",icon:e.jsx($,{style:{fontSize:"20px"}}),children:"Bộ lọc"})}),e.jsx(c,{className:"border-l-[0.1px] rounded-l-none h-9",children:e.jsx(G,{style:{fontSize:"20px"}})})]})})})]}),e.jsx("div",{className:"p-4",children:e.jsx(P,{columns:J,expandable:{expandedRowRender:B,defaultExpandedRowKeys:["0"]},dataSource:h})})]})]})}function oe(){return e.jsxs(e.Fragment,{children:[e.jsx(O,{children:e.jsx("title",{children:" ReportCustomer"})}),e.jsx(W,{})]})}export{oe as default};
