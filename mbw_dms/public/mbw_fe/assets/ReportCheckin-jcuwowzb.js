import{Y as n,a3 as o,L as e,O as l,a5 as m,a6 as R,bv as M,a8 as H}from"./index-hb_gRLpY.js";import{H as V}from"./header-page-IQsWRpkl.js";import{u as h}from"./useDebount-KGhcXOCM.js";import{e as A}from"./data-u-VkVTNg.js";import{t as P}from"./index-tGTSx3zL.js";import{D as b}from"./index-_K4KxRt6.js";import{T as q}from"./index-xL7t5t3P.js";import{V as B}from"./VerticalAlignBottomOutlined-7ONHDdMT.js";const X=[{title:"STT",dataIndex:"stt",key:"stt",render:(c,t,x)=>x+1},{title:"Mã nhân viên",dataIndex:"employee_code",key:"employee_code",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.employee_code})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.employee_name})},{title:"Nhóm bán hàng",dataIndex:"saleperson",key:"saleperson",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.saleperson})},{title:"Ngày",dataIndex:"days",key:"days",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.days})},{title:"Thứ",dataIndex:"date",key:"date",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.date})},{title:"Giờ làm",dataIndex:"startwork",key:"startwork",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.startwork})},{title:"Giờ viếng thăm",dataIndex:"checkin",key:"checkin",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.checkin})},{title:"Số km tự động (km)",dataIndex:"kmauto",key:"kmauto",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmauto})},{title:"Số km di chuyển (km)",dataIndex:"kmmove",key:"kmmove",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmmove})},{title:"Vận tốc (km/h)",dataIndex:"speed",key:"kmmove",render:(c,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmmove})},{title:"Ghi chú",key:"note",render:()=>e.jsx("div",{className:"!w-[160px]",children:e.jsx("a",{children:"Xem ghi chú"})})}];function z(){const[c,t]=n.useState([]),[x,_]=n.useState([]),[p,S]=n.useState(),[f,C]=n.useState(""),[W,u]=n.useState();let y=h(f);const[F,J]=n.useState(""),[Q,k]=n.useState(""),[I,T]=n.useState([]),[U,j]=n.useState(""),[E,G]=n.useState("");let v=h(E,500);const[Z,N]=n.useState(""),[D,Y]=n.useState([]),[K,L]=n.useState("");let w=h(K,500);h(F,300);const g=s=>{console.log(s)};n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/mbw_dms.api.router.get_team_sale");_(P({data:s.result.map(i=>({title:i.name,value:i.name,...i})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:p,key_search:y}}),{message:i}=s;t(i.map(r=>({value:r.employee_code,label:r.employee_name||r.employee_code})))})()},[p,y]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:i}=s;T(i.map(r=>({value:r.value.trim(),label:r.value.trim()})))})()},[v]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:w,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:i}=s;Y(i.map(r=>({value:r.value,label:r.value})))})()},[w]);const O=s=>{const i=[{title:"Khách hàng",dataIndex:"customer",key:"customer",render:(r,a,d)=>e.jsxs("div",{className:"!w-[200]",children:[e.jsx("div",{children:a.customer}),e.jsx("div",{className:"text-[#637381]",children:a.customer_code})]})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.address})})},{title:"Loại khách",dataIndex:"typecustomer",key:"typecustomer",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.typecustomer})})},{title:"Nhóm khách",dataIndex:"groupcustomer",key:"groupcustomer",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.groupcustomer})})},{title:"Số điện thoại",dataIndex:"phonenumber",key:"phonenumber",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.phonenumber})})},{title:"Liên hệ",dataIndex:"contact",key:"contact",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.contact})})},{title:"Checkin",dataIndex:"checkin",key:"checkin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkin})})},{title:"Checkout",dataIndex:"checkout",key:"checkout",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkout})})},{title:"Số giờ viếng thăm",dataIndex:"timecheckin",key:"timecheckin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.timecheckin})})},{title:"Địa chỉ checkin",dataIndex:"addresscheckin",key:"addresscheckin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.addresscheckin})})},{title:"Khoảng cách checkin(km)",dataIndex:"distance",key:"distance",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.distance})})}];return e.jsx(M,{columns:i,pagination:!1})};return e.jsxs(e.Fragment,{children:[e.jsx(V,{title:"Báo cáo viếng thăm",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(B,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-md py-7 px-4 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs("div",{className:"flex justify-start items-center pt-2",children:[e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Từ ngày"}),e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Đến ngày"}),e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Nhóm bán hàng"}),e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Nhân viên bán hầng"}),e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Loại khách hàng"})]}),e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(b,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Từ ngày",onChange:g})}),e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(b,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Đến ngày",onChange:g})}),e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(q,{placeholder:"Nhóm bán hàng",allowClear:!0,treeData:x,onChange:s=>{S(s)},dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:400}})}),e.jsx(l,{name:"employee",className:"w-[200px] border-none mr-2",children:e.jsx(m,{filterOption:!1,notFoundContent:null,allowClear:!0,placeholder:"Tất cả nhân viên",onSearch:s=>{C(s)},options:c,onSelect:s=>{u(s)},onClear:()=>{u("")}})}),e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{options:A,placeholder:"Tất cả loại khách hàng",filterOption:!1,allowClear:!0,onSelect:s=>{k(s)},onClear:()=>k("")})})]}),e.jsxs("div",{className:"flex justify-start items-center pt-4",children:[e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Nhóm khách hàng"}),e.jsx(l,{className:"w-[200px] border-none mr-2",label:"Khu vực"})]}),e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:I,onSelect:s=>{j(s)},onSearch:s=>{G(s)},onClear:()=>j(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả nhóm khách hàng"})}),e.jsx(l,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:D,onSelect:s=>{N(s)},onSearch:s=>{L(s)},onClear:()=>N(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả khu vực"})})]}),e.jsx("div",{className:"pt-10",children:e.jsx(R,{bordered:!0,scroll:{x:!0},columns:X,expandable:{expandedRowRender:O,defaultExpandedRowKeys:["0"]}})})]})]})}function ce(){return e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsx("title",{children:" ReportCheckin"})}),e.jsx(z,{})]})}export{ce as default};
