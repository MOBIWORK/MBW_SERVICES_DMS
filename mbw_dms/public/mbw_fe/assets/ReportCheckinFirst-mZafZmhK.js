import{Y as s,a1 as D,L as e,R as y,P as g,ab as N,ad as R}from"./index-cZsQ1NVa.js";import{u as b,C as F}from"./index-n1A1lol-.js";import{a as T,u as j,P as n,R as E,F as M,D as z,m as P}from"./ReportHeader-Q4iLUmix.js";import"./index-YVsEsZ8S.js";import"./index.esm-0sVrLI4H.js";import"./data-u-VkVTNg.js";import"./VerticalAlignBottomOutlined-QKTDBMBn.js";function G(){const k=[{title:"STT",dataIndex:"stt",key:"stt",width:60,render:(r,t,_)=>e.jsx("span",{children:C(a,n,_)})},{title:"Nhóm bán hàng",dataIndex:"sales_team",key:"sales_team",render:(r,t)=>e.jsx("div",{children:t.sales_team})},{title:"Mã nhân viên",dataIndex:"employee_id",key:"employee_id",render:(r,t)=>e.jsx("div",{children:t.employee_id})},{title:"Tên nhân viên",dataIndex:"sales_person",key:"sales_person",render:(r,t)=>e.jsx("div",{children:t.sales_person})},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code",render:(r,t)=>e.jsx("div",{children:t.customer_code})},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name",render:(r,t)=>e.jsx("div",{children:t.customer_name})},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type",render:(r,t)=>e.jsx("div",{children:t.customer_type})},{title:"Nhóm khách hàng",dataIndex:"customer_group",key:"customer_group",render:(r,t)=>e.jsx("div",{children:t.customer_group})},{title:"Người liên hệ",dataIndex:"contact_person",key:"contact_person",render:(r,t)=>e.jsx("div",{className:"!w-[175px] truncate hover:whitespace-normal",children:t.contact_person})},{title:"SDT",dataIndex:"phone",key:"phone",render:(r,t)=>e.jsx("div",{children:t.phone})},{title:"Mã số thuế",dataIndex:"tax_id",key:"tax_id",render:(r,t)=>e.jsx("div",{children:t.tax_id})},{title:"Khu vực",dataIndex:"territory",key:"territory",render:(r,t)=>e.jsx("div",{children:t.territory})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,t)=>e.jsx("div",{className:"!w-[175px] truncate hover:whitespace-normal",children:t.address})},{title:"Ngày viếng thăm",dataIndex:"date_checkin",key:"date_checkin",render:(r,t)=>e.jsx("div",{children:t.date_checkin?.split("-")?.reverse()?.toString()?.replaceAll(",","-")})}],[x,v]=s.useState([]),[i,f]=s.useState(0),[a,d]=s.useState(1),I=b(),o=T(`${P}`),[w,S]=s.useState(!1),{startDate:c,endDate:l}=j(r=>r.date),C=(r,t,_)=>(r-1)*t+_+1,{sales_team:A,employee:p,customer_type:u,customer_group:m,territory:h}=j(r=>r.group);return s.useEffect(()=>{(async()=>{const r=await D.get("/api/method/mbw_dms.api.report.first_checkin_rp.first_checkin_report",{params:{page_size:n,page_number:a,sales_person:p,customer_group:m,customer_type:u,territory:h,from_date:c,to_date:l}});let{result:t}=r;v(t),f(t?.totals)})()},[a,p,m,u,h,c,l,w]),e.jsx(e.Fragment,{children:e.jsx(F,{header:e.jsx(E,{setRefresh:S,title:e.jsx("div",{className:"min-w-[230px] ",children:"Báo cáo thống kê khách hàng viếng thăm lần đầu"}),params:{report_type:"Report Customer Checkin",data_filter:{sales_person:p,customer_group:m,customer_type:u,territory:h,from_date:c,to_date:l}},file_name:"Report Customer Checkin.xlsx"}),children:e.jsxs("div",{className:"bg-white rounded-2xl pt-4 pb-7 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs(y,{gutter:[16,16],className:`flex ${o?"justify-end":"justify-between"} items-center w-full`,children:[!o&&e.jsx(g,{className:"ml-4 w-[78%]",children:e.jsx(y,{gutter:[8,8],className:"space-x-4",children:e.jsx(M,{setPage:d,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0})})}),e.jsx(g,{className:"!ml-4",children:e.jsx(z,{inputCustomerType:!0,inputCustomerGroup:!0,inputTerritory:!0,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0,setPage:d,matchMedia:!o})})]}),e.jsx("div",{className:"pt-5",children:e.jsx(N,{dataSource:x?.data?.map(r=>({...r,key:r.name})),bordered:!0,scroll:{x:3e3,y:x?.data?.length>0?I?.h*.55:void 0},pagination:i&&i>n?{pageSize:n,showSizeChanger:!1,total:i,current:a,onChange(r){d(r)}}:!1,columns:k})})]})})})}function Z(){return e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("title",{children:" ReportCheckinFirst"})}),e.jsx(G,{})]})}export{Z as default};
