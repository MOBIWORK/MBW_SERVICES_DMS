import{Y as s,a2 as D,L as e,R as y,P as g,ac as N,ae as R}from"./index-X6WAzSjf.js";import"https://cdn.jsdelivr.net/npm/nats.ws@1.29.2/+esm";import{C as b}from"./index-6V43VTva.js";import{u as F}from"./index-61KfrWaE.js";import{a as T,u as j,P as n,m as E}from"./useMediaQuery-6e_HmnXm.js";import{R as M,F as z}from"./ReportHeader-LHEBTRu9.js";import{D as P}from"./dropDownFilter-IctK-Qju.js";import"./VerticalAlignBottomOutlined-g3t7qk-i.js";import"./index.esm-wTMqk9Oe.js";import"./data-u-VkVTNg.js";import"./index-Psbtiitz.js";function G(){const k=[{title:"STT",dataIndex:"stt",key:"stt",width:60,render:(r,t,_)=>e.jsx("span",{children:C(a,n,_)})},{title:"Nhóm bán hàng",dataIndex:"sales_team",key:"sales_team",render:(r,t)=>e.jsx("div",{children:t.sales_team})},{title:"Mã nhân viên",dataIndex:"employee_id",key:"employee_id",render:(r,t)=>e.jsx("div",{children:t.employee_id})},{title:"Tên nhân viên",dataIndex:"sales_person",key:"sales_person",render:(r,t)=>e.jsx("div",{children:t.sales_person})},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code",render:(r,t)=>e.jsx("div",{children:t.customer_code})},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name",render:(r,t)=>e.jsx("div",{children:t.customer_name})},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type",render:(r,t)=>e.jsx("div",{children:t.customer_type})},{title:"Nhóm khách hàng",dataIndex:"customer_group",key:"customer_group",render:(r,t)=>e.jsx("div",{children:t.customer_group})},{title:"Người liên hệ",dataIndex:"contact_person",key:"contact_person",render:(r,t)=>e.jsx("div",{className:"!w-[175px] truncate hover:whitespace-normal",children:t.contact_person})},{title:"SDT",dataIndex:"phone",key:"phone",render:(r,t)=>e.jsx("div",{children:t.phone})},{title:"Mã số thuế",dataIndex:"tax_id",key:"tax_id",render:(r,t)=>e.jsx("div",{children:t.tax_id})},{title:"Khu vực",dataIndex:"territory",key:"territory",render:(r,t)=>e.jsx("div",{children:t.territory})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,t)=>e.jsx("div",{className:"!w-[175px] truncate hover:whitespace-normal",children:t.address})},{title:"Ngày viếng thăm",dataIndex:"date_checkin",key:"date_checkin",render:(r,t)=>e.jsx("div",{children:t.date_checkin?.split("-")?.reverse()?.toString()?.replaceAll(",","-")})}],[x,f]=s.useState([]),[i,v]=s.useState(0),[a,o]=s.useState(1),I=F(),d=T(`${E}`),[w,S]=s.useState(!1),{startDate:c,endDate:l}=j(r=>r.date),C=(r,t,_)=>(r-1)*t+_+1,{sales_team:A,employee:p,customer_type:m,customer_group:u,territory:h}=j(r=>r.group);return s.useEffect(()=>{(async()=>{const r=await D.get("/api/method/mbw_dms.api.report.first_checkin_rp.first_checkin_report",{params:{page_size:n,page_number:a,sales_person:p,customer_group:u,customer_type:m,territory:h,from_date:c,to_date:l}});let{result:t}=r;f(t),v(t?.totals)})()},[a,p,u,m,h,c,l,w]),e.jsx(e.Fragment,{children:e.jsx(b,{header:e.jsx(M,{setRefresh:S,title:e.jsx("div",{className:"min-w-[230px] ",children:"Báo cáo thống kê khách hàng viếng thăm lần đầu"}),params:{report_type:"Report Customer Checkin",data_filter:{sales_person:p,customer_group:u,customer_type:m,territory:h,from_date:c,to_date:l}},file_name:"Report Customer Checkin.xlsx"}),children:e.jsxs("div",{className:"bg-white rounded-2xl pt-4 pb-7 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs(y,{gutter:[16,16],className:`flex ${d?"justify-end":"justify-between"} items-center w-full`,children:[!d&&e.jsx(g,{className:"ml-4 w-[78%]",children:e.jsx(y,{gutter:[8,8],className:"space-x-4",children:e.jsx(z,{setPage:o,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0})})}),e.jsx(g,{className:"!ml-4",children:e.jsx(P,{inputCustomerType:!0,inputCustomerGroup:!0,inputTerritory:!0,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0,setPage:o,matchMedia:!d})})]}),e.jsx("div",{className:"pt-5",children:e.jsx(N,{dataSource:x?.data?.map(r=>({...r,key:r.name})),bordered:!0,scroll:{x:3e3,y:x?.data?.length>0?I?.h*.55:void 0},pagination:i&&i>n?{pageSize:n,showSizeChanger:!1,total:i,current:a,onChange(r){o(r)}}:!1,columns:k})})]})})})}function U(){return e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx("title",{children:" ReportCheckinFirst"})}),e.jsx(G,{})]})}export{U as default};
