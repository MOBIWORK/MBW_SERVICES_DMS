import{Y as n,a3 as o,L as e,N as O,R as M,O as d,a5 as m,a6 as H,bv as V,a8 as A}from"./index-diwCb8Hq.js";import{H as P}from"./header-page-nAdL1FFk.js";import{C as q}from"./index-1WmXdaNi.js";import{u as h}from"./useDebount-TYGsy433.js";import{e as B}from"./data-u-VkVTNg.js";import{t as X}from"./index-v6yy1zdl.js";import{D as N}from"./index-W9ACibL3.js";import{T as z}from"./index-_ET6Xo9_.js";import{V as W}from"./VerticalAlignBottomOutlined-diBKv2y8.js";const J=[{title:"STT",dataIndex:"stt",key:"stt",render:(l,s,x)=>x+1},{title:"Mã nhân viên",dataIndex:"employee_code",key:"employee_code",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.employee_code})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.employee_name})},{title:"Nhóm bán hàng",dataIndex:"saleperson",key:"saleperson",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.saleperson})},{title:"Ngày",dataIndex:"days",key:"days",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.days})},{title:"Thứ",dataIndex:"date",key:"date",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.date})},{title:"Giờ làm",dataIndex:"startwork",key:"startwork",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.startwork})},{title:"Giờ viếng thăm",dataIndex:"checkin",key:"checkin",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.checkin})},{title:"Số km tự động (km)",dataIndex:"kmauto",key:"kmauto",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmauto})},{title:"Số km di chuyển (km)",dataIndex:"kmmove",key:"kmmove",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmmove})},{title:"Vận tốc (km/h)",dataIndex:"speed",key:"kmmove",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmmove})},{title:"Ghi chú",key:"note",render:()=>e.jsx("div",{className:"!w-[160px]",children:e.jsx("a",{children:"Xem ghi chú"})})}];function Q(){const[l,s]=n.useState([]),[x,b]=n.useState([]),[p,S]=n.useState(),[f,C]=n.useState(""),[U,u]=n.useState();let y=h(f);const[F,Z]=n.useState(""),[$,k]=n.useState(""),[T,I]=n.useState([]),[ee,j]=n.useState(""),[E,G]=n.useState("");let v=h(E,500);const[te,g]=n.useState(""),[D,Y]=n.useState([]),[K,L]=n.useState("");let w=h(K,500);h(F,300);const _=t=>{console.log(t)};n.useEffect(()=>{(async()=>{let t=await o.get("/api/method/mbw_dms.api.router.get_team_sale");b(X({data:t.result.map(c=>({title:c.name,value:c.name,...c})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),n.useEffect(()=>{(async()=>{let t=await o.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:p,key_search:y}}),{message:c}=t;s(c.map(r=>({value:r.employee_code,label:r.employee_name||r.employee_code})))})()},[p,y]),n.useEffect(()=>{(async()=>{let t=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:c}=t;I(c.map(r=>({value:r.value.trim(),label:r.value.trim()})))})()},[v]),n.useEffect(()=>{(async()=>{let t=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:w,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:c}=t;Y(c.map(r=>({value:r.value,label:r.value})))})()},[w]);const R=t=>{const c=[{title:"Khách hàng",dataIndex:"customer",key:"customer",render:(r,a,i)=>e.jsxs("div",{className:"!w-[200]",children:[e.jsx("div",{children:a.customer}),e.jsx("div",{className:"text-[#637381]",children:a.customer_code})]})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.address})})},{title:"Loại khách",dataIndex:"typecustomer",key:"typecustomer",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.typecustomer})})},{title:"Nhóm khách",dataIndex:"groupcustomer",key:"groupcustomer",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.groupcustomer})})},{title:"Số điện thoại",dataIndex:"phonenumber",key:"phonenumber",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.phonenumber})})},{title:"Liên hệ",dataIndex:"contact",key:"contact",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.contact})})},{title:"Checkin",dataIndex:"checkin",key:"checkin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkin})})},{title:"Checkout",dataIndex:"checkout",key:"checkout",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkout})})},{title:"Số giờ viếng thăm",dataIndex:"timecheckin",key:"timecheckin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.timecheckin})})},{title:"Địa chỉ checkin",dataIndex:"addresscheckin",key:"addresscheckin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.addresscheckin})})},{title:"Khoảng cách checkin(km)",dataIndex:"distance",key:"distance",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.distance})})}];return e.jsx(V,{columns:c,pagination:!1})};return e.jsx(e.Fragment,{children:e.jsx(q,{header:e.jsx(P,{title:"Báo cáo viếng thăm",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(W,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),children:e.jsxs("div",{className:"bg-white rounded-md pt-4 pb-7  border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsx(O,{layout:"vertical",className:"flex flex-wrap justify-start px-4 items-center",children:e.jsxs(M,{gutter:[8,8],children:[e.jsx(d,{label:"Từ ngày",className:"border-none mr-2 w-[175px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Từ ngày",onChange:_})}),e.jsx(d,{label:"Đến ngày",className:"border-none mr-2 w-[175px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Đến ngày",onChange:_})}),e.jsx(d,{label:"Nhóm bán hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(z,{placeholder:"Tất cả nhóm bán hàng",allowClear:!0,treeData:x,onChange:t=>{S(t)},dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:400}})}),e.jsx(d,{label:"Nhân viên",className:"border-none mr-2 w-[175px]",name:"employee",children:e.jsx(m,{filterOption:!1,notFoundContent:null,allowClear:!0,placeholder:"Tất cả nhân viên",onSearch:t=>{C(t)},options:l,onSelect:t=>{u(t)},onClear:()=>{u("")}})}),e.jsx(d,{label:"Loại khách hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{options:B,placeholder:"Tất cả loại khách hàng",filterOption:!1,allowClear:!0,onSelect:t=>{k(t)},onClear:()=>k("")})}),e.jsx(d,{label:"Nhóm khác hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:T,onSelect:t=>{j(t)},onSearch:t=>{G(t)},onClear:()=>j(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả nhóm khách hàng"})}),e.jsx(d,{label:"Khu vực",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:D,onSelect:t=>{g(t)},onSearch:t=>{L(t)},onClear:()=>g(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả khu vực"})})]})}),e.jsx("div",{className:"pt-5",children:e.jsx(H,{bordered:!0,scroll:{x:!0},columns:J,expandable:{expandedRowRender:R,defaultExpandedRowKeys:["0"]}})})]})})})}function me(){return e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsx("title",{children:" ReportCheckin"})}),e.jsx(Q,{})]})}export{me as default};
