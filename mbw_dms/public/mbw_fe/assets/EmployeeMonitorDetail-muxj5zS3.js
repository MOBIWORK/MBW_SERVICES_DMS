import{am as U,aw as Ce,ax as ke,an as pe,aB as ue,bF as fe,b7 as Ne,az as ze,h as Z,Y as o,aj as Ie,aG as je,bv as _e,bj as Fe,ac as le,ad as ce,L as t,a3 as Be,R as oe,P as Q,aC as ee,Q as ne,aT as be,bG as Pe,aP as J,V as re,a1 as se,aW as He,bH as Oe,b1 as De,ab as Ee}from"./index-sEvqgntM.js";import{D as Re}from"./date-picker-mbeVNqdZ.js";import{W as te,c as Ae,d as Y,r as We,l as Ze,p as K,f as ge,s as Ve,g as xe,e as qe,b as ye}from"./WrapperCard-jY1USh1b.js";import"./index-aBauodFf.js";const we=["wrap","nowrap","wrap-reverse"],Se=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],Me=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],Ge=(e,i)=>{const s={};return we.forEach(n=>{s[`${e}-wrap-${n}`]=i.wrap===n}),s},Ye=(e,i)=>{const s={};return Me.forEach(n=>{s[`${e}-align-${n}`]=i.align===n}),s[`${e}-align-stretch`]=!i.align&&!!i.vertical,s},Xe=(e,i)=>{const s={};return Se.forEach(n=>{s[`${e}-justify-${n}`]=i.justify===n}),s};function Qe(e,i){return U(Object.assign(Object.assign(Object.assign({},Ge(e,i)),Ye(e,i)),Xe(e,i)))}const Ue=e=>{const{componentCls:i}=e;return{[i]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},Je=e=>{const{componentCls:i}=e;return{[i]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},Ke=e=>{const{componentCls:i}=e,s={};return we.forEach(n=>{s[`${i}-wrap-${n}`]={flexWrap:n}}),s},et=e=>{const{componentCls:i}=e,s={};return Me.forEach(n=>{s[`${i}-align-${n}`]={alignItems:n}}),s},tt=e=>{const{componentCls:i}=e,s={};return Se.forEach(n=>{s[`${i}-justify-${n}`]={justifyContent:n}}),s},it=()=>({}),nt=Ce("Flex",e=>{const{paddingXS:i,padding:s,paddingLG:n}=e,a=ke(e,{flexGapSM:i,flexGap:s,flexGapLG:n});return[Ue(a),Je(a),Ke(a),et(a),tt(a)]},it,{resetStyle:!1});var rt=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const st=pe.forwardRef((e,i)=>{const{prefixCls:s,rootClassName:n,className:a,style:l,flex:m,gap:y,children:w,vertical:C=!1,component:S="div"}=e,f=rt(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:M,direction:P,getPrefixCls:_}=pe.useContext(ue),k=_("flex",s),[D,d,j]=nt(k),c=C??M?.vertical,g=U(a,n,M?.className,k,d,j,Qe(k,e),{[`${k}-rtl`]:P==="rtl",[`${k}-gap-${y}`]:fe(y),[`${k}-vertical`]:c}),h=Object.assign(Object.assign({},M?.style),l);return m&&(h.flex=m),y&&!fe(y)&&(h.gap=y),D(pe.createElement(S,Object.assign({ref:i,className:g,style:h},Ne(f,["justify","wrap","align"])),w))}),he=st,at=e=>{const{componentCls:i,calc:s}=e;return{[i]:Object.assign(Object.assign({},ze(e)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:s(s(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${Z(e.itemHeadSize)})`,borderInlineStart:`${Z(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${Z(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:s(e.itemHeadSize).div(2).equal(),insetInlineStart:s(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:s(s(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:s(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:s(e.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:s(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:s(e.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${Z(e.marginXXS)})`,width:`calc(50% - ${Z(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${Z(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${Z(s(s(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${Z(s(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${Z(e.margin)})`,borderInlineStart:`${Z(e.tailWidth)} dotted ${e.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${Z(e.margin)})`,borderInlineStart:`${Z(e.tailWidth)} dotted ${e.tailColor}`},[`${i}-item-content`]:{minHeight:s(e.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:s(s(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${Z(e.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${Z(e.marginSM)})`,width:`calc(50% - ${Z(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},ot=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),lt=Ce("Timeline",e=>{const i=ke(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[at(i)]},ot);var ct=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const dt=e=>{var{prefixCls:i,className:s,color:n="blue",dot:a,pending:l=!1,position:m,label:y,children:w}=e,C=ct(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:S}=o.useContext(ue),f=S("timeline",i),M=U(`${f}-item`,{[`${f}-item-pending`]:l},s),P=/blue|red|green|gray/.test(n||"")?void 0:n,_=U(`${f}-item-head`,{[`${f}-item-head-custom`]:!!a,[`${f}-item-head-${n}`]:!P});return o.createElement("li",Object.assign({},C,{className:M}),y&&o.createElement("div",{className:`${f}-item-label`},y),o.createElement("div",{className:`${f}-item-tail`}),o.createElement("div",{className:_,style:{borderColor:P,color:P}},a),o.createElement("div",{className:`${f}-item-content`},w))},$e=dt;var ve=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const pt=e=>{var{prefixCls:i,className:s,pending:n=!1,children:a,items:l,rootClassName:m,reverse:y=!1,direction:w,hashId:C,pendingDot:S,mode:f=""}=e,M=ve(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const P=(h,r)=>f==="alternate"?h==="right"?`${i}-item-right`:h==="left"?`${i}-item-left`:r%2===0?`${i}-item-left`:`${i}-item-right`:f==="left"?`${i}-item-left`:f==="right"?`${i}-item-right`:h==="right"?`${i}-item-right`:"",_=Ie(l||[]),k=typeof n=="boolean"?null:n;n&&_.push({pending:!!n,dot:S||o.createElement(je,null),children:k}),y&&_.reverse();const D=_.length,d=`${i}-item-last`,j=_.filter(h=>!!h).map((h,r)=>{var v;const u=r===D-2?d:"",F=r===D-1?d:"",{className:V}=h,E=ve(h,["className"]);return o.createElement($e,Object.assign({},E,{className:U([V,!y&&n?u:F,P((v=h?.position)!==null&&v!==void 0?v:"",r)]),key:h?.key||r}))}),c=_.some(h=>!!h?.label),g=U(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!y,[`${i}-${f}`]:!!f&&!c,[`${i}-label`]:c,[`${i}-rtl`]:w==="rtl"},s,m,C);return o.createElement("ul",Object.assign({},M,{className:g}),j)},gt=pt;function ht(e,i){return e&&Array.isArray(e)?e:_e(i).map(s=>{var n,a;return Object.assign({children:(a=(n=s?.props)===null||n===void 0?void 0:n.children)!==null&&a!==void 0?a:""},s.props)})}var ut=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const Le=e=>{const{getPrefixCls:i,direction:s,timeline:n}=o.useContext(ue),{prefixCls:a,children:l,items:m,className:y,style:w}=e,C=ut(e,["prefixCls","children","items","className","style"]),S=i("timeline",a),f=Fe(S),[M,P,_]=lt(S,f),k=ht(m,l);return M(o.createElement(gt,Object.assign({},C,{className:U(n?.className,y,_,f),style:Object.assign(Object.assign({},n?.style),w),prefixCls:S,direction:s,items:k,hashId:P})))};Le.Item=$e;const mt=Le;var ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const xt=ft;var yt=function(i,s){return o.createElement(le,ce({},i,{ref:s,icon:xt}))};const vt=o.forwardRef(yt);var Ct={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const kt=Ct;var jt=function(i,s){return o.createElement(le,ce({},i,{ref:s,icon:kt}))};const bt=o.forwardRef(jt);var wt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const St=wt;var Mt=function(i,s){return o.createElement(le,ce({},i,{ref:s,icon:St}))};const $t=o.forwardRef(Mt);var Lt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const Tt=Lt;var Nt=function(i,s){return o.createElement(le,ce({},i,{ref:s,icon:Tt}))};const zt=o.forwardRef(Nt),It=({size:e=16})=>t.jsx("svg",{width:e,height:e+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function _t(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function Ft({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_start})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Bt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function Pt({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_end})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Ht(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function Ot({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_checking})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.retail_name})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Dt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function Et({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_moving})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),t.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[e.total_distance," Trip"]})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Rt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function At({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_stop})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Wt({options:e}){const[i,s]=o.useState([]),[n,a]=o.useState({summary:null,details:[]}),[l,m]=o.useState(!0),[y,w]=o.useState(null),[C,S]=o.useState([]);o.useEffect(()=>{m(!0),w(null)},[e]);const f=c=>{let g=C;w(h=>{if(h==c){g[c].active_item=!1;let r=M(g);return s(r),S(g),null}else{for(let v=0;v<g.length;v++)v==c?g[v].active_item=!0:g[v].active_item=!1;let r=M(g);return s(r),S(g),c}})};o.useEffect(()=>{let c=M(n.details);s(c)},[n]);const M=c=>{let g=[];if(c!=null)for(let h=0;h<c.length;h++){let r=c[h];r.type=="start"?g.push({dot:t.jsx(_t,{}),children:t.jsx(Ft,{data:{time_start:j(r.timestamp),address:r.address,index_item:h,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="checkin"?g.push({dot:t.jsx(Ht,{}),children:t.jsx(Ot,{data:{time_checking:`${j(r.startTime)} - ${j(r.endTime)}`,retail_name:r.storeName,address:r.address,total_time:`${_(r.startTime,r.endTime)}`,index_item:h,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="move"?g.push({dot:t.jsx(Dt,{}),children:t.jsx(Et,{data:{time_moving:`${j(r.startTime)} - ${j(r.endTime)}`,total_distance:`${k(r.distance)}`,total_time:`${_(r.startTime,r.endTime)}`,index_item:h,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="stop"?g.push({dot:t.jsx(Rt,{}),children:t.jsx(At,{data:{time_stop:`${j(r.startTime)} - ${j(r.endTime)}`,address:r.address,total_time:`${_(r.startTime,r.endTime)}`,index_item:h,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="end"&&g.push({dot:t.jsx(Bt,{}),children:t.jsx(Pt,{data:{time_end:`${j(r.timestamp)}`,address:r.address,index_item:h,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})})}return g},P=c=>{c!=null?(a(c),S(c.details)):(a({summary:null,details:[]}),S([])),m(!1)},_=(c,g)=>{const h=new Date(c),v=new Date(g)-h;if(v<6e4)return`${Math.round(v/1e3)} giây`;if(v>=6e4&&v<6e4*60)return`${Math.round(v/6e4)} phút`;{const u=Math.floor(v/36e5),F=Math.floor(v%(1e3*60*60)/(1e3*60));return`${u} giờ ${F} phút`}},k=c=>c<1e3?`${Math.round(c)} m`:`${Math.round(c/1e3)} km`,D=c=>c<60?`${Math.round(c)} giây`:c>=60&&c<3600?`${Math.round(c/60)} phút`:`${Math.round(c/3600)} giờ`,d=c=>Math.round(c*3.6),j=c=>{var g=new Date(c);return g.setUTCHours(g.getUTCHours()+7),`${g.getUTCHours()}:${g.getUTCMinutes()}`};return t.jsxs(t.Fragment,{children:[l&&t.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(Be,{indicator:t.jsx(je,{style:{fontSize:30,color:"#fff"},spin:!0})})}),t.jsxs(oe,{gutter:20,children:[t.jsx(Q,{span:4,className:"card-container",children:t.jsx(te,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&k(n.summary.move.distance)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),t.jsx(Q,{span:4,className:"card-container",children:t.jsx(te,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.move.totalTime)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),t.jsx(Q,{span:4,className:"card-container",children:t.jsx(te,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),n.summary!=null?t.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[n.summary&&d(n.summary.move.avgSpeed)," km/h"]}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),t.jsx(Q,{span:6,className:"card-container",children:t.jsx(te,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[t.jsxs("div",{style:{marginRight:"40px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.stop.count?n.summary.stop.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.stop.totalTime)?D(n.summary.stop.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})}),t.jsx(Q,{span:6,className:"card-container",children:t.jsx(te,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[t.jsxs("div",{style:{marginRight:"13px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.checkin.count?n.summary.checkin.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.checkin.totalTime)?D(n.summary.checkin.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})})]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(oe,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:t.jsx(Ae,{children:t.jsxs(oe,{children:[t.jsxs(Q,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[t.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),t.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?t.jsx(mt,{mode:"left",items:i}):t.jsx("div",{children:"Chưa có lộ trình"})})]}),t.jsx(Q,{span:18,style:{height:"600px"},children:t.jsx(Ut,{options:e,onLoad:P,HistoryIndex:y})})]})})})})]})}function Zt(){const[e,i]=o.useState(!1),s=()=>{i(!e)},n={iconStart:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="44px" height="44px" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"><g><path style="opacity:1" fill="%232ac560" d="M 23.5,7.5 C 23.6107,8.11742 23.944,8.61742 24.5,9C 28.2255,9.75991 31.8922,9.59324 35.5,8.5C 37.0616,15.4204 36.7283,22.0871 34.5,28.5C 30.1311,28.5328 25.7978,28.1995 21.5,27.5C 21.4226,26.2502 20.756,25.4169 19.5,25C 16.633,24.1993 13.9664,24.3659 11.5,25.5C 10.5,25.5 9.5,25.5 8.5,25.5C 7.67618,29.3123 7.17618,33.3123 7,37.5C 6.50016,26.8385 6.3335,16.1719 6.5,5.5C 12.4855,2.62241 18.1522,3.28908 23.5,7.5 Z"/></g><g><path style="opacity:0.73" fill="%238fd8a8" d="M 34.5,28.5 C 36.7283,22.0871 37.0616,15.4204 35.5,8.5C 31.8922,9.59324 28.2255,9.75991 24.5,9C 23.944,8.61742 23.6107,8.11742 23.5,7.5C 28.4839,8.45762 33.3172,8.45762 38,7.5C 37.5937,14.5348 37.427,21.5348 37.5,28.5C 36.5,28.5 35.5,28.5 34.5,28.5 Z"/></g><g><path style="opacity:0.627" fill="%2381d09f" d="M 6.5,5.5 C 6.3335,16.1719 6.50016,26.8385 7,37.5C 7.17618,33.3123 7.67618,29.3123 8.5,25.5C 8.5,30.1667 8.5,34.8333 8.5,39.5C 7.17793,39.67 6.01127,39.3366 5,38.5C 4.83333,36.6667 4.66667,34.8333 4.5,33C 5.71694,24.656 5.71694,16.3226 4.5,8C 4.68423,6.62439 5.35089,5.79106 6.5,5.5 Z"/></g><g><path style="opacity:1" fill="%239be0b2" d="M 11.5,25.5 C 13.9664,24.3659 16.633,24.1993 19.5,25C 20.756,25.4169 21.4226,26.2502 21.5,27.5C 18.3652,25.9767 15.0318,25.31 11.5,25.5 Z"/></g><g><path style="opacity:0.975" fill="%235dc982" d="M 21.5,27.5 C 25.7978,28.1995 30.1311,28.5328 34.5,28.5C 33.036,29.1599 31.3693,29.4932 29.5,29.5C 26.5143,29.6183 23.8476,28.9517 21.5,27.5 Z"/></g></svg>',iconEnd:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="44" height="44"><path d="M0 0 C1.06 -0.01 2.12 -0.03 3.21 -0.04 C6.18 0.19 7.6 0.85 10.19 2.19 C12.45 2.24 12.45 2.24 14.75 2 C17.14 1.96 17.14 1.96 19.19 2.19 C20.94 4.06 20.94 4.06 22.19 7.19 C22.62 7.97 23.05 8.76 23.5 9.57 C27.28 16.45 27.28 16.45 26.83 20 C26.62 20.72 26.41 21.44 26.19 22.19 C24.6 22.24 23.02 22.28 21.44 22.31 C20.56 22.34 19.67 22.36 18.77 22.38 C16.04 22.18 14.57 21.45 12.19 20.19 C8.47 19.99 5.73 20.01 2.19 21.19 C3.53 25.46 4.87 29.55 6.88 33.56 C8.19 36.19 8.19 36.19 8.19 39.19 C7.2 39.19 6.21 39.19 5.19 39.19 C3.24 35.23 1.3 31.26 -0.63 27.29 C-1.29 25.95 -1.94 24.6 -2.6 23.26 C-6.15 16.03 -9.53 8.93 -11.81 1.19 C-10.61 1.22 -10.61 1.22 -9.38 1.25 C-6.07 1.17 -3.67 0.02 0 0 Z M4.19 3.19 C4.52 4.18 4.85 5.17 5.19 6.19 C6.18 5.86 7.17 5.53 8.19 5.19 C6.87 4.53 5.55 3.87 4.19 3.19 Z M-4.81 3.19 C-5.8 3.68 -5.8 3.68 -6.81 4.19 C-6.48 5.51 -6.15 6.83 -5.81 8.19 C-4.49 7.53 -3.17 6.87 -1.81 6.19 C-2.8 5.2 -3.79 4.21 -4.81 3.19 Z M16.19 5.19 C15.86 5.85 15.53 6.51 15.19 7.19 C15.52 7.85 15.85 8.51 16.19 9.19 C17.18 9.19 18.17 9.19 19.19 9.19 C18.86 7.87 18.53 6.55 18.19 5.19 C17.53 5.19 16.87 5.19 16.19 5.19 Z M0.19 7.19 C0.52 8.51 0.85 9.83 1.19 11.19 C2.84 11.19 4.49 11.19 6.19 11.19 C5.53 9.87 4.87 8.55 4.19 7.19 C2.87 7.19 1.55 7.19 0.19 7.19 Z M12.19 10.19 C12.52 11.18 12.85 12.17 13.19 13.19 C15.2 13.92 15.2 13.92 17.19 14.19 C16.86 12.87 16.53 11.55 16.19 10.19 C14.87 10.19 13.55 10.19 12.19 10.19 Z M9.19 13.19 C9.52 14.18 9.85 15.17 10.19 16.19 C12.2 16.92 12.2 16.92 14.19 17.19 C13.53 15.87 12.87 14.55 12.19 13.19 C11.2 13.19 10.21 13.19 9.19 13.19 Z M0.19 13.19 C-0.8 13.68 -0.8 13.68 -1.81 14.19 C-1.48 15.84 -1.15 17.49 -0.81 19.19 C0.51 18.2 1.83 17.21 3.19 16.19 C2.2 15.2 1.21 14.21 0.19 13.19 Z M20.19 15.19 C20.52 16.84 20.85 18.49 21.19 20.19 C22.18 19.53 23.17 18.87 24.19 18.19 C23.53 17.2 22.87 16.21 22.19 15.19 C21.53 15.19 20.87 15.19 20.19 15.19 Z " fill="%23f85631" transform="translate(14.8125,2.8125)"/><path d="M0 0 C0.99 0.33 1.98 0.66 3 1 C3.33 2.98 3.66 4.96 4 7 C2.35 7 0.7 7 -1 7 C-0.67 8.65 -0.34 10.3 0 12 C-1.32 12 -2.64 12 -4 12 C-4.66 10.35 -5.32 8.7 -6 7 C-5.01 6.67 -4.02 6.34 -3 6 C-2.88 5.2 -2.75 4.39 -2.62 3.56 C-2.42 2.72 -2.21 1.87 -2 1 C-1.34 0.67 -0.68 0.34 0 0 Z " fill="%23f85631" transform="translate(35,11)"/><path d="M0 0 C1.53 0.09 3.05 0.25 4.56 0.44 C5.8 0.59 5.8 0.59 7.07 0.75 C7.7 0.83 8.34 0.91 9 1 C8.01 1.5 8.01 1.5 7 2 C7.33 3.32 7.66 4.64 8 6 C5.69 6 3.38 6 1 6 C1 4.68 1 3.36 1 2 C0.34 1.67 -0.32 1.34 -1 1 C-0.67 0.67 -0.34 0.34 0 0 Z " fill="%23f85631" transform="translate(11,3)"/><path d="M0 0 C1.65 0 3.3 0 5 0 C5.33 1.65 5.66 3.3 6 5 C5.01 5.66 4.02 6.32 3 7 C2.01 6.67 1.02 6.34 0 6 C0 4.02 0 2.04 0 0 Z " fill="%23f85631" transform="translate(17,15)"/><path d="M0 0 C2.64 0.33 5.28 0.66 8 1 C7.01 1.5 7.01 1.5 6 2 C6.33 3.32 6.66 4.64 7 6 C2.32 4.52 2.32 4.52 0.69 1.88 C0.46 1.26 0.23 0.64 0 0 Z " fill="%23f85631" transform="translate(23,6)"/><path d="M0 0 C5.75 0.75 5.75 0.75 8 3 C7.34 4.32 6.68 5.64 6 7 C5.55 6.5 5.09 6.01 4.62 5.5 C3.12 3.77 3.12 3.77 1 4 C0.67 2.68 0.34 1.36 0 0 Z " fill="%23f85631" transform="translate(17,3)"/><path d="M0 0 C2.47 0.49 2.47 0.49 5 1 C5 1.99 5 2.98 5 4 C3.35 4 1.7 4 0 4 C0 2.68 0 1.36 0 0 Z " fill="%23f85631" transform="translate(10,13)"/><path d="M0 0 C2.31 0 4.62 0 7 0 C6.01 0.33 5.02 0.66 4 1 C4 1.99 4 2.98 4 4 C2.68 3.67 1.36 3.34 0 3 C0 2.01 0 1.02 0 0 Z " fill="%23f85631" transform="translate(13,4)"/></svg>',iconStop:'<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="44" height="44" viewBox="0 0 44 44" preserveAspectRatio="xMidYMid meet"><g transform="translate(0.000000,44.000000) scale(0.100000,-0.100000)" fill="%231877f2" stroke="none"><path d="M167 426 c-21 -8 -47 -22 -57 -31 -52 -47 -65 -145 -27 -206 28 -46 130 -178 137 -178 7 0 109 132 137 178 79 125 -52 287 -190 237z m113 -51 c68 -35 78 -132 21 -189 -27 -26 -39 -31 -81 -31 -42 0 -54 5 -80 30 -101 101 14 255 140 190z"/><path d="M179 345 c-31 -17 -52 -60 -43 -89 27 -88 141 -88 168 1 9 29 -16 76 -49 91 -33 15 -44 15 -76 -3z m77 -13 c6 -4 13 -15 17 -25 7 -20 -24 -57 -48 -57 -9 0 -15 -9 -15 -25 0 -16 -6 -25 -15 -25 -12 0 -15 14 -15 70 l0 70 33 0 c17 0 37 -4 43 -8z"/><path d="M210 300 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/></g></svg>',iconCheckin:'<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" version="1.1"><path d="M 17.914 0.925 C 7.822 4.105, 2.825 16.279, 8.075 24.892 C 11.082 29.823, 21.074 42, 22.114 42 C 23.040 42, 30.499 32.779, 35.250 25.761 C 41.903 15.934, 35.857 2.432, 24 0.639 C 22.075 0.348, 19.336 0.476, 17.914 0.925 M 15.763 6.565 C 12.329 8.429, 10 12.833, 10 17.465 C 10 22.258, 15.051 27.839, 20.118 28.644 C 29.846 30.189, 37.077 19.852, 32.483 10.967 C 29.655 5.498, 21.625 3.384, 15.763 6.565 M 18.213 8.507 C 16.072 9.437, 14.410 11.167, 13.449 13.467 C 12.148 16.582, 12.148 17.418, 13.451 20.536 C 16.686 28.281, 27.314 28.281, 30.549 20.536 C 32.613 15.597, 30.525 10.535, 25.568 8.464 C 21.451 6.744, 22.281 6.739, 18.213 8.507 M 19.389 11.430 C 18.393 14.025, 19.788 16.169, 22.246 15.820 C 25.450 15.365, 25.450 10.635, 22.246 10.180 C 20.893 9.988, 19.750 10.488, 19.389 11.430 M 18.223 18.557 C 15.300 20.604, 15.411 22.411, 18.547 23.839 C 22.085 25.452, 23.420 25.304, 26.139 23 L 28.500 21 26.139 19 C 23.301 16.595, 21.192 16.477, 18.223 18.557" stroke="none" fill="%23f85631" fill-rule="evenodd"/></svg>'};return t.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[t.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:s,children:[t.jsx("span",{className:`icon ${e?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),t.jsx("span",{children:"Chú giải bản đồ"})]}),t.jsx("div",{className:`ekmapplf_tracking-legend-body ${e?"open":""}`,style:{maxHeight:e?"none":"0"},children:t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url('data:image/svg+xml,${n.iconStart}')`}}),"Vị trí bắt đầu"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url('data:image/svg+xml,${n.iconEnd}')`}}),"Vị trí kết thúc"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url('data:image/svg+xml,${n.iconCheckin}')`}}),"Vị trí khách hàng"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url('data:image/svg+xml,${n.iconStop}')`}}),"Vị trí điểm dừng"]})]})})]})}function ie(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Vt(e){return e.type==="Feature"?e.geometry:e}function Te(e,i,s){s===void 0&&(s={});var n=ie(e),a=ie(i),l=Y(a[1]-n[1]),m=Y(a[0]-n[0]),y=Y(n[1]),w=Y(a[1]),C=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(m/2),2)*Math.cos(y)*Math.cos(w);return We(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),s.units)}function qt(e,i,s,n){n===void 0&&(n={});var a=ie(e),l=Y(a[0]),m=Y(a[1]),y=Y(s),w=Ze(i,n.units),C=Math.asin(Math.sin(m)*Math.cos(w)+Math.cos(m)*Math.sin(w)*Math.cos(y)),S=l+Math.atan2(Math.sin(y)*Math.sin(w)*Math.cos(m),Math.cos(w)-Math.sin(m)*Math.sin(C)),f=ge(S),M=ge(C);return K([f,M],n.properties)}function me(e,i,s){if(s===void 0&&(s={}),s.final===!0)return Gt(e,i);var n=ie(e),a=ie(i),l=Y(n[0]),m=Y(a[0]),y=Y(n[1]),w=Y(a[1]),C=Math.sin(m-l)*Math.cos(w),S=Math.cos(y)*Math.sin(w)-Math.sin(y)*Math.cos(w)*Math.cos(m-l);return ge(Math.atan2(C,S))}function Gt(e,i){var s=me(i,e);return s=(s+180)%360,s}function Yt(e,i,s){s===void 0&&(s={});for(var n=Vt(e),a=n.coordinates,l=0,m=0;m<a.length&&!(i>=l&&m===a.length-1);m++)if(l>=i){var y=i-l;if(y){var w=me(a[m],a[m-1])-180,C=qt(a[m],y,w,s);return C}else return K(a[m])}else l+=Te(a[m],a[m+1],s);return K(a[a.length-1])}function Xt(e,i){return i===void 0&&(i={}),Ve(e,function(s,n){var a=n.geometry.coordinates;return s+Te(a[0],a[1],i)},0)}const Qt=({map:e,segmentData:i,options:s,currentInfo:n,Animation:a})=>{const l=o.useRef(null),m=o.useRef(null),[y,w]=o.useState(s.animation.follow),[C,S]=o.useState(!1),[f,M]=o.useState(10),[P,_]=o.useState(!0),k=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[D,d]=o.useState(!0),j=o.useRef(0),c=o.useRef(0),g=o.useRef([]);function h(p,I){c.current=p;const T=I[p];if(!T){if(P){c.current=0,g.current=[];try{e&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(W){S(!1),console.log(W)}i.length&&i[0].computed.time&&(m.current=setTimeout(h.bind(this),1e3,c.current,i))}else c.current=p-1,G();n(I[c.current]);return}if(n(T),T.computed.time){let W=T.computed.time*1e3/f;if(T.computed.speed){let x=function(N){O||(H=T.loc1.loc,O=N);const B=(N-O)/(Number(T.computed.time?.toString())*1e3/f);if(!(B>1||!C)){var z=xe([T.loc1.loc,T.loc2.loc]),b=Xt(z),$=Yt(z,b*B).geometry.coordinates,L=me(K(H),K($));H[0]!==$[0]&&H[1]!==$[1]&&(j.current=L),H=$,g.current=g.current.concat([$]);try{e&&y&&e.panTo($,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:j.current}),e&&e.getSource("locationMarker")&&e.getSource("locationMarker").setData({type:"FeatureCollection",features:[K($,{bearing:j.current})]}),e&&g.current.length>1&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[xe(g.current)]}),l.current=window.requestAnimationFrame(x)}catch(R){S(!1),console.log(R)}}};var O,H;l.current=window.requestAnimationFrame(x)}p++,g.current=I.slice(0,p).map(x=>x.loc1.loc),m.current=setTimeout(h.bind(this),W,p,I)}}o.useEffect(()=>{S(!1),l.current&&cancelAnimationFrame(l.current),m.current&&clearTimeout(m.current),c.current=0,i.length},[i,s]),o.useEffect(()=>{a===!0&&V(),a===!1&&E(),a===null&&G()},[a]),o.useEffect(()=>{if(C){c.current===0&&(g.current=[],e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc)),i.length&&i[0].computed.time&&(m.current=setTimeout(h.bind(void 0),500,c.current,i));try{e.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",.4),e.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),e.setLayoutProperty("locationMarker","visibility","visible"),e.setLayoutProperty("LocationHistory","visibility","visible"),e.getSource("RouteHistory")&&(e.removeLayer("RouteHistory"),e.removeLayer("RouteHistory-arrow"),e.removeSource("RouteHistory"))}catch(p){console.log(p)}}else{n(null),l.current&&cancelAnimationFrame(l.current);try{e.setPaintProperty("ek-tracking-his-LineString","line-color",s.route.lineCorlor),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",s.route.lineOpacity),e.setLayoutProperty("ek-tracking-his-LineString","visibility","visible"),e.setLayoutProperty("locationMarker","visibility","none"),e.setLayoutProperty("LocationHistory","visibility","none")}catch(p){console.log(p)}}return()=>{l.current&&cancelAnimationFrame(l.current),m.current&&clearTimeout(m.current)}},[C,f,y,P]);const[r,v]=o.useState(null);o.useEffect(()=>{const p=()=>{d(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",p),()=>{document.removeEventListener("visibilitychange",p)}},[]),o.useEffect(()=>{D?S(!!(r&&r===!0)):(v(C),S(!1))},[D]);const u=p=>{M(p)},F=p=>{p.target.checked&&e.setZoom(17),w(!y)},V=()=>{S(!0)},E=()=>{S(!1)},G=()=>{E();try{e&&(e.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc))}catch(p){console.log(p)}c.current=0},X=()=>{_(!P)};return t.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:t.jsxs(he,{gap:"small",align:"center",justify:"center",children:[t.jsx(ee,{title:"Play",children:t.jsx(ne,{icon:t.jsx(bt,{}),disabled:C,onClick:V})}),t.jsx(ee,{title:"Pause",children:t.jsx(ne,{icon:t.jsx($t,{}),disabled:!C,onClick:E})}),t.jsx(ee,{title:"Stop",children:t.jsx(ne,{icon:t.jsx(vt,{}),onClick:G})}),t.jsx(ee,{title:"Replay",children:t.jsx(ne,{type:P?"primary":"default",icon:t.jsx(zt,{}),onClick:X})}),t.jsx(ee,{title:"Speed",children:t.jsx(be,{defaultValue:f,style:{width:"75px"},onChange:u,options:k})}),t.jsx(Pe,{onChange:F,checked:y,children:"Theo dõi lộ trình"})]})})},ae=window.ekmapplf;function Ut({options:e,onLoad:i,HistoryIndex:s}){const n=o.useRef(null),a=o.useState(null),[l,m]=o.useState(null),[y,w]=o.useState({ready:!1,Data:[],options:null}),[C,S]=o.useState({date:null,time:null,speed:0}),f=o.useRef(null),M=o.useRef(null),[P,_]=o.useState(!1),k=o.useRef(null),d=qe({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{arrow:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#F5222D"/></svg>',navigation:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="26px" height="32px" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"><g><path style="opacity:0.998" fill="#43c5fb" d="M 16.5,9.5 C 17.1052,14.0317 18.7719,18.0317 21.5,21.5C 22.0081,24.1761 22.1747,26.8428 22,29.5C 21.3292,28.7476 20.4959,28.4142 19.5,28.5C 18.0085,25.3657 15.5085,23.3657 12,22.5C 10.2509,22.7483 9.41755,23.7483 9.5,25.5C 6.83333,26.5 4.16667,27.5 1.5,28.5C 2.95475,22.6465 5.12141,16.9799 8,11.5C 8.56704,8.83228 9.06704,6.16562 9.5,3.5C 10.4674,2.19376 11.8007,1.52709 13.5,1.5C 13.7329,4.54176 14.7329,7.20843 16.5,9.5 Z"/></g><g><path style="opacity:0.357" fill="#bfe2ee" d="M 16.5,9.5 C 14.7329,7.20843 13.7329,4.54176 13.5,1.5C 11.8007,1.52709 10.4674,2.19376 9.5,3.5C 9.5,2.5 9.5,1.5 9.5,0.5C 11.1667,0.5 12.8333,0.5 14.5,0.5C 15.4608,3.42607 16.1274,6.42607 16.5,9.5 Z"/></g><g><path style="opacity:0.224" fill="#afdcf1" d="M 16.5,9.5 C 19.2367,12.9831 20.9034,16.9831 21.5,21.5C 18.7719,18.0317 17.1052,14.0317 16.5,9.5 Z"/></g><g><path style="opacity:0.306" fill="#c2e3f4" d="M 9.5,3.5 C 9.06704,6.16562 8.56704,8.83228 8,11.5C 5.12141,16.9799 2.95475,22.6465 1.5,28.5C 4.16667,27.5 6.83333,26.5 9.5,25.5C 7.68383,27.1366 5.68383,28.6366 3.5,30C 2.07153,30.5791 0.738195,30.4124 -0.5,29.5C -0.5,28.1667 -0.5,26.8333 -0.5,25.5C 2.83333,18.1667 6.16667,10.8333 9.5,3.5 Z"/></g><g><path style="opacity:0.831" fill="#ade2fd" d="M 19.5,28.5 C 16.6277,27.4744 14.1277,25.8077 12,23.5C 11.2917,24.3805 10.4584,25.0472 9.5,25.5C 9.41755,23.7483 10.2509,22.7483 12,22.5C 15.5085,23.3657 18.0085,25.3657 19.5,28.5 Z"/></g><g><path style="opacity:0.047" fill="#c4e9f7" d="M 21.5,21.5 C 23.4725,24.0836 24.4725,27.0836 24.5,30.5C 22.302,30.8799 20.6354,30.2132 19.5,28.5C 20.4959,28.4142 21.3292,28.7476 22,29.5C 22.1747,26.8428 22.0081,24.1761 21.5,21.5 Z"/></g></svg>',start:`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="44px" height="44px" style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">
            <g><path style="opacity:1" fill="#2ac560" d="M 23.5,7.5 C 23.6107,8.11742 23.944,8.61742 24.5,9C 28.2255,9.75991 31.8922,9.59324 35.5,8.5C 37.0616,15.4204 36.7283,22.0871 34.5,28.5C 30.1311,28.5328 25.7978,28.1995 21.5,27.5C 21.4226,26.2502 20.756,25.4169 19.5,25C 16.633,24.1993 13.9664,24.3659 11.5,25.5C 10.5,25.5 9.5,25.5 8.5,25.5C 7.67618,29.3123 7.17618,33.3123 7,37.5C 6.50016,26.8385 6.3335,16.1719 6.5,5.5C 12.4855,2.62241 18.1522,3.28908 23.5,7.5 Z"/></g>
            <g><path style="opacity:0.73" fill="#8fd8a8" d="M 34.5,28.5 C 36.7283,22.0871 37.0616,15.4204 35.5,8.5C 31.8922,9.59324 28.2255,9.75991 24.5,9C 23.944,8.61742 23.6107,8.11742 23.5,7.5C 28.4839,8.45762 33.3172,8.45762 38,7.5C 37.5937,14.5348 37.427,21.5348 37.5,28.5C 36.5,28.5 35.5,28.5 34.5,28.5 Z"/></g>
            <g><path style="opacity:0.627" fill="#81d09f" d="M 6.5,5.5 C 6.3335,16.1719 6.50016,26.8385 7,37.5C 7.17618,33.3123 7.67618,29.3123 8.5,25.5C 8.5,30.1667 8.5,34.8333 8.5,39.5C 7.17793,39.67 6.01127,39.3366 5,38.5C 4.83333,36.6667 4.66667,34.8333 4.5,33C 5.71694,24.656 5.71694,16.3226 4.5,8C 4.68423,6.62439 5.35089,5.79106 6.5,5.5 Z"/></g>
            <g><path style="opacity:1" fill="#9be0b2" d="M 11.5,25.5 C 13.9664,24.3659 16.633,24.1993 19.5,25C 20.756,25.4169 21.4226,26.2502 21.5,27.5C 18.3652,25.9767 15.0318,25.31 11.5,25.5 Z"/></g>
            <g><path style="opacity:0.975" fill="#5dc982" d="M 21.5,27.5 C 25.7978,28.1995 30.1311,28.5328 34.5,28.5C 33.036,29.1599 31.3693,29.4932 29.5,29.5C 26.5143,29.6183 23.8476,28.9517 21.5,27.5 Z"/></g>
            </svg>`,end:`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="44" height="44">
            <path d="M0 0 C1.06 -0.01 2.12 -0.03 3.21 -0.04 C6.18 0.19 7.6 0.85 10.19 2.19 C12.45 2.24 12.45 2.24 14.75 2 C17.14 1.96 17.14 1.96 19.19 2.19 C20.94 4.06 20.94 4.06 22.19 7.19 C22.62 7.97 23.05 8.76 23.5 9.57 C27.28 16.45 27.28 16.45 26.83 20 C26.62 20.72 26.41 21.44 26.19 22.19 C24.6 22.24 23.02 22.28 21.44 22.31 C20.56 22.34 19.67 22.36 18.77 22.38 C16.04 22.18 14.57 21.45 12.19 20.19 C8.47 19.99 5.73 20.01 2.19 21.19 C3.53 25.46 4.87 29.55 6.88 33.56 C8.19 36.19 8.19 36.19 8.19 39.19 C7.2 39.19 6.21 39.19 5.19 39.19 C3.24 35.23 1.3 31.26 -0.63 27.29 C-1.29 25.95 -1.94 24.6 -2.6 23.26 C-6.15 16.03 -9.53 8.93 -11.81 1.19 C-10.61 1.22 -10.61 1.22 -9.38 1.25 C-6.07 1.17 -3.67 0.02 0 0 Z M4.19 3.19 C4.52 4.18 4.85 5.17 5.19 6.19 C6.18 5.86 7.17 5.53 8.19 5.19 C6.87 4.53 5.55 3.87 4.19 3.19 Z M-4.81 3.19 C-5.8 3.68 -5.8 3.68 -6.81 4.19 C-6.48 5.51 -6.15 6.83 -5.81 8.19 C-4.49 7.53 -3.17 6.87 -1.81 6.19 C-2.8 5.2 -3.79 4.21 -4.81 3.19 Z M16.19 5.19 C15.86 5.85 15.53 6.51 15.19 7.19 C15.52 7.85 15.85 8.51 16.19 9.19 C17.18 9.19 18.17 9.19 19.19 9.19 C18.86 7.87 18.53 6.55 18.19 5.19 C17.53 5.19 16.87 5.19 16.19 5.19 Z M0.19 7.19 C0.52 8.51 0.85 9.83 1.19 11.19 C2.84 11.19 4.49 11.19 6.19 11.19 C5.53 9.87 4.87 8.55 4.19 7.19 C2.87 7.19 1.55 7.19 0.19 7.19 Z M12.19 10.19 C12.52 11.18 12.85 12.17 13.19 13.19 C15.2 13.92 15.2 13.92 17.19 14.19 C16.86 12.87 16.53 11.55 16.19 10.19 C14.87 10.19 13.55 10.19 12.19 10.19 Z M9.19 13.19 C9.52 14.18 9.85 15.17 10.19 16.19 C12.2 16.92 12.2 16.92 14.19 17.19 C13.53 15.87 12.87 14.55 12.19 13.19 C11.2 13.19 10.21 13.19 9.19 13.19 Z M0.19 13.19 C-0.8 13.68 -0.8 13.68 -1.81 14.19 C-1.48 15.84 -1.15 17.49 -0.81 19.19 C0.51 18.2 1.83 17.21 3.19 16.19 C2.2 15.2 1.21 14.21 0.19 13.19 Z M20.19 15.19 C20.52 16.84 20.85 18.49 21.19 20.19 C22.18 19.53 23.17 18.87 24.19 18.19 C23.53 17.2 22.87 16.21 22.19 15.19 C21.53 15.19 20.87 15.19 20.19 15.19 Z " fill="#f85631" transform="translate(14.8125,2.8125)"/>
            <path d="M0 0 C0.99 0.33 1.98 0.66 3 1 C3.33 2.98 3.66 4.96 4 7 C2.35 7 0.7 7 -1 7 C-0.67 8.65 -0.34 10.3 0 12 C-1.32 12 -2.64 12 -4 12 C-4.66 10.35 -5.32 8.7 -6 7 C-5.01 6.67 -4.02 6.34 -3 6 C-2.88 5.2 -2.75 4.39 -2.62 3.56 C-2.42 2.72 -2.21 1.87 -2 1 C-1.34 0.67 -0.68 0.34 0 0 Z " fill="#f85631" transform="translate(35,11)"/>
            <path d="M0 0 C1.53 0.09 3.05 0.25 4.56 0.44 C5.8 0.59 5.8 0.59 7.07 0.75 C7.7 0.83 8.34 0.91 9 1 C8.01 1.5 8.01 1.5 7 2 C7.33 3.32 7.66 4.64 8 6 C5.69 6 3.38 6 1 6 C1 4.68 1 3.36 1 2 C0.34 1.67 -0.32 1.34 -1 1 C-0.67 0.67 -0.34 0.34 0 0 Z " fill="#f85631" transform="translate(11,3)"/>
            <path d="M0 0 C1.65 0 3.3 0 5 0 C5.33 1.65 5.66 3.3 6 5 C5.01 5.66 4.02 6.32 3 7 C2.01 6.67 1.02 6.34 0 6 C0 4.02 0 2.04 0 0 Z " fill="#f85631" transform="translate(17,15)"/>
            <path d="M0 0 C2.64 0.33 5.28 0.66 8 1 C7.01 1.5 7.01 1.5 6 2 C6.33 3.32 6.66 4.64 7 6 C2.32 4.52 2.32 4.52 0.69 1.88 C0.46 1.26 0.23 0.64 0 0 Z " fill="#f85631" transform="translate(23,6)"/>
            <path d="M0 0 C5.75 0.75 5.75 0.75 8 3 C7.34 4.32 6.68 5.64 6 7 C5.55 6.5 5.09 6.01 4.62 5.5 C3.12 3.77 3.12 3.77 1 4 C0.67 2.68 0.34 1.36 0 0 Z " fill="#f85631" transform="translate(17,3)"/>
            <path d="M0 0 C2.47 0.49 2.47 0.49 5 1 C5 1.99 5 2.98 5 4 C3.35 4 1.7 4 0 4 C0 2.68 0 1.36 0 0 Z " fill="#f85631" transform="translate(10,13)"/>
            <path d="M0 0 C2.31 0 4.62 0 7 0 C6.01 0.33 5.02 0.66 4 1 C4 1.99 4 2.98 4 4 C2.68 3.67 1.36 3.34 0 3 C0 2.01 0 1.02 0 0 Z " fill="#f85631" transform="translate(13,4)"/>
            </svg>`,stop:`<svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="44" height="44" viewBox="0 0 44 44" preserveAspectRatio="xMidYMid meet">
            <g transform="translate(0.000000,44.000000) scale(0.100000,-0.100000)" fill="#1877f2" stroke="none">
            <path d="M167 426 c-21 -8 -47 -22 -57 -31 -52 -47 -65 -145 -27 -206 28 -46 130 -178 137 -178 7 0 109 132 137 178 79 125 -52 287 -190 237z m113 -51 c68 -35 78 -132 21 -189 -27 -26 -39 -31 -81 -31 -42 0 -54 5 -80 30 -101 101 14 255 140 190z"/>
            <path d="M179 345 c-31 -17 -52 -60 -43 -89 27 -88 141 -88 168 1 9 29 -16 76 -49 91 -33 15 -44 15 -76 -3z m77 -13 c6 -4 13 -15 17 -25 7 -20 -24 -57 -48 -57 -9 0 -15 -9 -15 -25 0 -16 -6 -25 -15 -25 -12 0 -15 14 -15 70 l0 70 33 0 c17 0 37 -4 43 -8z"/>
            <path d="M210 300 c0 -5 7 -10 15 -10 8 0 15 5 15 10 0 6 -7 10 -15 10 -8 0 -15 -4 -15 -10z"/>
            </g>
            </svg>`,checkin:'<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" version="1.1"><path d="M 17.914 0.925 C 7.822 4.105, 2.825 16.279, 8.075 24.892 C 11.082 29.823, 21.074 42, 22.114 42 C 23.040 42, 30.499 32.779, 35.250 25.761 C 41.903 15.934, 35.857 2.432, 24 0.639 C 22.075 0.348, 19.336 0.476, 17.914 0.925 M 15.763 6.565 C 12.329 8.429, 10 12.833, 10 17.465 C 10 22.258, 15.051 27.839, 20.118 28.644 C 29.846 30.189, 37.077 19.852, 32.483 10.967 C 29.655 5.498, 21.625 3.384, 15.763 6.565 M 18.213 8.507 C 16.072 9.437, 14.410 11.167, 13.449 13.467 C 12.148 16.582, 12.148 17.418, 13.451 20.536 C 16.686 28.281, 27.314 28.281, 30.549 20.536 C 32.613 15.597, 30.525 10.535, 25.568 8.464 C 21.451 6.744, 22.281 6.739, 18.213 8.507 M 19.389 11.430 C 18.393 14.025, 19.788 16.169, 22.246 15.820 C 25.450 15.365, 25.450 10.635, 22.246 10.180 C 20.893 9.988, 19.750 10.488, 19.389 11.430 M 18.223 18.557 C 15.300 20.604, 15.411 22.411, 18.547 23.839 C 22.085 25.452, 23.420 25.304, 26.139 23 L 28.500 21 26.139 19 C 23.301 16.595, 21.192 16.477, 18.223 18.557" stroke="none" fill="#f85631" fill-rule="evenodd"/></svg>'},route:{visible:!0,lineCorlor:"#29b55c",lineWidth:6.5,lineOpacity:.85},animation:{follow:!0,animate:!1}},e),j=()=>{try{let E=function(){var x={type:"FeatureCollection",features:[]};r.getSource("LocationHistory")?r.getSource("LocationHistory").setData(x):(r.addSource("LocationHistory",{type:"geojson",data:x}),r.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity},filter:["==","$type","LineString"]}))};a.current&&a.current.remove(),a.current=new J.Map({container:n.current,center:d.center,zoom:d.zoom,minZoom:1});var r=a.current;m(r);const G=r.getContainer();r.setPadding({top:100,bottom:100,left:100,right:100}),new ae.VectorBaseMap("OSM:Night",d.apiKey).addTo(r);var v=new ae.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+G.id,baseLayers:[{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});r.addControl(v,"bottom-left"),v.on("changeBaseLayer",async function(x){_(!1),new ae.VectorBaseMap(x.layer,d.apiKey).addTo(r),setTimeout(async()=>{await p(d.from_time,d.to_time,d.pageNumber,d.pageSize)},1e3)}),r.addControl(new J.NavigationControl({visualizePitch:!0}),"bottom-right");var u=!1;r.getPitch()>0?u=!0:u=!1;var F="maplibregl-terrain2d-control",V="Hiển thị 2D";u||(F="maplibregl-terrain3d-control",V="Bản đồ 3D");let X=new ae.control.Button({className:"btn-ctl-group "+F,icon:"none",tooltip:V});X.on("click",x=>{u=!u,u?(x._div.className=x._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),x._div.title="Hiển thị 2D"):(x._div.className=x._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),x._div.title="Hiển thị 3D"),u?(r.easeTo({pitch:60}),r.setLayoutProperty("building-3d","visibility","visible")):(r.easeTo({pitch:0}),r.setLayoutProperty("building-3d","visibility","none"))}),r.addControl(X,"bottom-right"),r.addControl(new J.FullscreenControl,"top-right"),r.on("load",()=>{try{if(!d.objectId||d.objectId===""||d.objectId==="null"||!d.from_time||d.from_time===""||d.from_time==="null"||!d.to_time||d.to_time===""||d.to_time==="null"){i(null);return}p(d.from_time,d.to_time,d.pageNumber,d.pageSize)}catch(x){console.error("Error:",x)}});const p=async(x,N,B,z)=>{_(!1);let b=await I(x,N,B,z);await T(b);let $=await c(b);M.current=$,b.length&&b[0].coordinates&&d.animation.animate&&r.easeTo({center:b[0].coordinates,duration:100,zoom:16}),setTimeout(()=>{w({ready:!0,Data:$,options:d})},300)},I=async(x,N,B,z)=>{if(!f.current){let b=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${d.projectId}/${d.objectId}?api_key=${d.apiKey}&from_time=${x}&to_time=${N}`;const L=await(await fetch(b)).json();f.current=L||null,i(f.current)}return f.current.details||[]},T=async x=>{let N={type:"FeatureCollection",features:[]},B={type:"FeatureCollection",features:[]},z={type:"FeatureCollection",features:[]};if(x.forEach($=>{const L={type:"Feature",properties:$.type!=="move"?$:{},geometry:$.type==="move"?$.route.geometry:{type:"Point",coordinates:$.coordinates}};if($.type==="move")if($.route.geometry.coordinates.length===0){let R=$.route.locations.map(A=>A.coordinates);N.features.push({type:"Feature",geometry:{type:"LineString",coordinates:R}})}else N.features.push(L);else $.type==="checkin"?B.features.push(L):z.features.push(L)}),N.features.length){var b=ye(N);r.fitBounds(b,{maxZoom:16,duration:1e3})}await O(N),await H(B,z),await E(),await W()},O=x=>{try{if(!r.getImage("icon_arrow")){var N=new Image;N.onload=function(){r.hasImage("icon_arrow")||r.addImage("icon_arrow",N)},N.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.arrow)}r.getSource("ek-tracking-his-line-source")?r.getSource("ek-tracking-his-line-source").setData(x):(r.addSource("ek-tracking-his-line-source",{type:"geojson",data:x}),r.addLayer({id:"ek-tracking-his-LineString",type:"line",source:"ek-tracking-his-line-source",layout:{"line-join":"round","line-cap":"round",visibility:d.route.visible?"visible":"none"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity},filter:["==","$type","LineString"]}),r.addLayer({id:"ek-tracking-his-LineString-arrow",type:"symbol",source:"ek-tracking-his-line-source",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}},paint:{"icon-opacity":.9}}))}catch(B){console.error("Error setLine:",B)}},H=async(x,N)=>{try{if(!r.getImage("marker_start")){var B=new Image;B.onload=function(){r.hasImage("marker_start")||r.addImage("marker_start",B)},B.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.start)}if(!r.getImage("marker_end")){var z=new Image;z.onload=function(){r.hasImage("marker_end")||r.addImage("marker_end",z)},z.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.end)}if(!r.getImage("marker_check")){var b=new Image;b.onload=function(){r.hasImage("marker_check")||r.addImage("marker_check",b)},b.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.checkin)}if(!r.getImage("marker_stop")){var $=new Image;$.onload=function(){r.hasImage("marker_stop")||r.addImage("marker_stop",$)},$.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.stop)}r.getSource("ek-tracking-his-track-source")?r.getSource("ek-tracking-his-track-source").setData(N):(r.addSource("ek-tracking-his-track-source",{type:"geojson",data:N}),r.addLayer({id:"ek-tracking-his-track-point",type:"symbol",source:"ek-tracking-his-track-source",layout:{"icon-image":["match",["get","type"],"start","marker_start","end","marker_end","marker_stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),r.on("mouseenter","ek-tracking-his-track-point",L=>{r.getCanvas().style.cursor="pointer";const R=[[L.point.x-5,L.point.y-5],[L.point.x+5,L.point.y+5]];let q=r.queryRenderedFeatures(R,{layers:["ek-tracking-his-track-point"]})[0],de="default";q.properties.type!=="stop"&&(de=q.properties.type),k.current&&k.current.remove(),k.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(q.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${de}-color"></span>
                                            <span>${q.properties.address}</span>
                                        </div>
                                        ${q.properties.type!=="stop"?`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${de}-color"></span>
                                            <span>${g(q.properties.timestamp)}</span>
                                        </div>`:`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                </svg>
                                            </span>
                                            <span>${g(q.properties.startTime)}</span>
                                        </div>
                                        ${q.properties.endTime!==""?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                    </svg>
                                                </span>
                                                <span>${g(q.properties.endTime)}</span>
                                            </div>`:""} `}
                                    `).setOffset([5,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-track-point",()=>{r.getCanvas().style.cursor="",k.current&&k.current.remove()})),r.getSource("ek-tracking-his-check-source")?r.getSource("ek-tracking-his-check-source").setData(x):(r.addSource("ek-tracking-his-check-source",{type:"geojson",data:x,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),r.addLayer({id:"ek-tracking-his-check-clusters",type:"circle",source:"ek-tracking-his-check-source",paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-cluster-count",type:"symbol",source:"ek-tracking-his-check-source",layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-point",type:"symbol",source:"ek-tracking-his-check-source",layout:{"icon-image":"marker_check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),r.on("mouseenter","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor="pointer"}),r.on("mouseleave","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor=""}),r.on("click","ek-tracking-his-check-clusters",async L=>{const R=r.queryRenderedFeatures(L.point,{layers:["ek-tracking-his-check-clusters"]}),A=R[0].properties.cluster_id,q=await r.getSource("ek-tracking-his-check-source").getClusterExpansionZoom(A);r.easeTo({center:R[0].geometry.coordinates,zoom:q})}),r.on("mouseenter","ek-tracking-his-check-point",L=>{r.getCanvas().style.cursor="pointer";const R=[[L.point.x-5,L.point.y-5],[L.point.x+5,L.point.y+5]],A=r.queryRenderedFeatures(R,{layers:["ek-tracking-his-check-point"]});k.current&&k.current.remove(),k.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(A[0].geometry.coordinates).setHTML(`
                                <div class="ek-tracking-his-popup-info">
                                    <span style="font-weight:600">${A[0].properties.storeName}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${A[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${g(A[0].properties.startTime)}</span>
                                </div>
                                ${A[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${g(A[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-check-point",()=>{r.getCanvas().style.cursor="",k.current&&k.current.remove()}))}catch(L){console.error("Error setPoints:",L)}};async function W(){if(!r.getImage("marker_navigation")){var x=new Image;x.onload=function(){r.hasImage("marker_navigation")||r.addImage("marker_navigation",x)},x.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(d.icon.navigation)}var N={type:"FeatureCollection",features:[]};r.getSource("locationMarker")?r.getSource("locationMarker").setData(N):(r.addSource("locationMarker",{type:"geojson",data:N}),r.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker_navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}}catch(E){console.error("Error initializing map:",E)}},c=async r=>{var v,u,F={type:"FeatureCollection",features:[]};return r.forEach(p=>{if(p.type==="move")for(let I=0;I<p.route.locations.length;I++){let T=p.route.locations[I];if(new Date(T.timestamp).getTime()>=new Date(p.startTime).getTime()&&new Date(T.timestamp).getTime()<=new Date(p.endTime).getTime()){let O={type:"Feature",properties:{time:T.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:T.coordinates}};F.features.push(O)}}else if(p.type==="stop"||p.type==="checkin"){let I={type:"Feature",properties:{time:p.startTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}},T={type:"Feature",properties:{time:p.endTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};F.features.push(I,T)}else{let I={type:"Feature",properties:{time:p.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};F.features.push(I)}}),v=V(F),u=E(v),u||[];function V(p){var I={segments:[],id:e.objectId};let T=[];I.segments.push(T);for(let H=0;H<p.features.length;H++){var O=p.features[H];let W={loc:O.geometry.coordinates,time:new Date(O.properties.time).getTime(),ele:O.properties.ele};T.push(W)}return I}function E(p){const I=[];for(let x=0;x<p.segments.length;x++){const N=p.segments[x];for(let B=1;B<N.length;B++){const z=N[B-1],b=N[B];var T=z.time,O=b.time,H=new Date(T),W=new Date(O);let $=0;H.getDate()===W.getDate()&&H.getMonth()===W.getMonth()&&H.getFullYear()===W.getFullYear()&&($=G(z.loc[1],z.loc[0],b.loc[1],b.loc[0],z.ele,b.ele));const L={computed:{distance:$},loc1:z,loc2:b};if(z.ele&&b.ele&&(L.computed.ele=b.ele),z.time&&b.time&&z.time!==b.time){const{speed:R,time:A}=X($,z.time,b.time),q=R;L.computed.speed=R,L.computed.time=A,L.computed.filteredSpeed=q}z.temp&&b.temp&&(L.computed.temp=(z.temp+b.temp)/2),b.hr&&(L.computed.hr=b.hr),b.cad&&(L.computed.cad=b.cad),L.computed.speed&&I.push(L)}}return I}function G(p,I,T,O,H,W){const N=p*Math.PI/180,B=T*Math.PI/180,z=(T-p)*Math.PI/180,b=(O-I)*Math.PI/180,$=Math.sin(z/2)*Math.sin(z/2)+Math.cos(N)*Math.cos(B)*Math.sin(b/2)*Math.sin(b/2);let R=6371e3*(2*Math.atan2(Math.sqrt($),Math.sqrt(1-$)));if(H!==void 0&&W!==void 0){const A=W-H;A!==0&&(R=Math.sqrt(Math.pow(R,2)+Math.pow(A,2)))}return R}function X(p,I,T){const O=T/1e3-I/1e3;return{speed:(p/O||0)*3.6,time:O}}};o.useEffect(()=>(S({date:null,time:null,speed:0}),w({ready:!1,Data:[],options:null}),f.current=null,M.current=null,m(null),j(),()=>{k.current&&k.current.remove(),a.current&&a.current.remove()}),[e]),o.useEffect(()=>{if(_(null),s!==null){if(!f.current)return;const u=f.current.details[s];if(!u)return;if(u.type==="move")setTimeout(async()=>{l.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none");var F={type:"Feature",geometry:u.route.geometry};if(u.route.geometry.coordinates.length===0){let p=u.route.locations.map(I=>I.coordinates);F.geometry={type:"LineString",coordinates:p}}if(!l.getImage("icon_arrow")&&!l.hasImage("icon_arrow")){var V='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',E=new Image;E.onload=function(){l.hasImage("icon_arrow")||l.addImage("icon_arrow",E)},E.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(V)}l.getSource("RouteHistory")?l.getSource("RouteHistory").setData(F):(l.addSource("RouteHistory",{type:"geojson",data:F}),l.addLayer({id:"RouteHistory",type:"line",source:"RouteHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity}}),l.addLayer({id:"RouteHistory-arrow",type:"symbol",source:"RouteHistory",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}));var G=ye(F);l.fitBounds(G,{padding:100,maxZoom:17,duration:1e3});var X=await c([u]);setTimeout(()=>{w({ready:!0,Data:X,options:d})},200)},300);else if(u.type==="start"||u.type==="end"||u.type==="stop"||u.type==="checkin"){l.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),l.easeTo({center:u.coordinates,duration:100,zoom:17,bearing:0});var r;if(u.type==="start"||u.type==="end"){let F="default";u.type!="stop"&&(F=u.type),r=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${F}-color"></span>
                                <span>${u.address}</span>
                            </div>
                            ${u.type!=="stop"?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${F}-color"></span>
                                <span>${g(u.timestamp)}</span>
                            </div>`:`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                    </svg>
                                </span>
                                <span>${g(u.startTime)}</span>
                            </div>
                            ${u.endTime!==""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                        </svg>
                                    </span>
                                    <span>${g(u.endTime)}</span>
                                </div>`:""} `} `}(u.type==="stop"||u.type==="checkin")&&(r=`${u.type==="checkin"?`
                            <div class="ek-tracking-his-popup-info">
                                <span style="font-weight:600">${u.storeName}</span>
                            </div>`:""}
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                <span>${u.address}</span>
                            </div>
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                </span>
                                <span>${g(u.startTime)}</span>
                            </div>
                            ${u.endTime!=""?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                </span>
                                <span>${g(u.endTime)}</span>
                            </div>`:""}`),k.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!0,anchor:"bottom",focusAfterOpen:!1}).setLngLat(u.coordinates).setHTML(r).setOffset([0,-20]).addTo(l)}}else M.current&&w({ready:!0,Data:M.current,options:d});return()=>{try{k.current&&k.current.remove(),l&&(l.setPaintProperty("ek-tracking-his-LineString","line-color",d.route.lineCorlor),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",d.route.lineOpacity),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),l.getSource("RouteHistory")&&(l.removeLayer("RouteHistory"),l.removeLayer("RouteHistory-arrow"),l.removeSource("RouteHistory")))}catch(v){console.log(v)}}},[s]);function g(r){if(r||r!=""){const v=new Date(r);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(v)}else return"Không có thông tin"}const h=r=>{if(r){const v=new Date(r.loc1.time);v.setHours(v.getHours());const u=v.getDate(),F=v.getMonth()+1,V=v.getFullYear(),E=v.getHours(),G=v.getMinutes(),X=`${u}/${F}/${V}`,p=`${E.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}`;S({date:X,time:p,speed:Math.ceil(r.computed.speed*10)/10})}else S({date:null,time:null,speed:0})};return t.jsx(t.Fragment,{children:t.jsxs("div",{ref:n,id:"ekmap-tracking-his-map",children:[y.ready!==!1&&t.jsx(Qt,{map:l,segmentData:y.Data,options:y.options,Animation:P,currentInfo:h}),t.jsx(Zt,{}),C.date!==null&&C.time!==null&&t.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[t.jsxs(he,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:C.date}),t.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:C.time})]}),t.jsxs(he,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),t.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[C.speed," km/h"]})]})]})]})})}function Jt({employee:e}){const[i,s]=o.useState(re()),[n,a]=o.useState(re().startOf("day").toISOString()),[l,m]=o.useState(re().endOf("day").toISOString()),[y,w]=o.useState(""),[C,S]=o.useState([]),[f,M]=o.useState(""),P=j=>{setTimeout(()=>{s(j),a(j.startOf("day").toISOString()),m(j.endOf("day").toISOString())},200)},[_,k]=o.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:l}),D=async j=>{let c=await se.get("/api/method/mbw_dms.api.user.get_list_employees");if(c.message=="Thành công"){let g=c.result.map(function(h){return{value:h.name,label:h.employee_name,object_id:h.object_id}});S(g);for(let h=0;h<g.length;h++)if(e!=null&&g[h].object_id==e){setTimeout(()=>{M(g[h].value)},500);break}}},d=async(j,c)=>{k(g=>({...g,objectId:c.object_id})),w(`${c.label} - ${j}`),M(j)};return o.useEffect(()=>{(async()=>{if(e==null||e==""){const j=await se.get("/api/method/mbw_dms.api.user.get_projectID");k(c=>({...c,projectId:j.result["Project ID"],objectId:""})),D(j.result["Project ID"]);return}try{const j=await se.get("/api/method/mbw_dms.api.user.get_projectID");k(g=>({...g,projectId:j.result["Project ID"],objectId:e})),D(j.result["Project ID"]);const c=await se.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${e}`);c.message=="Thành công"&&c.result.length>0&&(w(c.result[0].employee_name),M(c.result[0].name))}catch(j){He.error(j?.message||"Something was wrong!!!")}})()},[e]),o.useEffect(()=>{(async()=>k(j=>({...j,from_time:n,to_time:l})))()},[n,l]),t.jsxs(t.Fragment,{children:[t.jsxs(oe,{className:"flex flex-wrap justify-between items-center px-0",children:[t.jsxs("div",{className:"flex justify-center items-center",children:[t.jsxs(Oe,{to:"/employee-monitor",children:[" ",t.jsx(It,{})]}),t.jsx("span",{className:"text-2xl font-semibold leading-[21px] mx-5",children:y})]}),t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(be,{value:f,style:{width:150},onChange:d,options:C})}),t.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(Re,{defaultValue:re(i),format:"DD-MM-YYYY",onChange:P})})]})]}),t.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:t.jsx("div",{id:"travel",className:"relative",children:_.projectId&&t.jsx(Wt,{options:_})})})]})}function Kt(){o.useState("list");const{employee_id:e}=De();return t.jsx(t.Fragment,{children:t.jsx(Jt,{employee:e})})}function ri(){return t.jsxs(t.Fragment,{children:[t.jsx(Ee,{children:t.jsx("title",{children:" EmployeeMonitor Detail"})}),t.jsx(Kt,{})]})}export{ri as default};
