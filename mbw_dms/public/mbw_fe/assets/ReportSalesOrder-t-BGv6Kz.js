import{L as e,a$ as s,Y as d,a2 as D,R as f,P as I,ac as E,V,ae as M}from"./index-o85vnTJF.js";import"https://cdn.jsdelivr.net/npm/nats.ws@1.29.2/+esm";import{C as z}from"./index-JgNcZNsL.js";import{u as P}from"./index-3JjCl_zE.js";import{a as Y,u as w,P as o,m as $}from"./useMediaQuery-q_iAER93.js";import{R as A,F as K}from"./ReportHeader-hhHMXqoE.js";import{D as O}from"./dropDownFilter-9d-yDTQQ.js";import"./VerticalAlignBottomOutlined--5Aiz4qV.js";import"./index.esm-LIvd7GLf.js";import"./data-u-VkVTNg.js";import"./index-Nws9UTPm.js";const q=({SummaryData:i})=>e.jsxs(s.Summary.Row,{children:[e.jsx(s.Summary.Cell,{index:0,className:"!border-r-0"}),e.jsx(s.Summary.Cell,{index:1}),e.jsx(s.Summary.Cell,{index:2,children:"Tổng"}),e.jsx(s.Summary.Cell,{index:3}),e.jsx(s.Summary.Cell,{index:5}),e.jsx(s.Summary.Cell,{index:6}),e.jsx(s.Summary.Cell,{index:7}),e.jsx(s.Summary.Cell,{index:8,children:e.jsx("div",{className:"text-right",children:Intl.NumberFormat().format(i?.sum_total||0)})}),e.jsx(s.Summary.Cell,{index:9,children:e.jsx("div",{className:"text-right",children:Intl.NumberFormat().format(i?.sum_vat||0)})}),e.jsx(s.Summary.Cell,{index:10,children:e.jsx("div",{className:"text-right",children:Intl.NumberFormat().format(i?.sum_discount_amount||0)})}),e.jsx(s.Summary.Cell,{index:11,children:e.jsx("div",{className:"text-right",children:Intl.NumberFormat().format(i?.sum_grand_total||0)})})]}),G=q;function B(){const i=[{title:e.jsx("div",{className:"relative",children:e.jsx("span",{className:"absolute -top-[11px] -left-8",children:"STT"})}),dataIndex:"stt",key:"stt",width:60,render:(a,t,r)=>e.jsx("span",{children:C(m,o,r)})},{title:"Đơn đặt",dataIndex:"name",key:"name",width:100,render:(a,t)=>e.jsx("a",{className:"text-[#212B36]",href:`/app/sales-invoice/${t.name}`,target:"_blank",children:t.name})},{title:"Khách hàng",dataIndex:"customer",key:"customer",width:120,render:(a,t)=>e.jsx("div",{className:"min-w-[120px]",children:t.customer})},{title:"Khu vực",dataIndex:"territory",key:"territory",width:120,render:(a,t)=>e.jsx("div",{className:"min-w-[120px]",children:t.territory})},{title:"Ngày tạo",dataIndex:"transaction_date",key:"transaction_date",width:120,render:(a,t)=>e.jsx("div",{className:"min-w-[120px]",children:V(t.transaction_date*1e3).format("DD/MM/YYYY")})},{title:"Nhân viên",dataIndex:"sales_person",key:"sales_person",width:120,render:(a,t)=>e.jsx("div",{className:"min-w-[120px]",children:t.sales_person})},{title:e.jsx("div",{className:"text-right",children:"Thành tiền (VNĐ)"}),dataIndex:"total",key:"total",width:140,render:(a,t)=>e.jsx("div",{className:"!text-right min-w-[120px]",children:Intl.NumberFormat().format(t.total)})},{title:e.jsx("div",{className:"text-right",children:"Tiền VAT (VNĐ)"}),dataIndex:"tax_amount",key:"tax_amount",width:140,render:(a,t)=>e.jsx("div",{className:"text-right  min-w-[120px]",children:Intl.NumberFormat().format(t.tax_amount)})},{title:e.jsx("div",{className:"text-right ",children:"Chiết khấu (VNĐ)"}),dataIndex:"discount_amount",key:"discount_amount",width:160,render:(a,t)=>e.jsx("div",{className:"text-right min-w-[120px]",children:Intl.NumberFormat().format(t.discount_amount)})},{title:e.jsx("div",{className:"text-right",children:"Tổng tiền (VNĐ)"}),width:160,dataIndex:"grand_total",key:"grand_total",render:(a,t)=>e.jsx("div",{className:"text-right min-w-[120px]",children:Intl.NumberFormat().format(t.grand_total)})}],[l,S]=d.useState([]),[c,b]=d.useState(0),[m,x]=d.useState(1),v=P(),[k,F]=d.useState(!1),u=Y(`${$}`),C=(a,t,r)=>(a-1)*t+r+1,T=a=>{const t=[{title:e.jsx("div",{className:"text-center",children:"STT"}),dataIndex:"stt",key:"stt",render:(r,n,R)=>e.jsx("div",{className:"text-center",children:R+1})},{title:"Mã sản phẩm",dataIndex:"item_code",key:"item_code"},{title:"Tên sản phẩm",dataIndex:"item_name",key:"item_name"},{title:"Nhóm sản phẩm",dataIndex:"item_group",key:"item_group"},{title:"Nhãn hàng",dataIndex:"brand",key:"brand"},{title:"Kho",dataIndex:"warehouse",key:"warehouse"},{title:e.jsx("div",{className:"text-right",children:"Đơn giá"}),dataIndex:"rate",key:"rate",render:(r,n)=>e.jsx("div",{className:"!text-right",children:Intl.NumberFormat().format(n.rate)})},{title:"Đơn vị tính",dataIndex:"uom",key:"uom"},{title:e.jsx("div",{className:"text-right",children:"Số lượng"}),dataIndex:"qty",key:"qty",render:(r,n)=>e.jsx("div",{className:"!text-right",children:n.qty})},{title:e.jsx("div",{className:"text-right",children:"Chiết khấu (%)"}),dataIndex:"discount_percentage",key:"discount_percentage",render:(r,n)=>e.jsx("div",{className:"!text-right",children:Intl.NumberFormat().format(n.discount_percentage)})},{title:e.jsx("div",{className:"text-right",children:"Tiền chiết khấu (VNĐ)"}),dataIndex:"discount_amount",key:"discount_amount",render:(r,n)=>e.jsx("div",{className:"!text-right",children:Intl.NumberFormat().format(n.discount_amount)})},{title:e.jsx("div",{className:"text-right",children:"Tiền VAT (VNĐ)"}),dataIndex:"money_vat",key:"money_vat",render:(r,n)=>e.jsx("div",{className:"!text-right",children:Intl.NumberFormat().format(n.money_vat)})},{title:e.jsx("div",{className:"text-right",children:"Tổng tiền (VNĐ)"}),dataIndex:"amount",key:"amount",render:(r,n)=>e.jsx("div",{className:"!text-right",children:Intl.NumberFormat().format(n.amount)})}];return e.jsx(s,{bordered:!0,columns:t,dataSource:a.items.map(r=>({...r,key:r.item_code})),pagination:!1})},{startDate:h,endDate:p}=w(a=>a.date),{employee:_,territory:j,company:g,customer:y,warehouse:N}=w(a=>a.group);return console.log(new Date(1731258e3*1e3)),d.useEffect(()=>{(async()=>{const a=await D.get("/api/method/mbw_dms.api.report.so_report.so_report",{params:{page_size:o,page_number:m,company:g,territory:j,customer:y,from_date:h,to_date:p,warehouse:N,sales_person:_}});let{result:t}=a;S(t),b(t?.totals)})()},[m,g,j,y,h,p,N,_,k]),e.jsx(e.Fragment,{children:e.jsx(z,{header:e.jsx(A,{setRefresh:F,title:"Báo cáo tổng hợp đặt hàng",params:{report_type:"Report Sell",data_filter:{company:g,territory:j,customer:y,from_date:h,to_date:p,warehouse:N,sales_person:_}},file_name:"Report Sell.xlsx"}),children:e.jsxs("div",{className:"bg-white rounded-2xl pt-4 pb-7 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs(f,{gutter:[16,16],className:`flex ${u?"justify-end":"justify-between"} items-center w-full`,children:[!u&&e.jsx(I,{className:"ml-4 w-[78%]",children:e.jsx(f,{className:"space-x-4",children:e.jsx(K,{setPage:x,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0})})}),e.jsx(I,{className:"!ml-4 ",children:e.jsx(O,{setPage:x,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0,inputCompany:!0,inputCustomer:!0,inputTerritory:!0,inputWarehouse:!0,matchMedia:!u})})]}),e.jsx("div",{className:"pt-5",children:e.jsx(E,{dataSource:l?.data?.map(a=>({...a,key:a.name})),expandable:{expandedRowRender:T,defaultExpandedRowKeys:["0"]},bordered:!0,$border:!0,columns:i,scroll:{x:l?.data?.length>0||v?.w<1400?!0:void 0,y:l?.data?.length>0?v?.h*.55:void 0},pagination:c&&c>o?{pageSize:o,showSizeChanger:!1,total:c,current:m,onChange(a){x(a)}}:!1,summary:()=>e.jsx(G,{summaryData:l?.sum})})})]})})})}function re(){return e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsx("title",{children:" ReportSalesOrder"})}),e.jsx(B,{})]})}export{re as default};
