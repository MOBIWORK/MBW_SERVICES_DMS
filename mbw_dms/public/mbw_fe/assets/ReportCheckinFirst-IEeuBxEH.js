import{Y as r,a3 as c,L as e,O as n,a5 as i,a8 as W}from"./index-f2ebGHSD.js";import{H as ee}from"./header-page-asjJ6skS.js";import{T as te}from"./tableCustom-npCcEs3_.js";import{e as se}from"./data-u-VkVTNg.js";import{u as m}from"./useDebount-bhUmEViI.js";import{D as I}from"./index-JgbXE0fR.js";import{V as re}from"./VerticalAlignBottomOutlined-iq1iyFs1.js";const ae=[{title:"STT",dataIndex:"stt",key:"stt",render:(o,s,p)=>p+1},{title:"Phòng/nhóm",dataIndex:"department",key:"department",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.department})},{title:"Mã nhân viên",dataIndex:"employee_id",key:"employee_id",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.employee_id})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.employee_name})},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_code})},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_name})},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_type})},{title:"Nhóm khách hàng",dataIndex:"customer_group",key:"customer_group",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_group})},{title:"Người liên hệ",dataIndex:"contact_person",key:"contact_person",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.contact_person})},{title:"SDT",dataIndex:"phone",key:"phone",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.phone})},{title:"Mã số thuế",dataIndex:"tax_id",key:"tax_id",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.tax_id})},{title:"Khu vực",dataIndex:"territory",key:"territory",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.territory})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(o,s)=>e.jsx("div",{className:"!w-[175px] truncate hover:whitespace-normal",children:s.address})},{title:"Ngày viếng thăm",dataIndex:"date_checkin",key:"date_checkin",render:(o,s)=>e.jsx("div",{className:"!w-[175px]",children:s.date_checkin?.split("-")?.reverse()?.toString()?.replaceAll(",","-")})}];function oe(){const[o,s]=r.useState([]),[p,G]=r.useState(0),d=20,[u,Y]=r.useState(1),[P,L]=r.useState([]),[h,x]=r.useState(""),[M,O]=r.useState("");let y=m(M,500);const[_,g]=r.useState(""),[K,R]=r.useState([]),[q,z]=r.useState("");let f=m(q,500);const[j,b]=r.useState(""),[A,H]=r.useState([]),[V,B]=r.useState("");let S=m(V,500);const[N,k]=r.useState(""),[w,F]=r.useState(""),[$,X]=r.useState([]),[Z,J]=r.useState("");let v=m(Z,500);const[C,D]=r.useState(),[E,T]=r.useState(),Q=t=>{if(t==null)D("");else{let a=Date.parse(t.$d)/1e3;D(a)}},U=t=>{if(t==null)T("");else{let a=Date.parse(t.$d)/1e3;T(a)}};return r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:y,doctype:"Department",ignore_user_permissions:0,query:""}}),{message:a}=t;console.log("Customer Group",a),L(a.map(l=>({value:l.value.trim(),label:l.value.trim()})))})()},[y]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:f,doctype:"Employee",ignore_user_permissions:0,query:""}}),{message:a}=t;console.log("rsEmployee",a),R(a.map(l=>({value:l.description.trim(),label:l.description.trim()})))})()},[f]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:S,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:a}=t;H(a.map(l=>({value:l.value.trim(),label:l.value.trim()})))})()},[S]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:a}=t;X(a.map(l=>({value:l.value,label:l.value})))})()},[v]),r.useEffect(()=>{(async()=>{const t=await c.get("/api/method/mbw_dms.api.report.first_checkin_rp.first_checkin_report",{params:{page_size:d,page_number:u,department:h,employee:_,customer_group:j,customer_type:N,territory:w,from_date:C,to_date:E}});let{result:a}=t;console.log("dt",a),s(a),G(a?.totals)})()},[u,h,_,j,N,w,C,E]),e.jsxs(e.Fragment,{children:[e.jsx(ee,{title:"Báo cáo thống kê khách hàng viếng thăm lần đầu",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(re,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-md py-7 px-4 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs("div",{className:"flex justify-start items-center pt-2",children:[e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Phòng ban"}),e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Nhân viên"}),e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Loại khách hàng"}),e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Nhóm khách hàng"}),e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Khu vực"})]}),e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(i,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:P,onSelect:t=>{x(t)},onSearch:t=>{O(t)},onClear:()=>x(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(i,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:K,onSelect:t=>{g(t)},onSearch:t=>{z(t)},onClear:()=>g(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(i,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:se,filterOption:!1,allowClear:!0,showSearch:!0,onSelect:t=>{k(t)},onClear:()=>k("")})}),e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(i,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:A,onSelect:t=>{b(t)},onSearch:t=>{B(t)},onClear:()=>b(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(i,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",defaultValue:"",options:$,onSelect:t=>{F(t)},onSearch:t=>{J(t)},onClear:()=>F(""),filterOption:!1,allowClear:!0,showSearch:!0})})]}),e.jsxs("div",{className:"flex justify-start items-center pt-2",children:[e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Từ ngày"}),e.jsx(n,{className:"w-[200px] border-none mr-2",label:"Đến ngày"})]}),e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(I,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:Q})}),e.jsx(n,{className:"w-[200px] border-none mr-2",children:e.jsx(I,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:U})})]}),e.jsx("div",{className:"pt-5",children:e.jsx(te,{dataSource:o?.data?.map(t=>({...t,key:t.name})),bordered:!0,pagination:{defaultPageSize:d,total:p,showSizeChanger:!1,onChange(t){Y(t)}},columns:ae,scroll:{x:!0}})})]})]})}function ue(){return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsx("title",{children:" ReportCheckinFirst"})}),e.jsx(oe,{})]})}export{ue as default};
