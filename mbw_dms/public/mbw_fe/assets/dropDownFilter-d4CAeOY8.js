import{V as H,Y as r,a_ as Te,a1 as c,a6 as Ee,L as s,a9 as ve,N as l,aa as Le,a2 as n,cu as m,cv as L,cw as K,cx as O,R as Ke,Q as h,cy as Oe,cz as Be,cA as u,cB as B,cC as q,cD as W,cE as G,cF as M,cG as R,cH as $,cI as Y,cJ as A}from"./index-CEN6Mloe.js";import{D as qe}from"./index-952KzMS_.js";import{a as We}from"./index.esm-MPmwYjc7.js";import{e as Ge,f as Me}from"./data-u-VkVTNg.js";import{c as Re,u as $e,d as Ye,M as Ae,T as He,Y as ze}from"./ReportHeader-xwMv1xUu.js";const Ve=H().startOf("month"),Je=H().endOf("month");let Qe=Date.parse(Ve.$d)/1e3,Ue=Date.parse(Je.$d)/1e3;const Xe=({setPage:i,matchMedia:z,inputFromDate:V,inputMonth:J,inputToDate:Q,inputYear:U,inputSaleGroup:X,inputEmployee:d,inputCompany:y,inputCustomer:x,inputTerritory:S,inputWarehouse:f,inputCustomerType:Z,inputCustomerGroup:g,inputOrder:P,inputSupplier:w,inputIndustry:F,inputBrand:b})=>{const[ee,se]=r.useState([]),[te,re]=r.useState([]),[ae,oe]=r.useState([]),[le,ne]=r.useState([]),[ce,ie]=r.useState([]),[me,pe]=r.useState([]),[he,ue]=r.useState([]),[de,ye]=r.useState([]),[xe,Se]=r.useState([]),[fe,ge]=r.useState([]),[_,we]=r.useState(""),[j,Fe]=r.useState(""),[C,be]=r.useState(""),[k,_e]=r.useState(""),[N,je]=r.useState(""),[D,Ce]=r.useState(""),[I,ke]=r.useState(""),[T,Ne]=r.useState(""),[E,De]=r.useState(""),[p]=Te(),t=Re(),{sales_team:v}=$e(e=>e.group);F&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:T,doctype:"DMS Industry",ignore_user_permissions:0,query:""}}),{message:o}=e;ue(o.map(a=>({value:a?.value,description:a?.description})))})()},[T]),b&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:I,doctype:"Brand",ignore_user_permissions:0,query:""}}),{message:o}=e;pe(o.map(a=>({value:a?.value,description:a?.description})))})()},[I]),x&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:C,doctype:"Customer",ignore_user_permissions:0,query:""}}),{message:o}=e;se(o.map(a=>({value:a.value,label:a.value})))})()},[C]),S&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:k,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:o}=e;oe(o.map(a=>({value:a.value,label:a.value})))})()},[k]),g&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:E,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:o}=e;ne(o.map(a=>({value:a.value.trim(),label:a.value.trim()})))})()},[E]),r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/mbw_dms.api.router.get_team_sale");ye(Ee({data:e.result.map(o=>({title:o.name,value:o.name,...o})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),d&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:v,key_search:j}}),{message:o}=e;Se(o.map(a=>({value:a.employee_code,label:a.employee_name||a.employee_code})))})()},[v,j]),y&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:N,doctype:"Company",ignore_user_permissions:0,query:""}}),{message:o}=e;ie(o.map(a=>({value:a.value,label:a.value})))})()},[N]),f&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:D,doctype:"Warehouse",ignore_user_permissions:0,query:""}}),{message:o}=e;re(o.map(a=>({value:a.value,label:a.value})))})()},[D]),w&&r.useEffect(()=>{(async()=>{let e=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:_,doctype:"Supplier",ignore_user_permissions:0,query:""}}),{message:o}=e;ge(o.map(a=>({value:a?.value,label:a.description.split(",")[0].trim()})))})()},[_]);const Ie=e=>{e.customergroup?t(B(e.customergroup)):t(B("")),e.customertype?t(q(e.customertype)):t(q("")),e.territory?t(W(e.territory)):t(W("")),e.has_sales_order?t(G(e.has_sales_order)):t(G("")),e.filter_month?t(M(Date.parse(e.filter_month.$d)/1e3)):t(M(Qe)),e.filter_year?t(R(Date.parse(e.filter_year.$d)/1e3)):t(R(Ue)),e.company?t($(e.company)):t($("")),e.customer?t(Y(e.customer)):t(Y("")),e.warehouse?t(A(e.warehouse)):t(A("")),e.filter_group_sales?t(u(e.filter_group_sales)):t(u("")),e.filter_employee?t(m(e.filter_employee)):t(m("")),i&&i(1)};return s.jsx(ve,{className:"!h-8",placement:"bottomRight",trigger:["click"],dropdownRender:()=>s.jsxs(qe,{title:"Bộ lọc",children:[s.jsxs(l,{layout:"vertical",form:p,onFinish:Ie,children:[!z&&s.jsxs(s.Fragment,{children:[V&&s.jsx(l.Item,{className:"w-[468px] border-none",name:"filter_month",children:s.jsx(Ye,{})}),J&&s.jsx(l.Item,{className:"w-[468px] border-none",name:"filter_month",children:s.jsx(Ae,{setPage:i})}),Q&&s.jsx(l.Item,{className:"w-[468px] border-none",name:"filter_year",children:s.jsx(He,{})}),U&&s.jsx(l.Item,{className:"w-[468px] border-none",name:"filter_year",children:s.jsx(ze,{})}),X&&s.jsx(l.Item,{className:"w-[468px] border-none",name:"filter_group_sales",label:"Nhóm bán hàng",children:s.jsx(Le,{placeholder:"Tất cả nhóm bán hàng",allowClear:!0,showSearch:!0,treeData:de,dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:350}})}),d&&s.jsx(l.Item,{className:"w-[468px] border-none",label:"Nhân viên",name:"filter_employee",children:s.jsx(n,{filterOption:!0,allowClear:!0,showSearch:!0,placeholder:"Tất cả nhân viên",onSearch:e=>{Fe(e)},options:xe,onClear:()=>{m&&m("")}})})]}),y&&s.jsx(l.Item,{name:"company",label:"Công ty",className:"w-[468px] border-none",children:s.jsx(n,{showSearch:!0,className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:ce,allowClear:!0,onSearch:e=>{je(e)},placeholder:"Tất cả công ty"})}),x&&s.jsx(l.Item,{name:"customer",label:"Khách hàng",className:"w-[468px] border-none",children:s.jsx(n,{showSearch:!0,className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:ee,filterOption:!1,allowClear:!0,onSearch:e=>{be(e)},placeholder:"Tất cả khách hàng"})}),f&&s.jsx(l.Item,{name:"warehouse",label:"Kho",className:"w-[468px] border-none",children:s.jsx(n,{showSearch:!0,className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:te,allowClear:!0,onSearch:e=>{Ce(e)},placeholder:"Tất cả kho"})}),Z&&s.jsx(l.Item,{name:"customertype",label:"Loại khách hàng",className:"w-[468px] border-none",children:s.jsx(n,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:Ge,allowClear:!0,showSearch:!0,placeholder:"Tất cả loại khách hàng"})}),g&&s.jsx(l.Item,{name:"customergroup",label:"Nhóm khách hàng",className:"w-[468px] border-none",children:s.jsx(n,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:le,allowClear:!0,onSearch:e=>{De(e)},showSearch:!0,placeholder:"Tất cả nhóm khách hàng"})}),P&&s.jsx(l.Item,{label:"Phát sinh đơn hàng",name:"hasorder",className:"w-[468px] border-none",children:s.jsx(n,{placeholder:"Tất cả",className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:Me,allowClear:!0,showSearch:!0})}),S&&s.jsx(l.Item,{name:"territory",label:"Khu vực",className:"w-[468px] border-none",children:s.jsx(n,{showSearch:!0,className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:ae,allowClear:!0,onSearch:e=>{_e(e)},placeholder:"Tất cả khu vực"})}),b&&s.jsx(l.Item,{name:"territory",label:"Nhãn hiệu",className:"w-[468px] border-none",children:s.jsx(n,{filterOption:!1,allowClear:!0,showSearch:!0,placeholder:"Tất cả nhãn hiệu",onSearch:e=>{ke(e)},options:me,onSelect:e=>{t(L(e)),i&&i(1)},onClear:()=>{t(L(""))}})}),w&&s.jsx(l.Item,{name:"supplier",label:"Nhà cung cấp",className:"w-[468px] border-none",children:s.jsx(n,{filterOption:!1,notFoundContent:null,allowClear:!0,showSearch:!0,placeholder:"Tất cả nhà cung cấp",onSearch:e=>{we(e)},options:fe,onSelect:e=>{t(K(e)),i&&i(1)},onClear:()=>{t(K(""))}})}),F&&s.jsx(l.Item,{name:"industry",label:"Ngành hàng",className:"w-[468px] border-none",children:s.jsx(n,{filterOption:!1,allowClear:!0,showSearch:!0,placeholder:"Tất cả ngành hàng",onSearch:e=>{Ne(e)},options:he,onSelect:e=>{t(O(e)),i&&i(1)},onClear:()=>{t(O(""))}})})]}),s.jsx(Ke,{className:"justify-between pt-6 pb-4",children:s.jsxs(s.Fragment,{children:[s.jsx(h,{className:"mr-3",onClick:e=>{e.preventDefault(),t(Oe("")),t(Be("")),t(u("")),t(m("")),p.resetFields()},children:"Đặt lại"}),s.jsx(h,{type:"primary",onClick:()=>{p.submit()},children:"Áp dụng"})]})})]}),children:s.jsx(h,{onClick:e=>e.preventDefault(),className:"flex items-center text-nowrap !text-[13px] !leading-[21px] !font-normal  border-r-[0.1px]  h-8 mt-4",icon:s.jsx(We,{style:{fontSize:"20px"}}),children:"Bộ lọc"})})},rs=Xe;export{rs as D};
