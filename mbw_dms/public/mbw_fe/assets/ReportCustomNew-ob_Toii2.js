import{W as r,a0 as c,L as e,O as o,a2 as m,by as a,a6 as E,a7 as J}from"./index-5WvYzfmG.js";import{H as Q}from"./header-page-lM-_JdDV.js";import{T as U}from"./tableCustom-X13tHqWP.js";import{e as $,g as ee}from"./data-71ee2cBp.js";import{u as d}from"./useDebount--t5o_IP0.js";import{V as te}from"./VerticalAlignBottomOutlined-D64dAoYh.js";const se=[{title:"STT",dataIndex:"stt",key:"stt",render:(l,s,u)=>u+1},{title:"Phòng ban",dataIndex:"department",key:"department",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.department})},{title:"Mã nhân viên",dataIndex:"employee_id",key:"employee_id",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.employee_id})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.employee_name})},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_code})},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_name})},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_type})},{title:"Nhóm khách hàng",dataIndex:"customer_group",key:"customer_group",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.customer_group})},{title:"Người liên hệ",dataIndex:"contact",key:"contact",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.contact})},{title:"SDT",dataIndex:"phone",key:"phone",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.phone})},{title:"Mã số thuế",dataIndex:"tax_id",key:"tax_id",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.tax_id})},{title:"Khu vưc",dataIndex:"territory",key:"territory",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.territory})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:s.contribution})},{title:"Ngày thu thập",dataIndex:"creation",key:"creation",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:E(s.creation*1e3).format("DD/MM/YYYY")})},{title:"Nguồn",dataIndex:"f1",key:"f1"},{title:"Số lần VT",dataIndex:"totals_checkin",key:"totals_checkin"},{title:"VT đầu",dataIndex:"first_checkin",key:"first_checkin"},{title:"VT cuối",dataIndex:"last_checkin",key:"last_checkin"},{title:"Số đơn hàng",dataIndex:"totals_so",key:"totals_so"},{title:"Đơn hàng cuối",dataIndex:"last_sale_order",key:"last_sale_order",render:(l,s)=>e.jsx("div",{className:"!w-[175px]",children:E(s.last_sale_order*1e3).format("DD/MM/YYYY")})}];function re(){const[l,s]=r.useState([]),[u,D]=r.useState(0),p=20,[x,G]=r.useState(1),[h,y]=r.useState(""),[O,P]=r.useState([]),[Y,L]=r.useState("");let _=d(Y,500);const[M,K]=r.useState([]),[S,j]=r.useState(""),[V,R]=r.useState(""),[g,f]=r.useState("");let k=d(V,500);const[b,w]=r.useState(""),[q,H]=r.useState([]),[z,A]=r.useState("");let N=d(z,500);const[C,F]=r.useState(""),[B,W]=r.useState([]),[X,Z]=r.useState("");let v=d(X,500);const[I,T]=r.useState();return r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:_,doctype:"Employee",ignore_user_permissions:0,query:""}}),{message:n}=t;console.log("rsEmployee",n),P(n.map(i=>({value:i.description.trim(),label:i.description.trim()})))})()},[_]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:k,doctype:"Department",ignore_user_permissions:0,query:""}}),{message:n}=t;console.log("Customer Group",n),K(n.map(i=>({value:i.value.trim(),label:i.value.trim()})))})()},[k]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:N,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:n}=t;console.log("Customer Group",n),H(n.map(i=>({value:i.value.trim(),label:i.value.trim()})))})()},[N]),r.useEffect(()=>{(async()=>{let t=await c.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:n}=t;W(n.map(i=>({value:i.value,label:i.value})))})()},[v]),r.useEffect(()=>{(async()=>{const t=await c.get("/api/method/mbw_dms.api.report.customer_report.customer_report",{params:{page_size:p,page_number:x,customer_type:g,customer_group:b,territory:C,employee:h,has_sales_order:I,department:S}});let{result:n}=t;console.log("result",n),s(n),D(n?.totals_cus)})()},[x,g,b,C,h,I,S]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Báo cáo khách hàng mới",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(te,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-md py-7 px-4 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs("div",{className:"flex justify-start items-center pt-2",children:[e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Phòng ban"}),e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Nhân viên"}),e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Loại khách hàng"}),e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Nhóm khách hàng"}),e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Khu vực"})]}),e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:M,onSelect:t=>{j(t)},onSearch:t=>{R(t)},onClear:()=>j(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:O,onSelect:t=>{y(t)},onSearch:t=>{L(t)},onClear:()=>y(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:$,filterOption:!1,allowClear:!0,showSearch:!0,onSelect:t=>{f(t)},onClear:()=>f("")})}),e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:q,onSelect:t=>{w(t)},onSearch:t=>{A(t)},onClear:()=>w(""),filterOption:!1,allowClear:!0,showSearch:!0})}),e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",defaultValue:"",options:B,onSelect:t=>{F(t)},onSearch:t=>{Z(t)},onClear:()=>F(""),filterOption:!1,allowClear:!0,showSearch:!0})})]}),e.jsx("div",{className:"flex justify-start items-center pt-4",children:e.jsx(o,{className:"w-[200px] border-none mr-2",label:"Phát sinh đơn hàng"})}),e.jsx("div",{className:"flex justify-start items-center",children:e.jsx(o,{className:"w-[200px] border-none mr-2",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:ee,filterOption:!1,allowClear:!0,showSearch:!0,onSelect:t=>{T(t)},onClear:()=>T(void 0)})})}),e.jsx("div",{className:"pt-5",children:e.jsx(U,{dataSource:l?.data?.map(t=>({...t,key:t.name})),bordered:!0,columns:se,pagination:{defaultPageSize:p,total:u,onChange(t){G(t)}},scroll:{x:!0},summary:()=>e.jsxs(a.Summary.Row,{children:[e.jsx(a.Summary.Cell,{index:0}),e.jsx(a.Summary.Cell,{index:1,children:"Tổng"}),e.jsx(a.Summary.Cell,{index:2}),e.jsx(a.Summary.Cell,{index:3}),e.jsx(a.Summary.Cell,{index:4}),e.jsx(a.Summary.Cell,{index:5}),e.jsx(a.Summary.Cell,{index:6}),e.jsx(a.Summary.Cell,{index:7}),e.jsx(a.Summary.Cell,{index:8}),e.jsx(a.Summary.Cell,{index:9}),e.jsx(a.Summary.Cell,{index:10}),e.jsx(a.Summary.Cell,{index:11}),e.jsx(a.Summary.Cell,{index:12}),e.jsx(a.Summary.Cell,{index:13}),e.jsx(a.Summary.Cell,{index:14}),e.jsx(a.Summary.Cell,{index:15,children:l?.sum?.sum_checkin}),e.jsx(a.Summary.Cell,{index:16}),e.jsx(a.Summary.Cell,{index:17}),e.jsx(a.Summary.Cell,{index:18,children:l?.sum?.sum_so})]})})})]})]})}function ce(){return e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsx("title",{children:" ReportCustomNew"})}),e.jsx(re,{})]})}export{ce as default};
