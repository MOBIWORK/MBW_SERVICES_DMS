import{aj as Y,at as ye,au as ve,ak as ce,ay as ue,bC as he,b3 as Ne,aw as Me,h as A,Y as o,ag as ze,aD as ke,br as Ie,bf as Fe,a9 as oe,aa as le,L as t,bx as _e,R as ae,P as X,az as Q,Q as ie,a5 as je,bD as He,aM as J,V as ne,a3 as re,aR as Oe,bE as Be,aZ as Pe,a8 as De}from"./index-6x8xrxcQ.js";import{D as Ee}from"./date-picker-NoGBPdM2.js";import{W as ee,c as Re,d as q,r as Ae,l as We,p as K,f as de,s as Ve,g as me,e as qe,b as fe}from"./WrapperCard-RI0Xrq2M.js";import"./index-FLl6hXu6.js";const be=["wrap","nowrap","wrap-reverse"],Se=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],we=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],Ge=(e,i)=>{const s={};return be.forEach(n=>{s[`${e}-wrap-${n}`]=i.wrap===n}),s},Ze=(e,i)=>{const s={};return we.forEach(n=>{s[`${e}-align-${n}`]=i.align===n}),s[`${e}-align-stretch`]=!i.align&&!!i.vertical,s},Xe=(e,i)=>{const s={};return Se.forEach(n=>{s[`${e}-justify-${n}`]=i.justify===n}),s};function Ye(e,i){return Y(Object.assign(Object.assign(Object.assign({},Ge(e,i)),Ze(e,i)),Xe(e,i)))}const Ue=e=>{const{componentCls:i}=e;return{[i]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},Je=e=>{const{componentCls:i}=e;return{[i]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},Ke=e=>{const{componentCls:i}=e,s={};return be.forEach(n=>{s[`${i}-wrap-${n}`]={flexWrap:n}}),s},Qe=e=>{const{componentCls:i}=e,s={};return we.forEach(n=>{s[`${i}-align-${n}`]={alignItems:n}}),s},et=e=>{const{componentCls:i}=e,s={};return Se.forEach(n=>{s[`${i}-justify-${n}`]={justifyContent:n}}),s},tt=()=>({}),it=ye("Flex",e=>{const{paddingXS:i,padding:s,paddingLG:n}=e,a=ve(e,{flexGapSM:i,flexGap:s,flexGapLG:n});return[Ue(a),Je(a),Ke(a),Qe(a),et(a)]},tt,{resetStyle:!1});var nt=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const rt=ce.forwardRef((e,i)=>{const{prefixCls:s,rootClassName:n,className:a,style:l,flex:m,gap:j,children:$,vertical:S=!1,component:L="div"}=e,f=nt(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:T,direction:O,getPrefixCls:I}=ce.useContext(ue),w=I("flex",s),[D,d,C]=it(w),c=S??T?.vertical,u=Y(a,n,T?.className,w,d,C,Ye(w,e),{[`${w}-rtl`]:O==="rtl",[`${w}-gap-${j}`]:he(j),[`${w}-vertical`]:c}),g=Object.assign(Object.assign({},T?.style),l);return m&&(g.flex=m),j&&!he(j)&&(g.gap=j),D(ce.createElement(L,Object.assign({ref:i,className:u,style:g},Ne(f,["justify","wrap","align"])),$))}),pe=rt,st=e=>{const{componentCls:i,calc:s}=e;return{[i]:Object.assign(Object.assign({},Me(e)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:s(s(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${A(e.itemHeadSize)})`,borderInlineStart:`${A(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${A(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:s(e.itemHeadSize).div(2).equal(),insetInlineStart:s(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:s(s(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:s(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:s(e.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:s(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:s(e.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${A(e.marginXXS)})`,width:`calc(50% - ${A(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${A(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${A(s(s(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${A(s(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${A(e.margin)})`,borderInlineStart:`${A(e.tailWidth)} dotted ${e.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${A(e.margin)})`,borderInlineStart:`${A(e.tailWidth)} dotted ${e.tailColor}`},[`${i}-item-content`]:{minHeight:s(e.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:s(s(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${A(e.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${A(e.marginSM)})`,width:`calc(50% - ${A(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},at=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),ot=ye("Timeline",e=>{const i=ve(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[st(i)]},at);var lt=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const ct=e=>{var{prefixCls:i,className:s,color:n="blue",dot:a,pending:l=!1,position:m,label:j,children:$}=e,S=lt(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:L}=o.useContext(ue),f=L("timeline",i),T=Y(`${f}-item`,{[`${f}-item-pending`]:l},s),O=/blue|red|green|gray/.test(n||"")?void 0:n,I=Y(`${f}-item-head`,{[`${f}-item-head-custom`]:!!a,[`${f}-item-head-${n}`]:!O});return o.createElement("li",Object.assign({},S,{className:T}),j&&o.createElement("div",{className:`${f}-item-label`},j),o.createElement("div",{className:`${f}-item-tail`}),o.createElement("div",{className:I,style:{borderColor:O,color:O}},a),o.createElement("div",{className:`${f}-item-content`},$))},Ce=ct;var xe=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const dt=e=>{var{prefixCls:i,className:s,pending:n=!1,children:a,items:l,rootClassName:m,reverse:j=!1,direction:$,hashId:S,pendingDot:L,mode:f=""}=e,T=xe(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const O=(g,r)=>f==="alternate"?g==="right"?`${i}-item-right`:g==="left"?`${i}-item-left`:r%2===0?`${i}-item-left`:`${i}-item-right`:f==="left"?`${i}-item-left`:f==="right"?`${i}-item-right`:g==="right"?`${i}-item-right`:"",I=ze(l||[]),w=typeof n=="boolean"?null:n;n&&I.push({pending:!!n,dot:L||o.createElement(ke,null),children:w}),j&&I.reverse();const D=I.length,d=`${i}-item-last`,C=I.filter(g=>!!g).map((g,r)=>{var b;const h=r===D-2?d:"",F=r===D-1?d:"",{className:W}=g,E=xe(g,["className"]);return o.createElement(Ce,Object.assign({},E,{className:Y([W,!j&&n?h:F,O((b=g?.position)!==null&&b!==void 0?b:"",r)]),key:g?.key||r}))}),c=I.some(g=>!!g?.label),u=Y(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!j,[`${i}-${f}`]:!!f&&!c,[`${i}-label`]:c,[`${i}-rtl`]:$==="rtl"},s,m,S);return o.createElement("ul",Object.assign({},T,{className:u}),C)},pt=dt;function ut(e,i){return e&&Array.isArray(e)?e:Ie(i).map(s=>{var n,a;return Object.assign({children:(a=(n=s?.props)===null||n===void 0?void 0:n.children)!==null&&a!==void 0?a:""},s.props)})}var gt=function(e,i){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(s[n[a]]=e[n[a]]);return s};const $e=e=>{const{getPrefixCls:i,direction:s,timeline:n}=o.useContext(ue),{prefixCls:a,children:l,items:m,className:j,style:$}=e,S=gt(e,["prefixCls","children","items","className","style"]),L=i("timeline",a),f=Fe(L),[T,O,I]=ot(L,f),w=ut(m,l);return T(o.createElement(pt,Object.assign({},S,{className:Y(n?.className,j,I,f),style:Object.assign(Object.assign({},n?.style),$),prefixCls:L,direction:s,items:w,hashId:O})))};$e.Item=Ce;const ht=$e;var mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const ft=mt;var xt=function(i,s){return o.createElement(oe,le({},i,{ref:s,icon:ft}))};const yt=o.forwardRef(xt);var vt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const kt=vt;var jt=function(i,s){return o.createElement(oe,le({},i,{ref:s,icon:kt}))};const bt=o.forwardRef(jt);var St={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const wt=St;var Ct=function(i,s){return o.createElement(oe,le({},i,{ref:s,icon:wt}))};const $t=o.forwardRef(Ct);var Lt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const Tt=Lt;var Nt=function(i,s){return o.createElement(oe,le({},i,{ref:s,icon:Tt}))};const Mt=o.forwardRef(Nt),zt=({size:e=16})=>t.jsx("svg",{width:e,height:e+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function It(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function Ft({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_start})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function _t(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function Ht({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_end})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Ot(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function Bt({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_checking})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.retail_name})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Pt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function Dt({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_moving})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),t.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[e.total_distance," Trip"]})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function Et(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function Rt({data:e,onEventClickItem:i}){const s=()=>{i(e.index_item)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex",children:[t.jsxs("div",{style:{cursor:"pointer",width:"100%"},onClick:s,children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_stop})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]}),e.active_item&&t.jsx("div",{style:{position:"relative"},children:t.jsx("div",{style:{position:"absolute",right:"-16px",width:"6px",height:"100%",backgroundColor:"#1c6fdb"}})})]})})}function At({options:e}){const[i,s]=o.useState([]),[n,a]=o.useState({summary:null,details:[]}),[l,m]=o.useState(!0),[j,$]=o.useState(null),[S,L]=o.useState([]);o.useEffect(()=>{m(!0),$(null)},[e]);const f=c=>{let u=S;$(g=>{if(g==c){u[c].active_item=!1;let r=T(u);return s(r),L(u),null}else{for(let b=0;b<u.length;b++)b==c?u[b].active_item=!0:u[b].active_item=!1;let r=T(u);return s(r),L(u),c}})};o.useEffect(()=>{let c=T(n.details);s(c)},[n]);const T=c=>{let u=[];if(c!=null)for(let g=0;g<c.length;g++){let r=c[g];r.type=="start"?u.push({dot:t.jsx(It,{}),children:t.jsx(Ft,{data:{time_start:C(r.timestamp),address:r.address,index_item:g,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="checkin"?u.push({dot:t.jsx(Ot,{}),children:t.jsx(Bt,{data:{time_checking:`${C(r.startTime)} - ${C(r.endTime)}`,retail_name:r.storeName,address:r.address,total_time:`${I(r.startTime,r.endTime)}`,index_item:g,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="move"?u.push({dot:t.jsx(Pt,{}),children:t.jsx(Dt,{data:{time_moving:`${C(r.startTime)} - ${C(r.endTime)}`,total_distance:`${w(r.distance)}`,total_time:`${I(r.startTime,r.endTime)}`,index_item:g,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="stop"?u.push({dot:t.jsx(Et,{}),children:t.jsx(Rt,{data:{time_stop:`${C(r.startTime)} - ${C(r.endTime)}`,address:r.address,total_time:`${I(r.startTime,r.endTime)}`,index_item:g,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})}):r.type=="end"&&u.push({dot:t.jsx(_t,{}),children:t.jsx(Ht,{data:{time_end:`${C(r.timestamp)}`,address:r.address,index_item:g,active_item:r.active_item!=null?r.active_item:!1},onEventClickItem:f})})}return u},O=c=>{c!=null?(a(c),L(c.details)):(a({summary:null,details:[]}),L([])),m(!1)},I=(c,u)=>{const g=new Date(c),b=new Date(u)-g;if(b<6e4)return`${Math.round(b/1e3)} giây`;if(b>=6e4&&b<6e4*60)return`${Math.round(b/6e4)} phút`;{const h=Math.floor(b/36e5),F=Math.floor(b%(1e3*60*60)/(1e3*60));return`${h} giờ ${F} phút`}},w=c=>c<1e3?`${Math.round(c)} m`:`${Math.round(c/1e3)} km`,D=c=>c<60?`${Math.round(c)} giây`:c>=60&&c<3600?`${Math.round(c/60)} phút`:`${Math.round(c/3600)} giờ`,d=c=>Math.round(c*3.6),C=c=>{var u=new Date(c);return u.setUTCHours(u.getUTCHours()+7),`${u.getUTCHours()}:${u.getUTCMinutes()}`};return t.jsxs(t.Fragment,{children:[l&&t.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(_e,{indicator:t.jsx(ke,{style:{fontSize:30,color:"#fff"},spin:!0})})}),t.jsxs(ae,{gutter:20,children:[t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&w(n.summary.move.distance)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.move.totalTime)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),n.summary!=null?t.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[n.summary&&d(n.summary.move.avgSpeed)," km/h"]}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),t.jsx(X,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[t.jsxs("div",{style:{marginRight:"40px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.stop.count?n.summary.stop.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.stop.totalTime)?D(n.summary.stop.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})}),t.jsx(X,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[t.jsxs("div",{style:{marginRight:"13px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.checkin.count?n.summary.checkin.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&D(n.summary.checkin.totalTime)?D(n.summary.checkin.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})})]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(ae,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:t.jsx(Re,{children:t.jsxs(ae,{children:[t.jsxs(X,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[t.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),t.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?t.jsx(ht,{mode:"left",items:i}):t.jsx("div",{children:"Chưa có lộ trình"})})]}),t.jsx(X,{span:18,style:{height:"600px"},children:t.jsx(Ut,{options:e,onLoad:O,HistoryIndex:j})})]})})})})]})}function Wt(){const[e,i]=o.useState(!1),s=()=>{i(!e)},n={iconStart:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",iconEnd:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",iconCheckin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",iconStop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"};return t.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[t.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:s,children:[t.jsx("span",{className:`icon ${e?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),t.jsx("span",{children:"Chú giải bản đồ"})]}),t.jsx("div",{className:`ekmapplf_tracking-legend-body ${e?"open":""}`,style:{maxHeight:e?"none":"0"},children:t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStart})`}}),"Vị trí bắt đầu"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconEnd})`}}),"Vị trí kết thúc"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconCheckin})`}}),"Vị trí khách hàng"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStop})`}}),"Vị trí điểm dừng"]})]})})]})}function te(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Vt(e){return e.type==="Feature"?e.geometry:e}function Le(e,i,s){s===void 0&&(s={});var n=te(e),a=te(i),l=q(a[1]-n[1]),m=q(a[0]-n[0]),j=q(n[1]),$=q(a[1]),S=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(m/2),2)*Math.cos(j)*Math.cos($);return Ae(2*Math.atan2(Math.sqrt(S),Math.sqrt(1-S)),s.units)}function qt(e,i,s,n){n===void 0&&(n={});var a=te(e),l=q(a[0]),m=q(a[1]),j=q(s),$=We(i,n.units),S=Math.asin(Math.sin(m)*Math.cos($)+Math.cos(m)*Math.sin($)*Math.cos(j)),L=l+Math.atan2(Math.sin(j)*Math.sin($)*Math.cos(m),Math.cos($)-Math.sin(m)*Math.sin(S)),f=de(L),T=de(S);return K([f,T],n.properties)}function ge(e,i,s){if(s===void 0&&(s={}),s.final===!0)return Gt(e,i);var n=te(e),a=te(i),l=q(n[0]),m=q(a[0]),j=q(n[1]),$=q(a[1]),S=Math.sin(m-l)*Math.cos($),L=Math.cos(j)*Math.sin($)-Math.sin(j)*Math.cos($)*Math.cos(m-l);return de(Math.atan2(S,L))}function Gt(e,i){var s=ge(i,e);return s=(s+180)%360,s}function Zt(e,i,s){s===void 0&&(s={});for(var n=Vt(e),a=n.coordinates,l=0,m=0;m<a.length&&!(i>=l&&m===a.length-1);m++)if(l>=i){var j=i-l;if(j){var $=ge(a[m],a[m-1])-180,S=qt(a[m],j,$,s);return S}else return K(a[m])}else l+=Le(a[m],a[m+1],s);return K(a[a.length-1])}function Xt(e,i){return i===void 0&&(i={}),Ve(e,function(s,n){var a=n.geometry.coordinates;return s+Le(a[0],a[1],i)},0)}const Yt=({map:e,segmentData:i,options:s,currentInfo:n,Animation:a})=>{const l=o.useRef(null),m=o.useRef(null),[j,$]=o.useState(s.animation.follow),[S,L]=o.useState(!1),[f,T]=o.useState(10),[O,I]=o.useState(!0),w=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[D,d]=o.useState(!0),C=o.useRef(0),c=o.useRef(0),u=o.useRef([]);function g(p,z){c.current=p;const M=z[p];if(!M){if(O){c.current=0,u.current=[];try{e&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(R){L(!1),console.log(R)}i.length&&i[0].computed.time&&(m.current=setTimeout(g.bind(this),1e3,c.current,i))}else c.current=p-1,V();n(z[c.current]);return}if(n(M),M.computed.time){let R=M.computed.time*1e3/f;if(M.computed.speed){let k=function(_){P||(B=M.loc1.loc,P=_);const x=(_-P)/(Number(M.computed.time?.toString())*1e3/f);if(!(x>1||!S)){var N=me([M.loc1.loc,M.loc2.loc]),v=Xt(N),y=Zt(N,v*x).geometry.coordinates,H=ge(K(B),K(y));B[0]!==y[0]&&B[1]!==y[1]&&(C.current=H),B=y,u.current=u.current.concat([y]);try{e&&j&&e.panTo(y,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:C.current}),e&&e.getSource("locationMarker")&&e.getSource("locationMarker").setData({type:"FeatureCollection",features:[K(y,{bearing:C.current})]}),e&&u.current.length>1&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[me(u.current)]}),l.current=window.requestAnimationFrame(k)}catch(Z){L(!1),console.log(Z)}}};var P,B;l.current=window.requestAnimationFrame(k)}p++,u.current=z.slice(0,p).map(k=>k.loc1.loc),m.current=setTimeout(g.bind(this),R,p,z)}}o.useEffect(()=>{L(!1),l.current&&cancelAnimationFrame(l.current),m.current&&clearTimeout(m.current),c.current=0,i.length},[i,s]),o.useEffect(()=>{a===!0&&W(),a===!1&&E(),a===null&&V()},[a]),o.useEffect(()=>{if(S){c.current===0&&(u.current=[],e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc)),i.length&&i[0].computed.time&&(m.current=setTimeout(g.bind(void 0),500,c.current,i));try{e.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",.4),e.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),e.setLayoutProperty("locationMarker","visibility","visible"),e.setLayoutProperty("LocationHistory","visibility","visible"),e.getSource("RouteHistory")&&(e.removeLayer("RouteHistory"),e.removeLayer("RouteHistory-arrow"),e.removeSource("RouteHistory"))}catch(p){console.log(p)}}else{n(null),l.current&&cancelAnimationFrame(l.current);try{e.setPaintProperty("ek-tracking-his-LineString","line-color",s.route.lineCorlor),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",s.route.lineOpacity),e.setLayoutProperty("ek-tracking-his-LineString","visibility","visible"),e.setLayoutProperty("locationMarker","visibility","none"),e.setLayoutProperty("LocationHistory","visibility","none")}catch(p){console.log(p)}}return()=>{l.current&&cancelAnimationFrame(l.current),m.current&&clearTimeout(m.current)}},[S,f,j,O]);const[r,b]=o.useState(null);o.useEffect(()=>{const p=()=>{d(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",p),()=>{document.removeEventListener("visibilitychange",p)}},[]),o.useEffect(()=>{D?L(!!(r&&r===!0)):(b(S),L(!1))},[D]);const h=p=>{T(p)},F=p=>{p.target.checked&&e.setZoom(17),$(!j)},W=()=>{L(!0)},E=()=>{L(!1)},V=()=>{E();try{e&&(e.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc))}catch(p){console.log(p)}c.current=0},G=()=>{I(!O)};return t.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:t.jsxs(pe,{gap:"small",align:"center",justify:"center",children:[t.jsx(Q,{title:"Play",children:t.jsx(ie,{icon:t.jsx(bt,{}),disabled:S,onClick:W})}),t.jsx(Q,{title:"Pause",children:t.jsx(ie,{icon:t.jsx($t,{}),disabled:!S,onClick:E})}),t.jsx(Q,{title:"Stop",children:t.jsx(ie,{icon:t.jsx(yt,{}),onClick:V})}),t.jsx(Q,{title:"Replay",children:t.jsx(ie,{type:O?"primary":"default",icon:t.jsx(Mt,{}),onClick:G})}),t.jsx(Q,{title:"Speed",children:t.jsx(je,{defaultValue:f,style:{width:"75px"},onChange:h,options:w})}),t.jsx(He,{onChange:F,checked:j,children:"Theo dõi lộ trình"})]})})},se=window.ekmapplf;function Ut({options:e,onLoad:i,HistoryIndex:s}){const n=o.useRef(null),a=o.useState(null),[l,m]=o.useState(null),[j,$]=o.useState({ready:!1,Data:[],options:null}),[S,L]=o.useState({date:null,time:null,speed:0}),f=o.useRef(null),T=o.useRef(null),[O,I]=o.useState(!1),w=o.useRef(null),d=qe({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{track:"https://files.ekgis.vn/sdks/tracking/assets/custom_marker.png",navigation:"https://files.ekgis.vn/sdks/tracking/assets/arrow.png",checkin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",start:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",end:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",stop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"},route:{visible:!0,lineCorlor:"#0F53FF",lineWidth:6.5,lineOpacity:.9},animation:{follow:!0,animate:!1}},e),C=()=>{try{let E=function(){var k={type:"FeatureCollection",features:[]};r.getSource("LocationHistory")?r.getSource("LocationHistory").setData(k):(r.addSource("LocationHistory",{type:"geojson",data:k}),r.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity},filter:["==","$type","LineString"]}))};a.current&&a.current.remove(),a.current=new J.Map({container:n.current,center:d.center,zoom:d.zoom,minZoom:1});var r=a.current;m(r);const V=r.getContainer();r.setPadding({top:100,bottom:100,left:100,right:100}),new se.VectorBaseMap("OSM:Night",d.apiKey).addTo(r);var b=new se.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+V.id,baseLayers:[{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});r.addControl(b,"bottom-left"),b.on("changeBaseLayer",async function(k){I(!1),new se.VectorBaseMap(k.layer,d.apiKey).addTo(r),setTimeout(async()=>{await p(d.from_time,d.to_time,d.pageNumber,d.pageSize)},1e3)}),r.addControl(new J.NavigationControl({visualizePitch:!0}),"bottom-right");var h=!1;r.getPitch()>0?h=!0:h=!1;var F="maplibregl-terrain2d-control",W="Hiển thị 2D";h||(F="maplibregl-terrain3d-control",W="Bản đồ 3D");let G=new se.control.Button({className:"btn-ctl-group "+F,icon:"none",tooltip:W});G.on("click",k=>{h=!h,h?(k._div.className=k._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),k._div.title="Hiển thị 2D"):(k._div.className=k._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),k._div.title="Hiển thị 3D"),h?(r.easeTo({pitch:60}),r.setLayoutProperty("building-3d","visibility","visible")):(r.easeTo({pitch:0}),r.setLayoutProperty("building-3d","visibility","none"))}),r.addControl(G,"bottom-right"),r.addControl(new J.FullscreenControl,"top-right"),r.on("load",()=>{try{if(!d.objectId||d.objectId===""||d.objectId==="null"||!d.from_time||d.from_time===""||d.from_time==="null"||!d.to_time||d.to_time===""||d.to_time==="null"){i(null);return}p(d.from_time,d.to_time,d.pageNumber,d.pageSize)}catch(k){console.error("Error:",k)}});const p=async(k,_,x,N)=>{I(!1);let v=await z(k,_,x,N);await M(v);let y=await c(v);T.current=y,v.length&&v[0].coordinates&&d.animation.animate&&r.easeTo({center:v[0].coordinates,duration:100,zoom:16}),setTimeout(()=>{$({ready:!0,Data:y,options:d})},300)},z=async(k,_,x,N)=>{if(!f.current){let v=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${d.projectId}/${d.objectId}?api_key=${d.apiKey}&from_time=${k}&to_time=${_}`;const H=await(await fetch(v)).json();f.current=H,i(f.current)}return f.current.details||[]},M=async k=>{let _={type:"FeatureCollection",features:[]},x={type:"FeatureCollection",features:[]},N={type:"FeatureCollection",features:[]};if(k.forEach(y=>{const H={type:"Feature",properties:y.type!=="move"?y:{},geometry:y.type==="move"?y.route.geometry:{type:"Point",coordinates:y.coordinates}};if(_.features.push(H),y.type==="move"&&y.route.geometry.coordinates.length===0){let Z=y.route.locations.map(U=>U.coordinates);_.features.push({type:"Feature",geometry:{type:"LineString",coordinates:Z}})}y.type!=="move"&&(y.type==="checkin"?x.features.push(H):N.features.push(H))}),k.length){var v=fe(_);r.fitBounds(v,{maxZoom:16,duration:1e3})}await P(_),await B(x,N),await E(),await R()},P=k=>{try{if(!r.getImage("icon_arrow")){var _='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',x=new Image;x.onload=function(){r.hasImage("icon_arrow")||r.addImage("icon_arrow",x)},x.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(_)}r.getSource("ek-tracking-his-line-source")?r.getSource("ek-tracking-his-line-source").setData(k):(r.addSource("ek-tracking-his-line-source",{type:"geojson",data:k}),r.addLayer({id:"ek-tracking-his-LineString",type:"line",source:"ek-tracking-his-line-source",layout:{"line-join":"round","line-cap":"round",visibility:d.route.visible?"visible":"none"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity},filter:["==","$type","LineString"]}),r.addLayer({id:"ek-tracking-his-LineString-arrow",type:"symbol",source:"ek-tracking-his-line-source",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}},paint:{"icon-opacity":.9}}))}catch(N){console.error("Error setLine:",N)}},B=async(k,_)=>{try{if(!r.getImage("marker-start")){const x=await r.loadImage(d.icon.start);r.addImage("marker-start",x.data)}if(!r.getImage("marker-end")){const x=await r.loadImage(d.icon.end);r.addImage("marker-end",x.data)}if(!r.getImage("marker-check")){const x=await r.loadImage(d.icon.checkin);r.addImage("marker-check",x.data)}if(!r.getImage("marker-stop")){const x=await r.loadImage(d.icon.stop);r.addImage("marker-stop",x.data)}r.getSource("ek-tracking-his-track-source")?r.getSource("ek-tracking-his-track-source").setData(_):(r.addSource("ek-tracking-his-track-source",{type:"geojson",data:_}),r.addLayer({id:"ek-tracking-his-track-point",type:"symbol",source:"ek-tracking-his-track-source",layout:{"icon-image":["match",["get","type"],"start","marker-start","end","marker-end","marker-stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),r.on("mouseenter","ek-tracking-his-track-point",x=>{r.getCanvas().style.cursor="pointer";const N=[[x.point.x-5,x.point.y-5],[x.point.x+5,x.point.y+5]];let y=r.queryRenderedFeatures(N,{layers:["ek-tracking-his-track-point"]})[0],H="default";y.properties.type!="stop"&&(H=y.properties.type),w.current&&w.current.remove(),w.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(y.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${H}-color"></span>
                                            <span>${y.properties.address}</span>
                                        </div>
                                        ${y.properties.type!=="stop"?`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${H}-color"></span>
                                            <span>${u(y.properties.timestamp)}</span>
                                        </div>`:`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                </svg>
                                            </span>
                                            <span>${u(y.properties.startTime)}</span>
                                        </div>
                                        ${y.properties.endTime!==""?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                    </svg>
                                                </span>
                                                <span>${u(y.properties.endTime)}</span>
                                            </div>`:""} `}
                                    `).setOffset([0,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-track-point",()=>{r.getCanvas().style.cursor="",w.current&&w.current.remove()})),r.getSource("ek-tracking-his-check-source")?r.getSource("ek-tracking-his-check-source").setData(k):(r.addSource("ek-tracking-his-check-source",{type:"geojson",data:k,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),r.addLayer({id:"ek-tracking-his-check-clusters",type:"circle",source:"ek-tracking-his-check-source",paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-cluster-count",type:"symbol",source:"ek-tracking-his-check-source",layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-point",type:"symbol",source:"ek-tracking-his-check-source",layout:{"icon-image":"marker-check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),r.on("mouseenter","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor="pointer"}),r.on("mouseleave","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor=""}),r.on("click","ek-tracking-his-check-clusters",async x=>{const N=r.queryRenderedFeatures(x.point,{layers:["ek-tracking-his-check-clusters"]}),v=N[0].properties.cluster_id,y=await r.getSource("ek-tracking-his-check-source").getClusterExpansionZoom(v);r.easeTo({center:N[0].geometry.coordinates,zoom:y})}),r.on("mouseenter","ek-tracking-his-check-point",x=>{r.getCanvas().style.cursor="pointer";const N=[[x.point.x-5,x.point.y-5],[x.point.x+5,x.point.y+5]],v=r.queryRenderedFeatures(N,{layers:["ek-tracking-his-check-point"]});w.current&&w.current.remove(),w.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(v[0].geometry.coordinates).setHTML(`<div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${v[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${u(v[0].properties.startTime)}</span>
                                </div>
                                ${v[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${u(v[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-check-point",()=>{r.getCanvas().style.cursor="",w.current&&w.current.remove()}))}catch(x){console.error("Error setPoints:",x)}};async function R(){if(!r.getImage("marker-navigation")){const _=await r.loadImage(d.icon.navigation);r.addImage("marker-navigation",_.data)}var k={type:"FeatureCollection",features:[]};r.getSource("locationMarker")?r.getSource("locationMarker").setData(k):(r.addSource("locationMarker",{type:"geojson",data:k}),r.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker-navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}}catch(E){console.error("Error initializing map:",E)}},c=async r=>{var b,h,F={type:"FeatureCollection",features:[]};return r.forEach(p=>{if(p.type==="move")for(let z=0;z<p.route.locations.length;z++){let M=p.route.locations[z];if(new Date(M.timestamp).getTime()>=new Date(p.startTime).getTime()&&new Date(M.timestamp).getTime()<=new Date(p.endTime).getTime()){let P={type:"Feature",properties:{time:M.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:M.coordinates}};F.features.push(P)}}else if(p.type==="stop"||p.type==="checkin"){let z={type:"Feature",properties:{time:p.startTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}},M={type:"Feature",properties:{time:p.endTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};F.features.push(z,M)}else{let z={type:"Feature",properties:{time:p.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};F.features.push(z)}}),b=W(F),h=E(b),h||[];function W(p){var z={segments:[],id:e.objectId};let M=[];z.segments.push(M);for(let B=0;B<p.features.length;B++){var P=p.features[B];let R={loc:P.geometry.coordinates,time:new Date(P.properties.time).getTime(),ele:P.properties.ele};M.push(R)}return z}function E(p){const z=[];for(let k=0;k<p.segments.length;k++){const _=p.segments[k];for(let x=1;x<_.length;x++){const N=_[x-1],v=_[x];var M=N.time,P=v.time,B=new Date(M),R=new Date(P);let y=0;B.getDate()===R.getDate()&&B.getMonth()===R.getMonth()&&B.getFullYear()===R.getFullYear()&&(y=V(N.loc[1],N.loc[0],v.loc[1],v.loc[0],N.ele,v.ele));const H={computed:{distance:y},loc1:N,loc2:v};if(N.ele&&v.ele&&(H.computed.ele=v.ele),N.time&&v.time&&N.time!==v.time){const{speed:Z,time:U}=G(y,N.time,v.time),Te=Z;H.computed.speed=Z,H.computed.time=U,H.computed.filteredSpeed=Te}N.temp&&v.temp&&(H.computed.temp=(N.temp+v.temp)/2),v.hr&&(H.computed.hr=v.hr),v.cad&&(H.computed.cad=v.cad),H.computed.speed&&z.push(H)}}return z}function V(p,z,M,P,B,R){const _=p*Math.PI/180,x=M*Math.PI/180,N=(M-p)*Math.PI/180,v=(P-z)*Math.PI/180,y=Math.sin(N/2)*Math.sin(N/2)+Math.cos(_)*Math.cos(x)*Math.sin(v/2)*Math.sin(v/2);let Z=6371e3*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)));if(B!==void 0&&R!==void 0){const U=R-B;U!==0&&(Z=Math.sqrt(Math.pow(Z,2)+Math.pow(U,2)))}return Z}function G(p,z,M){const P=M/1e3-z/1e3;return{speed:(p/P||0)*3.6,time:P}}};o.useEffect(()=>(L({date:null,time:null,speed:0}),$({ready:!1,Data:[],options:null}),f.current=null,T.current=null,C(),()=>{w.current&&w.current.remove(),a.current&&a.current.remove()}),[e]),o.useEffect(()=>{if(I(null),s!==null){if(!f.current)return;const h=f.current.details[s];if(!h)return;if(h.type==="move")setTimeout(async()=>{l.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none");var F={type:"Feature",geometry:h.route.geometry};if(h.route.geometry.coordinates.length===0){let p=h.route.locations.map(z=>z.coordinates);F.geometry={type:"LineString",coordinates:p}}if(!l.getImage("icon_arrow")&&!l.hasImage("icon_arrow")){var W='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',E=new Image;E.onload=function(){l.hasImage("icon_arrow")||l.addImage("icon_arrow",E)},E.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(W)}l.getSource("RouteHistory")?l.getSource("RouteHistory").setData(F):(l.addSource("RouteHistory",{type:"geojson",data:F}),l.addLayer({id:"RouteHistory",type:"line",source:"RouteHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":d.route.lineCorlor,"line-width":d.route.lineWidth,"line-opacity":d.route.lineOpacity}}),l.addLayer({id:"RouteHistory-arrow",type:"symbol",source:"RouteHistory",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}));var V=fe(F);l.fitBounds(V,{padding:100,maxZoom:17,duration:1e3});var G=await c([h]);setTimeout(()=>{$({ready:!0,Data:G,options:d})},200)},300);else if(h.type==="start"||h.type==="end"||h.type==="stop"||h.type==="checkin"){l.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),l.easeTo({center:h.coordinates,duration:100,zoom:17,bearing:0});var r;if(h.type==="start"||h.type==="end"){let F="default";h.type!="stop"&&(F=h.type),r=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${F}-color"></span>
                                <span>${h.address}</span>
                            </div>
                            ${h.type!=="stop"?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${F}-color"></span>
                                <span>${u(h.timestamp)}</span>
                            </div>`:`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                    </svg>
                                </span>
                                <span>${u(h.startTime)}</span>
                            </div>
                            ${h.endTime!==""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                        </svg>
                                    </span>
                                    <span>${u(h.endTime)}</span>
                                </div>`:""} `} `}(h.type==="stop"||h.type==="checkin")&&(r=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                <span>${h.address}</span>
                            </div>
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                </span>
                                <span>${u(h.startTime)}</span>
                            </div>
                            ${h.endTime!=""?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                </span>
                                <span>${u(h.endTime)}</span>
                            </div>`:""}`),w.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!0,anchor:"bottom",focusAfterOpen:!1}).setLngLat(h.coordinates).setHTML(r).setOffset([0,-20]).addTo(l)}}else T.current&&$({ready:!0,Data:T.current,options:d});return()=>{try{w.current&&w.current.remove(),l&&(l.setPaintProperty("ek-tracking-his-LineString","line-color",d.route.lineCorlor),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",d.route.lineOpacity),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),l.getSource("RouteHistory")&&(l.removeLayer("RouteHistory"),l.removeLayer("RouteHistory-arrow"),l.removeSource("RouteHistory")))}catch(b){console.log(b)}}},[s]);function u(r){if(r||r!=""){const b=new Date(r);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(b)}else return"Không có thông tin"}const g=r=>{if(r){const b=new Date(r.loc1.time);b.setHours(b.getHours());const h=b.getDate(),F=b.getMonth()+1,W=b.getFullYear(),E=b.getHours(),V=b.getMinutes(),G=`${h}/${F}/${W}`,p=`${E.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`;L({date:G,time:p,speed:Math.ceil(r.computed.speed*10)/10})}else L({date:null,time:null,speed:0})};return t.jsx(t.Fragment,{children:t.jsxs("div",{ref:n,id:"ekmap-tracking-his-map",children:[j.ready!==!1&&t.jsx(Yt,{map:l,segmentData:j.Data,options:j.options,Animation:O,currentInfo:g}),t.jsx(Wt,{}),S.date!==null&&S.time!==null&&t.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[t.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:S.date}),t.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:S.time})]}),t.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),t.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[S.speed," km/h"]})]})]})]})})}function Jt({employee:e}){const[i,s]=o.useState(ne()),[n,a]=o.useState(ne().startOf("day").toISOString()),[l,m]=o.useState(ne().endOf("day").toISOString()),[j,$]=o.useState(""),[S,L]=o.useState([]),[f,T]=o.useState(""),O=C=>{setTimeout(()=>{s(C),a(C.startOf("day").toISOString()),m(C.endOf("day").toISOString())},200)},[I,w]=o.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:l}),D=async C=>{let c=await re.get("/api/method/mbw_dms.api.user.get_list_employees");if(c.message=="Thành công"){let u=c.result.map(function(g){return{value:g.name,label:g.employee_name,object_id:g.object_id}});L(u);for(let g=0;g<u.length;g++)if(e!=null&&u[g].object_id==e){setTimeout(()=>{T(u[g].value)},500);break}}},d=async(C,c)=>{w(u=>({...u,objectId:c.object_id})),$(`${c.label} - ${C}`),T(C)};return o.useEffect(()=>{(async()=>{if(e==null||e==""){const C=await re.get("/api/method/mbw_dms.api.user.get_projectID");w(c=>({...c,projectId:C.result["Project ID"],objectId:""})),D(C.result["Project ID"]);return}try{const C=await re.get("/api/method/mbw_dms.api.user.get_projectID");w(u=>({...u,projectId:C.result["Project ID"],objectId:e})),D(C.result["Project ID"]);const c=await re.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${e}`);c.message=="Thành công"&&c.result.length>0&&($(c.result[0].employee_name),T(c.result[0].name))}catch(C){Oe.error(C?.message||"Something was wrong!!!")}})()},[e]),o.useEffect(()=>{(async()=>w(C=>({...C,from_time:n,to_time:l})))()},[n,l]),t.jsxs(t.Fragment,{children:[t.jsxs(ae,{className:"flex flex-wrap justify-between items-center px-0",children:[t.jsxs("div",{className:"flex justify-center items-center",children:[t.jsxs(Be,{to:"/employee-monitor",children:[" ",t.jsx(zt,{})]}),t.jsx("span",{className:"text-2xl font-semibold leading-[21px] mx-5",children:j})]}),t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(je,{value:f,style:{width:150},onChange:d,options:S})}),t.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(Ee,{defaultValue:ne(i),format:"DD-MM-YYYY",onChange:O})})]})]}),t.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:t.jsx("div",{id:"travel",className:"relative",children:I.projectId&&t.jsx(At,{options:I})})})]})}function Kt(){o.useState("list");const{employee_id:e}=Pe();return t.jsx(t.Fragment,{children:t.jsx(Jt,{employee:e})})}function ni(){return t.jsxs(t.Fragment,{children:[t.jsx(De,{children:t.jsx("title",{children:" EmployeeMonitor Detail"})}),t.jsx(Kt,{})]})}export{ni as default};
