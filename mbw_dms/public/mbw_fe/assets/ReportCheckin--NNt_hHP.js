import{Y as n,a3 as o,L as e,R as O,O as d,a5 as m,a6 as M,bv as H,a8 as V}from"./index-pVymrpwA.js";import{H as A}from"./header-page-58W9c4sj.js";import{u as h}from"./useDebount-AN0aWWHJ.js";import{e as P}from"./data-u-VkVTNg.js";import{t as q}from"./index-DkZZcBjD.js";import{D as N}from"./index-67doyZ_O.js";import{T as B}from"./index-Pu5LPd4W.js";import{V as X}from"./VerticalAlignBottomOutlined-reyJfqy6.js";const z=[{title:"STT",dataIndex:"stt",key:"stt",render:(l,t,x)=>x+1},{title:"Mã nhân viên",dataIndex:"employee_code",key:"employee_code",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.employee_code})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.employee_name})},{title:"Nhóm bán hàng",dataIndex:"saleperson",key:"saleperson",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.saleperson})},{title:"Ngày",dataIndex:"days",key:"days",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.days})},{title:"Thứ",dataIndex:"date",key:"date",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.date})},{title:"Giờ làm",dataIndex:"startwork",key:"startwork",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.startwork})},{title:"Giờ viếng thăm",dataIndex:"checkin",key:"checkin",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.checkin})},{title:"Số km tự động (km)",dataIndex:"kmauto",key:"kmauto",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmauto})},{title:"Số km di chuyển (km)",dataIndex:"kmmove",key:"kmmove",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmmove})},{title:"Vận tốc (km/h)",dataIndex:"speed",key:"kmmove",render:(l,t)=>e.jsx("div",{className:"!w-[160px]",children:t.kmmove})},{title:"Ghi chú",key:"note",render:()=>e.jsx("div",{className:"!w-[160px]",children:e.jsx("a",{children:"Xem ghi chú"})})}];function W(){const[l,t]=n.useState([]),[x,b]=n.useState([]),[p,S]=n.useState(),[f,C]=n.useState(""),[J,u]=n.useState();let y=h(f);const[F,Q]=n.useState(""),[U,k]=n.useState(""),[T,I]=n.useState([]),[Z,j]=n.useState(""),[E,G]=n.useState("");let v=h(E,500);const[$,g]=n.useState(""),[D,Y]=n.useState([]),[K,L]=n.useState("");let w=h(K,500);h(F,300);const _=s=>{console.log(s)};n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/mbw_dms.api.router.get_team_sale");b(q({data:s.result.map(c=>({title:c.name,value:c.name,...c})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:p,key_search:y}}),{message:c}=s;t(c.map(r=>({value:r.employee_code,label:r.employee_name||r.employee_code})))})()},[p,y]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:c}=s;I(c.map(r=>({value:r.value.trim(),label:r.value.trim()})))})()},[v]),n.useEffect(()=>{(async()=>{let s=await o.get("/api/method/frappe.desk.search.search_link",{params:{txt:w,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:c}=s;Y(c.map(r=>({value:r.value,label:r.value})))})()},[w]);const R=s=>{const c=[{title:"Khách hàng",dataIndex:"customer",key:"customer",render:(r,a,i)=>e.jsxs("div",{className:"!w-[200]",children:[e.jsx("div",{children:a.customer}),e.jsx("div",{className:"text-[#637381]",children:a.customer_code})]})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.address})})},{title:"Loại khách",dataIndex:"typecustomer",key:"typecustomer",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.typecustomer})})},{title:"Nhóm khách",dataIndex:"groupcustomer",key:"groupcustomer",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.groupcustomer})})},{title:"Số điện thoại",dataIndex:"phonenumber",key:"phonenumber",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.phonenumber})})},{title:"Liên hệ",dataIndex:"contact",key:"contact",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.contact})})},{title:"Checkin",dataIndex:"checkin",key:"checkin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkin})})},{title:"Checkout",dataIndex:"checkout",key:"checkout",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkout})})},{title:"Số giờ viếng thăm",dataIndex:"timecheckin",key:"timecheckin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.timecheckin})})},{title:"Địa chỉ checkin",dataIndex:"addresscheckin",key:"addresscheckin",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.addresscheckin})})},{title:"Khoảng cách checkin(km)",dataIndex:"distance",key:"distance",render:(r,a,i)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.distance})})}];return e.jsx(H,{columns:c,pagination:!1})};return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"Báo cáo viếng thăm",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(X,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-md py-7  border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsx("div",{className:"flex flex-wrap justify-start px-4 items-center",children:e.jsxs(O,{gutter:[8,8],children:[e.jsx(d,{label:"Từ ngày",className:"border-none mr-2 w-[175px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Từ ngày",onChange:_})}),e.jsx(d,{label:"Đến ngày",className:"border-none mr-2 w-[175px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",placeholder:"Đến ngày",onChange:_})}),e.jsx(d,{label:"Nhóm bán hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(B,{placeholder:"Tất cả nhóm bán hàng",allowClear:!0,treeData:x,onChange:s=>{S(s)},dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:400}})}),e.jsx(d,{label:"Nhân viên",className:"border-none mr-2 w-[175px]",name:"employee",children:e.jsx(m,{filterOption:!1,notFoundContent:null,allowClear:!0,placeholder:"Tất cả nhân viên",onSearch:s=>{C(s)},options:l,onSelect:s=>{u(s)},onClear:()=>{u("")}})}),e.jsx(d,{label:"Loại khách hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{options:P,placeholder:"Tất cả loại khách hàng",filterOption:!1,allowClear:!0,onSelect:s=>{k(s)},onClear:()=>k("")})}),e.jsx(d,{label:"Nhóm khác hàng",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:T,onSelect:s=>{j(s)},onSearch:s=>{G(s)},onClear:()=>j(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả nhóm khách hàng"})}),e.jsx(d,{label:"Khu vực",className:"border-none mr-2 w-[175px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:D,onSelect:s=>{g(s)},onSearch:s=>{L(s)},onClear:()=>g(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả khu vực"})})]})}),e.jsx("div",{className:"pt-10",children:e.jsx(M,{bordered:!0,scroll:{x:!0},columns:z,expandable:{expandedRowRender:R,defaultExpandedRowKeys:["0"]}})})]})]})}function ie(){return e.jsxs(e.Fragment,{children:[e.jsx(V,{children:e.jsx("title",{children:" ReportCheckin"})}),e.jsx(W,{})]})}export{ie as default};
