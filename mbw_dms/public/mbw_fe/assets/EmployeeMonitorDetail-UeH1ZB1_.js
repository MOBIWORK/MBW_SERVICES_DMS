import{at as we,au as Ce,aw as Le,h as W,Y as c,ay as xe,aj as ee,ag as Te,aD as ye,br as $e,bf as Me,a9 as oe,aa as ce,L as e,bx as Ne,R as le,P as X,az as Q,Q as ne,a5 as ve,bC as ze,aM as K,a3 as re,aR as Ie,bD as Fe,V as Be,aZ as He,a8 as De}from"./index-Vpi8H1fU.js";import{D as Pe}from"./date-picker-tNkFywfx.js";import{b as se,T as ge}from"./index-ZSgN7XFX.js";import{H as _e}from"./header-page-ssRXK-5U.js";import{W as J,c as Re,d as Z,r as Oe,l as Ee,p as U,f as de,s as Ae,g as he,e as We,b as me}from"./WrapperCard-3CaC5Zoi.js";import{F as pe}from"./index-s3C-vHm5.js";import"./index-VLKLxfmb.js";const Ve=t=>{const{componentCls:i,calc:s}=t;return{[i]:Object.assign(Object.assign({},Le(t)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:t.itemPaddingBottom,fontSize:t.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:t.itemHeadSize,insetInlineStart:s(s(t.itemHeadSize).sub(t.tailWidth)).div(2).equal(),height:`calc(100% - ${W(t.itemHeadSize)})`,borderInlineStart:`${W(t.tailWidth)} ${t.lineType} ${t.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:t.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:t.itemHeadSize,height:t.itemHeadSize,backgroundColor:t.dotBg,border:`${W(t.dotBorderWidth)} ${t.lineType} transparent`,borderRadius:"50%","&-blue":{color:t.colorPrimary,borderColor:t.colorPrimary},"&-red":{color:t.colorError,borderColor:t.colorError},"&-green":{color:t.colorSuccess,borderColor:t.colorSuccess},"&-gray":{color:t.colorTextDisabled,borderColor:t.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:s(t.itemHeadSize).div(2).equal(),insetInlineStart:s(t.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:t.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:s(s(t.fontSize).mul(t.lineHeight).sub(t.fontSize)).mul(-1).add(t.lineWidth).equal(),marginInlineStart:s(t.margin).add(t.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:s(t.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:s(t.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:s(t.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${W(t.marginXXS)})`,width:`calc(50% - ${W(t.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${W(t.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${W(s(s(t.itemHeadSize).add(t.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${W(s(t.itemHeadSize).add(t.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${W(t.margin)})`,borderInlineStart:`${W(t.tailWidth)} dotted ${t.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:t.margin,display:"block",height:`calc(100% - ${W(t.margin)})`,borderInlineStart:`${W(t.tailWidth)} dotted ${t.tailColor}`},[`${i}-item-content`]:{minHeight:s(t.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:s(s(t.fontSize).mul(t.lineHeight).sub(t.fontSize)).mul(-1).add(t.tailWidth).equal(),width:`calc(50% - ${W(t.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${W(t.marginSM)})`,width:`calc(50% - ${W(t.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},qe=t=>({tailColor:t.colorSplit,tailWidth:t.lineWidthBold,dotBorderWidth:t.wireframe?t.lineWidthBold:t.lineWidth*3,dotBg:t.colorBgContainer,itemPaddingBottom:t.padding*1.25}),Ze=we("Timeline",t=>{const i=Ce(t,{itemHeadSize:10,customHeadPaddingVertical:t.paddingXXS,paddingInlineEnd:2});return[Ve(i)]},qe);var Ye=function(t,i){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(s[n[o]]=t[n[o]]);return s};const Ge=t=>{var{prefixCls:i,className:s,color:n="blue",dot:o,pending:l=!1,position:h,label:k,children:S}=t,y=Ye(t,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:C}=c.useContext(xe),v=C("timeline",i),R=ee(`${v}-item`,{[`${v}-item-pending`]:l},s),M=/blue|red|green|gray/.test(n||"")?void 0:n,P=ee(`${v}-item-head`,{[`${v}-item-head-custom`]:!!o,[`${v}-item-head-${n}`]:!M});return c.createElement("li",Object.assign({},y,{className:R}),k&&c.createElement("div",{className:`${v}-item-label`},k),c.createElement("div",{className:`${v}-item-tail`}),c.createElement("div",{className:P,style:{borderColor:M,color:M}},o),c.createElement("div",{className:`${v}-item-content`},S))},ke=Ge;var fe=function(t,i){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(s[n[o]]=t[n[o]]);return s};const Xe=t=>{var{prefixCls:i,className:s,pending:n=!1,children:o,items:l,rootClassName:h,reverse:k=!1,direction:S,hashId:y,pendingDot:C,mode:v=""}=t,R=fe(t,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const M=(m,q)=>v==="alternate"?m==="right"?`${i}-item-right`:m==="left"?`${i}-item-left`:q%2===0?`${i}-item-left`:`${i}-item-right`:v==="left"?`${i}-item-left`:v==="right"?`${i}-item-right`:m==="right"?`${i}-item-right`:"",P=Te(l||[]),F=typeof n=="boolean"?null:n;n&&P.push({pending:!!n,dot:C||c.createElement(ye,null),children:F}),k&&P.reverse();const d=P.length,N=`${i}-item-last`,a=P.filter(m=>!!m).map((m,q)=>{var r;const B=q===d-2?N:"",u=q===d-1?N:"",{className:H}=m,V=fe(m,["className"]);return c.createElement(ke,Object.assign({},V,{className:ee([H,!k&&n?B:u,M((r=m?.position)!==null&&r!==void 0?r:"",q)]),key:m?.key||q}))}),L=P.some(m=>!!m?.label),$=ee(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!k,[`${i}-${v}`]:!!v&&!L,[`${i}-label`]:L,[`${i}-rtl`]:S==="rtl"},s,h,y);return c.createElement("ul",Object.assign({},R,{className:$}),a)},Ke=Xe;function Ue(t,i){return t&&Array.isArray(t)?t:$e(i).map(s=>{var n,o;return Object.assign({children:(o=(n=s?.props)===null||n===void 0?void 0:n.children)!==null&&o!==void 0?o:""},s.props)})}var Qe=function(t,i){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(s[n[o]]=t[n[o]]);return s};const je=t=>{const{getPrefixCls:i,direction:s,timeline:n}=c.useContext(xe),{prefixCls:o,children:l,items:h,className:k,style:S}=t,y=Qe(t,["prefixCls","children","items","className","style"]),C=i("timeline",o),v=Me(C),[R,M,P]=Ze(C,v),F=Ue(h,l);return R(c.createElement(Ke,Object.assign({},y,{className:ee(n?.className,k,P,v),style:Object.assign(Object.assign({},n?.style),S),prefixCls:C,direction:s,items:F,hashId:M})))};je.Item=ke;const Je=je;var et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const tt=et;var it=function(i,s){return c.createElement(oe,ce({},i,{ref:s,icon:tt}))};const nt=c.forwardRef(it);var rt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const st=rt;var at=function(i,s){return c.createElement(oe,ce({},i,{ref:s,icon:st}))};const ot=c.forwardRef(at);var ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const lt=ct;var dt=function(i,s){return c.createElement(oe,ce({},i,{ref:s,icon:lt}))};const pt=c.forwardRef(dt);var ut={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const gt=ut;var ht=function(i,s){return c.createElement(oe,ce({},i,{ref:s,icon:gt}))};const mt=c.forwardRef(ht),ft=({size:t=16})=>e.jsx("svg",{width:t,height:t+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function xt(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function yt({data:t,onEventClickItem:i}){const s=()=>{i(t.index_item)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:s,children:e.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.time_start})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.address})]})]})}function vt(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function kt({data:t,onEventClickItem:i}){const s=()=>{i(t.index_item)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:s,children:e.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.time_end})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.address})]})]})}function jt(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function bt({data:t,onEventClickItem:i}){const s=()=>{i(t.index_item)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:s,children:[e.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),e.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),e.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.total_time})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.time_checking})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.retail_name})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.address})]})]})}function St(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function wt({data:t,onEventClickItem:i}){const s=()=>{i(t.index_item)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:s,children:[e.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),e.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),e.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.total_time})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.time_moving})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),e.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[t.total_distance," Trip"]})]})]})}function Ct(){return e.jsx(e.Fragment,{children:e.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function Lt({data:t,onEventClickItem:i}){const s=()=>{i(t.index_item)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:s,children:[e.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),e.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),e.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.total_time})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.time_stop})]}),e.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[e.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:e.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),e.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:t.address})]})]})}function Tt({options:t}){const[i,s]=c.useState([]),[n,o]=c.useState({summary:null,details:[]}),[l,h]=c.useState(!0),[k,S]=c.useState(null);c.useEffect(()=>{h(!0),S(null)},[t]);const y=d=>{S(d)};c.useEffect(()=>{let d=[];if(n.details!=null)for(let N=0;N<n.details.length;N++){let a=n.details[N];a.type=="start"?d.push({dot:e.jsx(xt,{}),children:e.jsx(yt,{data:{time_start:F(a.timestamp),address:a.address,index_item:N},onEventClickItem:y})}):a.type=="checkin"?d.push({dot:e.jsx(jt,{}),children:e.jsx(bt,{data:{time_checking:`${F(a.startTime)} - ${F(a.endTime)}`,retail_name:a.storeName,address:a.address,total_time:`${v(a.startTime,a.endTime)}`,index_item:N},onEventClickItem:y})}):a.type=="move"?d.push({dot:e.jsx(St,{}),children:e.jsx(wt,{data:{time_moving:`${F(a.startTime)} - ${F(a.endTime)}`,total_distance:`${R(a.distance)}`,total_time:`${v(a.startTime,a.endTime)}`,index_item:N},onEventClickItem:y})}):a.type=="stop"?d.push({dot:e.jsx(Ct,{}),children:e.jsx(Lt,{data:{time_stop:`${F(a.startTime)} - ${F(a.endTime)}`,address:a.address,total_time:`${v(a.startTime,a.endTime)}`,index_item:N},onEventClickItem:y})}):a.type=="end"&&d.push({dot:e.jsx(vt,{}),children:e.jsx(kt,{data:{time_end:`${F(a.timestamp)}`,address:a.address,index_item:N},onEventClickItem:y})})}s(d)},[n]);const C=d=>{d!=null?o(d):o({summary:null,details:[]}),h(!1)},v=(d,N)=>{const a=new Date(d),$=new Date(N)-a;if($<6e4)return`${Math.round($/1e3)} giây`;if($>=6e4&&$<6e4*60)return`${Math.round($/6e4)} phút`;{const m=Math.floor($/36e5),q=Math.floor($%(1e3*60*60)/(1e3*60));return`${m} giờ ${q} phút`}},R=d=>d<1e3?`${Math.round(d)} m`:`${Math.round(d/1e3)} km`,M=d=>d<60?`${Math.round(d)} giây`:d>=60&&d<3600?`${Math.round(d/60)} phút`:`${Math.round(d/3600)} giờ`,P=d=>Math.round(d*3.6),F=d=>{var N=new Date(d);return N.setUTCHours(N.getUTCHours()+7),`${N.getUTCHours()}:${N.getUTCMinutes()}`};return e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Ne,{indicator:e.jsx(ye,{style:{fontSize:30,color:"#fff"},spin:!0})})}),e.jsxs(le,{gutter:20,children:[e.jsx(X,{span:4,className:"card-container",children:e.jsx(J,{children:e.jsx("div",{className:"wrap-card-container",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:e.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),e.jsxs("div",{style:{marginLeft:"10px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),n.summary!=null?e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&R(n.summary.move.distance)}):e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),e.jsx(X,{span:4,className:"card-container",children:e.jsx(J,{children:e.jsx("div",{className:"wrap-card-container",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:e.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),e.jsxs("div",{style:{marginLeft:"10px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),n.summary!=null?e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.move.totalTime)}):e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),e.jsx(X,{span:4,className:"card-container",children:e.jsx(J,{children:e.jsx("div",{className:"wrap-card-container",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:e.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),e.jsxs("div",{style:{marginLeft:"10px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),n.summary!=null?e.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[n.summary&&P(n.summary.move.avgSpeed)," km/h"]}):e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),e.jsx(X,{span:6,className:"card-container",children:e.jsx(J,{children:e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:e.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),e.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[e.jsxs("div",{style:{marginRight:"40px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.stop.count?n.summary.stop.count:0})]}),e.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),e.jsxs("div",{style:{marginLeft:"25px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.stop.totalTime)?M(n.summary.stop.totalTime):e.jsx("span",{children:"0 giây"})})]})]})]})})}),e.jsx(X,{span:6,className:"card-container",children:e.jsx(J,{children:e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:e.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),e.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[e.jsxs("div",{style:{marginRight:"13px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.checkin.count?n.summary.checkin.count:0})]}),e.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),e.jsxs("div",{style:{marginLeft:"25px"},children:[e.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),e.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.checkin.totalTime)?M(n.summary.checkin.totalTime):e.jsx("span",{children:"0 giây"})})]})]})]})})})]}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(le,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:e.jsx(Re,{children:e.jsxs(le,{children:[e.jsxs(X,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[e.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),e.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?e.jsx(Je,{mode:"left",items:i}):e.jsx("div",{children:"Chưa có lộ trình"})})]}),e.jsx(X,{span:18,style:{height:"615px"},children:e.jsx(Ht,{options:t,onLoad:C,HistoryIndex:k})})]})})})})]})}function $t(){const[t,i]=c.useState(!1),s=()=>{i(!t)},n={iconStart:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",iconEnd:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",iconCheckin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",iconStop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"};return e.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[e.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:s,children:[e.jsx("span",{className:`icon ${t?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),e.jsx("span",{children:"Chú giải bản đồ"})]}),e.jsx("div",{className:`ekmapplf_tracking-legend-body ${t?"open":""}`,style:{maxHeight:t?"none":"0"},children:e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStart})`}}),"Vị trí bắt đầu"]}),e.jsxs("li",{children:[e.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconEnd})`}}),"Vị trí kết thúc"]}),e.jsxs("li",{children:[e.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconCheckin})`}}),"Vị trí khách hàng"]}),e.jsxs("li",{children:[e.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStop})`}}),"Vị trí điểm dừng"]})]})})]})}function te(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Mt(t){return t.type==="Feature"?t.geometry:t}function be(t,i,s){s===void 0&&(s={});var n=te(t),o=te(i),l=Z(o[1]-n[1]),h=Z(o[0]-n[0]),k=Z(n[1]),S=Z(o[1]),y=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(k)*Math.cos(S);return Oe(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),s.units)}function Nt(t,i,s,n){n===void 0&&(n={});var o=te(t),l=Z(o[0]),h=Z(o[1]),k=Z(s),S=Ee(i,n.units),y=Math.asin(Math.sin(h)*Math.cos(S)+Math.cos(h)*Math.sin(S)*Math.cos(k)),C=l+Math.atan2(Math.sin(k)*Math.sin(S)*Math.cos(h),Math.cos(S)-Math.sin(h)*Math.sin(y)),v=de(C),R=de(y);return U([v,R],n.properties)}function ue(t,i,s){if(s===void 0&&(s={}),s.final===!0)return zt(t,i);var n=te(t),o=te(i),l=Z(n[0]),h=Z(o[0]),k=Z(n[1]),S=Z(o[1]),y=Math.sin(h-l)*Math.cos(S),C=Math.cos(k)*Math.sin(S)-Math.sin(k)*Math.cos(S)*Math.cos(h-l);return de(Math.atan2(y,C))}function zt(t,i){var s=ue(i,t);return s=(s+180)%360,s}function It(t,i,s){s===void 0&&(s={});for(var n=Mt(t),o=n.coordinates,l=0,h=0;h<o.length&&!(i>=l&&h===o.length-1);h++)if(l>=i){var k=i-l;if(k){var S=ue(o[h],o[h-1])-180,y=Nt(o[h],k,S,s);return y}else return U(o[h])}else l+=be(o[h],o[h+1],s);return U(o[o.length-1])}function Ft(t,i){return i===void 0&&(i={}),Ae(t,function(s,n){var o=n.geometry.coordinates;return s+be(o[0],o[1],i)},0)}const Bt=({map:t,segmentData:i,options:s,currentInfo:n,Animation:o})=>{const l=c.useRef(null),h=c.useRef(null),[k,S]=c.useState(s.animation.follow),[y,C]=c.useState(!1),[v,R]=c.useState(10),[M,P]=c.useState(!0),F=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[d,N]=c.useState(!0),a=c.useRef(0),L=c.useRef(0),$=c.useRef([]);function m(T,f){L.current=T;const w=f[T];if(!w){if(M){L.current=0,$.current=[];try{t&&t.getSource("LocationHistory")&&t.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(O){C(!1),console.log(O)}i.length&&i[0].computed.time&&(h.current=setTimeout(m.bind(this),1e3,L.current,i))}else L.current=T-1,E();n(f[L.current]);return}if(n(w),w.computed.time){let O=w.computed.time*1e3/v;if(w.computed.speed){let A=function(x){D||(_=w.loc1.loc,D=x);const z=(x-D)/(Number(w.computed.time?.toString())*1e3/v);if(!(z>1||!y)){var g=he([w.loc1.loc,w.loc2.loc]),j=Ft(g),p=It(g,j*z).geometry.coordinates,b=ue(U(_),U(p));_[0]!==p[0]&&_[1]!==p[1]&&(a.current=b),_=p,$.current=$.current.concat([p]);try{t&&k&&t.panTo(p,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:a.current}),t&&t.getSource("locationMarker")&&t.getSource("locationMarker").setData({type:"FeatureCollection",features:[U(p,{bearing:a.current})]}),t&&$.current.length>1&&t.getSource("LocationHistory")&&t.getSource("LocationHistory").setData({type:"FeatureCollection",features:[he($.current)]}),l.current=window.requestAnimationFrame(A)}catch(I){C(!1),console.log(I)}}};var D,_;l.current=window.requestAnimationFrame(A)}T++,$.current=f.slice(0,T).map(A=>A.loc1.loc),h.current=setTimeout(m.bind(this),O,T,f)}}c.useEffect(()=>{E(),l.current&&cancelAnimationFrame(l.current),h.current&&clearTimeout(h.current),L.current=0,i.length&&s.animation.animate&&C(!0)},[i,s]),c.useEffect(()=>{o?H():E()},[o]),c.useEffect(()=>{if(y){L.current===0&&($.current=[],t.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&t.panTo(i[0].loc1.loc)),i.length&&i[0].computed.time&&(h.current=setTimeout(m.bind(void 0),500,L.current,i));try{t.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),t.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),t.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),t.setLayoutProperty("ek-tracking-his-LineString","visibility","none"),t.setLayoutProperty("locationMarker","visibility","visible"),t.setLayoutProperty("LocationHistory","visibility","visible"),t.getSource("RouteHistory")&&(t.removeLayer("RouteHistory"),t.removeLayer("RouteHistory-arrow"),t.removeSource("RouteHistory"))}catch(T){console.log(T)}}else{n(null),l.current&&cancelAnimationFrame(l.current);try{t.setPaintProperty("ek-tracking-his-LineString","line-color",s.route.lineCorlor),t.setPaintProperty("ek-tracking-his-LineString","line-opacity",s.route.lineOpacity),t.setLayoutProperty("ek-tracking-his-LineString","visibility","visible"),t.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),t.setLayoutProperty("locationMarker","visibility","none"),t.setLayoutProperty("LocationHistory","visibility","none")}catch(T){console.log(T)}}return()=>{l.current&&cancelAnimationFrame(l.current),h.current&&clearTimeout(h.current)}},[y,v,k,M]);const[q,r]=c.useState(s.animation.animate);c.useEffect(()=>{const T=()=>{N(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",T),()=>{document.removeEventListener("visibilitychange",T)}},[]),c.useEffect(()=>{d?q===s.animation.animate?C(!0):C(!1):(r(y),C(!1))},[d]);const B=T=>{R(T)},u=T=>{T.target.checked&&t.setZoom(17),S(!k)},H=()=>{C(!0)},V=()=>{C(!1)},E=()=>{V();try{t&&(t.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),t.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&t.panTo(i[0].loc1.loc))}catch(T){console.log(T)}L.current=0},Y=()=>{P(!M)};return e.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:e.jsxs(pe,{gap:"small",align:"center",justify:"center",children:[e.jsx(Q,{title:"Play",children:e.jsx(ne,{icon:e.jsx(ot,{}),disabled:y,onClick:H})}),e.jsx(Q,{title:"Pause",children:e.jsx(ne,{icon:e.jsx(pt,{}),disabled:!y,onClick:V})}),e.jsx(Q,{title:"Stop",children:e.jsx(ne,{icon:e.jsx(nt,{}),onClick:E})}),e.jsx(Q,{title:"Replay",children:e.jsx(ne,{type:M?"primary":"default",icon:e.jsx(mt,{}),onClick:Y})}),e.jsx(Q,{title:"Speed",children:e.jsx(ve,{defaultValue:v,style:{width:"75px"},onChange:B,options:F})}),e.jsx(ze,{onChange:u,checked:k,children:"Theo dõi lộ trình"})]})})},ae=window.ekmapplf;function Ht({options:t,onLoad:i,HistoryIndex:s}){const n=c.useRef(null),o=c.useState(null),[l,h]=c.useState(null),[k,S]=c.useState({ready:!1,Data:[],options:null}),[y,C]=c.useState({date:null,time:null,speed:0}),v=c.useRef(null),R=c.useRef(null),M=c.useRef(null),[P,F]=c.useState(!1),d=c.useRef(null),a=We({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{track:"https://files.ekgis.vn/sdks/tracking/assets/custom_marker.png",navigation:"https://files.ekgis.vn/sdks/tracking/assets/arrow.png",checkin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",start:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",end:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",stop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"},route:{visible:!0,lineCorlor:"#01579B",lineWidth:4,lineOpacity:.8},animation:{follow:!0,animate:!0}},t),L=()=>{try{let E=function(){var x={type:"FeatureCollection",features:[]};r.getSource("LocationHistory")?r.getSource("LocationHistory").setData(x):(r.addSource("LocationHistory",{type:"geojson",data:x}),r.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity},filter:["==","$type","LineString"]}))};o.current&&(o.animation_current&&cancelAnimationFrame(o.animation_current),o.timeout_current&&clearTimeout(o.timeout_current),o.current.remove()),o.current=new K.Map({container:n.current,center:a.center,zoom:a.zoom,minZoom:1});var r=o.current;h(r);const Y=r.getContainer();r.setPadding({top:100,bottom:100,left:100,right:100}),new ae.VectorBaseMap("OSM:Bright",a.apiKey).addTo(r);var B=new ae.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+Y.id,baseLayers:[{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});r.addControl(B,"bottom-left"),B.on("changeBaseLayer",async function(x){await new ae.VectorBaseMap(x.layer,a.apiKey).addTo(r),setTimeout(()=>{f(a.from_time,a.to_time,a.pageNumber,a.pageSize)},500)}),r.addControl(new K.NavigationControl({visualizePitch:!0}),"bottom-right");var u=!1;r.getPitch()>0?u=!0:u=!1;var H="maplibregl-terrain2d-control",V="Hiển thị 2D";u||(H="maplibregl-terrain3d-control",V="Bản đồ 3D");let T=new ae.control.Button({className:"btn-ctl-group "+H,icon:"none",tooltip:V});T.on("click",x=>{u=!u,u?(x._div.className=x._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),x._div.title="Hiển thị 2D"):(x._div.className=x._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),x._div.title="Hiển thị 3D"),u?(r.easeTo({pitch:60}),r.setLayoutProperty("building-3d","visibility","visible")):(r.easeTo({pitch:0}),r.setLayoutProperty("building-3d","visibility","none"))}),r.addControl(T,"bottom-right"),r.addControl(new K.FullscreenControl,"top-right"),r.on("load",()=>{try{if(!a.objectId||a.objectId===""||a.objectId==="null"||!a.from_time||a.from_time===""||a.from_time==="null"||!a.to_time||a.to_time===""||a.to_time==="null"){i(null);return}f(a.from_time,a.to_time,a.pageNumber,a.pageSize)}catch(x){console.error("Error:",x)}});const f=async(x,z,g,j)=>{let p=await w(x,z,g,j);await D(p);let b=await $(p);p.length&&p[0].coordinates&&r.easeTo({center:p[0].coordinates,duration:100,zoom:16}),setTimeout(()=>S({ready:!0,Data:b,options:a}),500)},w=async(x,z,g,j)=>{let p=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${a.projectId}/${a.objectId}?api_key=${a.apiKey}&from_time=${x}&to_time=${z}`;const I=await(await fetch(p)).json();M.current=I,i(M.current);var G=I.details;return G||[]},D=async x=>{let z={type:"FeatureCollection",features:[]},g={type:"FeatureCollection",features:[]},j={type:"FeatureCollection",features:[]};if(x.forEach(b=>{const I={type:"Feature",properties:b.type!=="move"?b:{},geometry:b.type==="move"?b.route.geometry:{type:"Point",coordinates:b.coordinates}};z.features.push(I),b.type!=="move"&&(b.type==="checkin"?g.features.push(I):j.features.push(I))}),x.length){var p=me(z);r.fitBounds(p,{padding:100,maxZoom:14,duration:1e3})}await _(z),await O(g,j),await E(),await A()},_=x=>{try{if(!r.getImage("icon_arrow")){var z='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',g=new Image;g.onload=function(){r.hasImage("icon_arrow")||r.addImage("icon_arrow",g)},g.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(z)}r.getSource("ek-tracking-his-line-source")?r.getSource("ek-tracking-his-line-source").setData(x):(r.addSource("ek-tracking-his-line-source",{type:"geojson",data:x}),r.addLayer({id:"ek-tracking-his-LineString",type:"line",source:"ek-tracking-his-line-source",layout:{"line-join":"round","line-cap":"round",visibility:a.route.visible?"visible":"none"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity},filter:["==","$type","LineString"]}),r.addLayer({id:"ek-tracking-his-LineString-arrow",type:"symbol",source:"ek-tracking-his-line-source",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}))}catch(j){console.error("Error setLine:",j)}},O=async(x,z)=>{try{if(!r.getImage("marker-start")){const g=await r.loadImage(a.icon.start);r.addImage("marker-start",g.data)}if(!r.getImage("marker-end")){const g=await r.loadImage(a.icon.end);r.addImage("marker-end",g.data)}if(!r.getImage("marker-check")){const g=await r.loadImage(a.icon.checkin);r.addImage("marker-check",g.data)}if(!r.getImage("marker-stop")){const g=await r.loadImage(a.icon.stop);r.addImage("marker-stop",g.data)}r.getSource("ek-tracking-his-track-source")?r.getSource("ek-tracking-his-track-source").setData(z):(r.addSource("ek-tracking-his-track-source",{type:"geojson",data:z}),r.addLayer({id:"ek-tracking-his-track-point",type:"symbol",source:"ek-tracking-his-track-source",layout:{"icon-image":["match",["get","type"],"start","marker-start","end","marker-end","marker-stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),r.on("mouseenter","ek-tracking-his-track-point",g=>{r.getCanvas().style.cursor="pointer";const j=[[g.point.x-5,g.point.y-5],[g.point.x+5,g.point.y+5]];let b=r.queryRenderedFeatures(j,{layers:["ek-tracking-his-track-point"]})[0],I="default";b.properties.type!="stop"&&(I=b.properties.type),d.current&&d.current.remove(),d.current=new K.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(b.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${I}-color"></span>
                                            <span>${b.properties.address}</span>
                                        </div>
                                        ${b.properties.type!=="stop"?`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${I}-color"></span>
                                            <span>${m(b.properties.timestamp)}</span>
                                        </div>`:`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                </svg>
                                            </span>
                                            <span>${m(b.properties.startTime)}</span>
                                        </div>
                                        ${b.properties.endTime!==""?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                    </svg>
                                                </span>
                                                <span>${m(b.properties.endTime)}</span>
                                            </div>`:""} `}
                                    `).setOffset([0,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-track-point",()=>{r.getCanvas().style.cursor="",d.current&&d.current.remove()})),r.getSource("ek-tracking-his-check-source")?r.getSource("ek-tracking-his-check-source").setData(x):(r.addSource("ek-tracking-his-check-source",{type:"geojson",data:x,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),r.addLayer({id:"ek-tracking-his-check-clusters",type:"circle",source:"ek-tracking-his-check-source",paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-cluster-count",type:"symbol",source:"ek-tracking-his-check-source",layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),r.addLayer({id:"ek-tracking-his-check-point",type:"symbol",source:"ek-tracking-his-check-source",layout:{"icon-image":"marker-check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),r.on("mouseenter","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor="pointer"}),r.on("mouseleave","ek-tracking-his-check-clusters",()=>{r.getCanvas().style.cursor=""}),r.on("click","ek-tracking-his-check-clusters",async g=>{const j=r.queryRenderedFeatures(g.point,{layers:["ek-tracking-his-check-clusters"]}),p=j[0].properties.cluster_id,b=await r.getSource("ek-tracking-his-check-source").getClusterExpansionZoom(p);r.easeTo({center:j[0].geometry.coordinates,zoom:b})}),r.on("mouseenter","ek-tracking-his-check-point",g=>{r.getCanvas().style.cursor="pointer";const j=[[g.point.x-5,g.point.y-5],[g.point.x+5,g.point.y+5]],p=r.queryRenderedFeatures(j,{layers:["ek-tracking-his-check-point"]});d.current&&d.current.remove(),d.current=new K.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(p[0].geometry.coordinates).setHTML(`<div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${p[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${m(p[0].properties.startTime)}</span>
                                </div>
                                ${p[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${m(p[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(r)}),r.on("mouseleave","ek-tracking-his-check-point",()=>{r.getCanvas().style.cursor="",d.current&&d.current.remove()}))}catch(g){console.error("Error setPoints:",g)}};async function A(){if(!r.getImage("marker-navigation")){const z=await r.loadImage(a.icon.navigation);r.addImage("marker-navigation",z.data)}var x={type:"FeatureCollection",features:[]};r.getSource("locationMarker")?r.getSource("locationMarker").setData(x):(r.addSource("locationMarker",{type:"geojson",data:x}),r.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker-navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}}catch(E){console.error("Error initializing map:",E)}},$=async r=>{var B,u,H={type:"FeatureCollection",features:[]};return r.forEach(f=>{if(f.type==="move")for(let w=0;w<f.route.locations.length;w++){let D=f.route.locations[w];if(new Date(D.timestamp).getTime()>=new Date(f.startTime).getTime()&&new Date(D.timestamp).getTime()<=new Date(f.endTime).getTime()){let _={type:"Feature",properties:{time:D.timestamp,ele:0,type:f.type},geometry:{type:"Point",coordinates:D.coordinates}};H.features.push(_)}}else if(f.type==="stop"||f.type==="checkin"){let w={type:"Feature",properties:{time:f.startTime,ele:0,type:f.type},geometry:{type:"Point",coordinates:f.coordinates}},D={type:"Feature",properties:{time:f.endTime,ele:0,type:f.type},geometry:{type:"Point",coordinates:f.coordinates}};H.features.push(w,D)}else{let w={type:"Feature",properties:{time:f.timestamp,ele:0,type:f.type},geometry:{type:"Point",coordinates:f.coordinates}};H.features.push(w)}}),B=V(H),u=E(B),u||[];function V(f){var w={segments:[],id:t.objectId};let D=[];w.segments.push(D);for(let O=0;O<f.features.length;O++){var _=f.features[O];let A={loc:_.geometry.coordinates,time:new Date(_.properties.time).getTime(),ele:_.properties.ele};D.push(A)}return w}function E(f){const w=[];for(let x=0;x<f.segments.length;x++){const z=f.segments[x];for(let g=1;g<z.length;g++){const j=z[g-1],p=z[g];var D=j.time,_=p.time,O=new Date(D),A=new Date(_);let b=0;O.getDate()===A.getDate()&&O.getMonth()===A.getMonth()&&O.getFullYear()===A.getFullYear()&&(b=Y(j.loc[1],j.loc[0],p.loc[1],p.loc[0],j.ele,p.ele));const I={computed:{distance:b},loc1:j,loc2:p};if(j.ele&&p.ele&&(I.computed.ele=p.ele),j.time&&p.time&&j.time!==p.time){const{speed:G,time:ie}=T(b,j.time,p.time),Se=G;I.computed.speed=G,I.computed.time=ie,I.computed.filteredSpeed=Se}j.temp&&p.temp&&(I.computed.temp=(j.temp+p.temp)/2),p.hr&&(I.computed.hr=p.hr),p.cad&&(I.computed.cad=p.cad),I.computed.speed&&w.push(I)}}return w}function Y(f,w,D,_,O,A){const z=f*Math.PI/180,g=D*Math.PI/180,j=(D-f)*Math.PI/180,p=(_-w)*Math.PI/180,b=Math.sin(j/2)*Math.sin(j/2)+Math.cos(z)*Math.cos(g)*Math.sin(p/2)*Math.sin(p/2);let G=6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)));if(O!==void 0&&A!==void 0){const ie=A-O;ie!==0&&(G=Math.sqrt(Math.pow(G,2)+Math.pow(ie,2)))}return G}function T(f,w,D){const _=D/1e3-w/1e3;return{speed:(f/_||0)*3.6,time:_}}};c.useEffect(()=>(P||F(!0),C({date:null,time:null,speed:0}),S({ready:!1,Data:[],options:null}),L(),()=>{v.current&&cancelAnimationFrame(v.current),R.current&&clearTimeout(R.current),d.current&&d.current.remove(),o.current&&o.current.remove()}),[t]),c.useEffect(()=>{if(s!==null){F(!1);const u=M.current.details[s];if(!u)return;if(u.type==="move")setTimeout(async()=>{l.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none");var H={type:"FeatureCollection",features:[{type:"Feature",geometry:u.route.geometry}]};if(!l.getImage("icon_arrow")&&!l.hasImage("icon_arrow")){var V='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',E=new Image;E.onload=function(){l.hasImage("icon_arrow")||l.addImage("icon_arrow",E)},E.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(V)}if(l.getSource("RouteHistory")?l.getSource("RouteHistory").setData(H):(l.addSource("RouteHistory",{type:"geojson",data:H}),l.addLayer({id:"RouteHistory",type:"line",source:"RouteHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity}}),l.addLayer({id:"RouteHistory-arrow",type:"symbol",source:"RouteHistory",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}})),u.route.geometry.coordinates.length){var Y=me(H);l.fitBounds(Y,{padding:100,maxZoom:16,duration:1e3})}},300);else if(u.type==="start"||u.type==="end"||u.type==="stop"||u.type==="checkin"){l.easeTo({center:u.coordinates,duration:100,zoom:16,bearing:0});var r;if(u.type==="start"||u.type==="end"){let H="default";u.type!="stop"&&(H=u.type),r=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${H}-color"></span>
                                <span>${u.address}</span>
                            </div>
                            ${u.type!=="stop"?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${H}-color"></span>
                                <span>${m(u.timestamp)}</span>
                            </div>`:`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                    </svg>
                                </span>
                                <span>${m(u.startTime)}</span>
                            </div>
                            ${u.endTime!==""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                        </svg>
                                    </span>
                                    <span>${m(u.endTime)}</span>
                                </div>`:""} `} `}(u.type==="stop"||u.type==="checkin")&&(r=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                <span>${u.address}</span>
                            </div>
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                </span>
                                <span>${m(u.startTime)}</span>
                            </div>
                            ${u.endTime!=""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                    </span>
                                    <span>${m(u.endTime)}</span>
                                </div>`:""}`),d.current=new K.Popup({className:"ek-tracking-his-popup",closeButton:!0,anchor:"bottom",focusAfterOpen:!1}).setLngLat(u.coordinates).setHTML(r).setOffset([0,-20]).addTo(l)}}return()=>{try{d.current&&d.current.remove(),l&&(l.setPaintProperty("ek-tracking-his-LineString","line-color",a.route.lineCorlor),l.setPaintProperty("ek-tracking-his-LineString","line-opacity",a.route.lineOpacity),l.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),l.getSource("RouteHistory")&&(l.removeLayer("RouteHistory"),l.removeLayer("RouteHistory-arrow"),l.removeSource("RouteHistory")))}catch(B){console.log(B)}}},[s]);function m(r){if(r||r!=""){const B=new Date(r);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(B)}else return"Không có thông tin"}const q=r=>{if(r){const B=new Date(r.loc1.time);B.setHours(B.getHours());const u=B.getDate(),H=B.getMonth()+1,V=B.getFullYear(),E=B.getHours(),Y=B.getMinutes(),T=`${u}/${H}/${V}`,f=`${E.toString().padStart(2,"0")}:${Y.toString().padStart(2,"0")}`;C({date:T,time:f,speed:Math.ceil(r.computed.speed*10)/10})}else C({date:null,time:null,speed:0})};return e.jsx(e.Fragment,{children:e.jsxs("div",{ref:n,id:"ekmap-tracking-his-map",children:[k.ready!==!1&&e.jsx(Bt,{map:l,segmentData:k.Data,options:k.options,Animation:P,currentInfo:q}),e.jsx($t,{}),y.date!==null&&y.time!==null&&e.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[e.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[e.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:y.date}),e.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:y.time})]}),e.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[e.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),e.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[y.speed," km/h"]})]})]})]})})}function Dt({employee:t}){const[i,s]=c.useState(new Date("03-29-2024")),[n,o]=c.useState(se(new Date("03-29-2024").setHours(0,0,0).toString())),[l,h]=c.useState(se(new Date("03-29-2024").setHours(24,0,0).toString())),[k,S]=c.useState(""),[y,C]=c.useState([]),[v,R]=c.useState(""),M=a=>{setTimeout(()=>{s(a),o(se(ge(a).today)),h(se(ge(a).nextday))},200)},[P,F]=c.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:l}),d=async a=>{let L=await re.get("/api/method/mbw_dms.api.user.get_list_employees");if(L.message=="Thành công"){let $=L.result.map(function(m){return{value:m.name,label:m.employee_name}});C($)}},N=async(a,L)=>{F($=>({...$,objectId:L.object_id})),S(`${L.label} - ${a}`)};return c.useEffect(()=>{(async()=>{if(t==null||t==""){const a=await re.get("/api/method/mbw_dms.api.user.get_projectID");F(L=>({...L,projectId:a.result["Project ID"],objectId:""})),d(a.result["Project ID"]);return}try{const a=await re.get("/api/method/mbw_dms.api.user.get_projectID");console.log(a),F($=>({...$,projectId:a.result["Project ID"],objectId:t})),d(a.result["Project ID"]),console.log(P);const L=await re.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${t}`);L.message=="Thành công"&&L.result.length>0&&(S(L.result[0].employee_name),R(L.result[0].name))}catch(a){Ie.error(a?.message||"Something was wrong!!!")}})()},[t]),c.useEffect(()=>{(async()=>F(a=>({...a,from_time:n,to_time:l})))()},[n,l]),e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(Fe,{to:"/employee-monitor",children:[" ",e.jsx(ft,{})]}),e.jsx("span",{className:"ml-4",children:k})]}),customButton:e.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:e.jsx(Pe,{defaultValue:Be(i),format:"DD-MM-YYYY",onChange:M})}),customSlect:e.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:e.jsx(ve,{defaultValue:v,style:{width:150},onChange:N,options:y})})}),e.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:e.jsx("div",{id:"travel",className:"relative",children:P.projectId&&e.jsx(Tt,{options:P})})})]})}function Pt(){c.useState("list");const{employee_id:t}=He();return e.jsx(e.Fragment,{children:e.jsx(Dt,{employee:t})})}function qt(){return e.jsxs(e.Fragment,{children:[e.jsx(De,{children:e.jsx("title",{children:" EmployeeMonitor Detail"})}),e.jsx(Pt,{})]})}export{qt as default};
