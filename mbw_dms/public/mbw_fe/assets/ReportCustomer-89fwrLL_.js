import{X as a,aS as P,a1 as M,L as e,R as i,Q as l,P as o,a3 as $,a2 as z,O,U as c,a4 as U,br as X,a7 as G}from"./index-ltiP0un4.js";import{H as Q}from"./header-page-jd1iY4du.js";import{a as J,b as W}from"./index.esm-Crwa9ic3.js";import{d as q}from"./dayjs.min-VH93qoHM.js";import{u as Z}from"./useDebount-QKGsJ1Q5.js";import{V as ee}from"./VerticalAlignBottomOutlined--1LYlhLN.js";import{D as x}from"./index-ee-89JSv.js";import{I as p}from"./index-5ZPC9PC-.js";const te=[{title:"STT",dataIndex:"stt",key:"stt",render:(u,h,d)=>d+1},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code"},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name"},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type"},{title:"Địa chỉ",dataIndex:"customer_address",key:"customer_address"}];function se(){const[u,h]=a.useState([]),[d]=P(),[f,_]=a.useState(),[j,g]=a.useState(),[N,y]=a.useState(),[b,F]=a.useState(),[k,D]=a.useState(),[v,I]=a.useState(),[S,Y]=a.useState(),[w,T]=a.useState(),[R,B]=a.useState([]),[C,E]=a.useState(""),m=t=>{console.log(t)},[H,V]=a.useState("");Z(H,500);const A=t=>{const s=[{title:"STT",dataIndex:"stt",key:"stt",render:(n,r,L)=>L+1},{title:"Mã sản phẩm",dataIndex:"item_code",key:"item_code"},{title:"Tên sản phẩm",dataIndex:"item_name",key:"item_name"},{title:"Hạn sử dụng",dataIndex:"exp_time",key:"exp_time",render:(n,r)=>e.jsx("p",{children:q(r.exp_time*1e3).format("DD/MM/YYYY")})},{title:"Đơn vị tính",dataIndex:"item_unit",key:"item_unit"},{title:"Tồn",dataIndex:"quantity",key:"quantity"},{title:"Giá sản phẩm",dataIndex:"item_price",key:"item_price",render:(n,r)=>e.jsx("p",{children:Intl.NumberFormat().format(r.item_price)})},{title:"Tổng giá trị",dataIndex:"total",key:"total",render:(n,r)=>e.jsx("p",{children:Intl.NumberFormat().format(r.quantity*r.item_price)})},{title:"Ngày cập nhật",dataIndex:"update_at",key:"update_at",render:(n,r)=>e.jsx("p",{children:q(r.update_at*1e3).format("DD/MM/YYYY")})},{title:"Người cập nhật",dataIndex:"update_byname",key:"update_byname",render:(n,r)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{children:r.update_byname}),e.jsx("div",{className:"font-normal text-sm leading-[21px] text-[#637381]",children:r.update_bycode})]})}];return e.jsx(X,{columns:s,dataSource:t.items.map(n=>({...n,key:n.item_code})),pagination:!1})},K=t=>{if(console.log("val:",t),t.expire_from){let s=Date.parse(t.expire_from.$d)/1e3;_(s)}else _(void 0);if(t.expire_to){let s=Date.parse(t.expire_to.$d)/1e3;g(s)}else g(void 0);if(t.qty_inven_from?D(t.qty_inven_from):D(void 0),t.qty_inven_to?I(t.qty_inven_to):I(void 0),t.total_from?Y(t.total_from):Y(void 0),t.total_to?T(t.total_to):T(void 0),t.update_at_from){let s=Date.parse(t.update_at_from.$d)/1e3;y(s)}else y(void 0);if(t.update_at_to){let s=Date.parse(t.update_at_to.$d)/1e3;F(s)}else F(void 0)};return a.useEffect(()=>{(async()=>{const t=await M.get("/api/method/mbw_dms.api.selling.product.list_product");let{result:s}=t;B(s.data.map(n=>({value:n.item_code,label:n.item_name,des:n.item_code})))})()},[]),a.useEffect(()=>{(async()=>{const t=await M.get("/api/method/mbw_dms.api.report.inventory.get_customer_inventory",{params:{expire_from:f,expire_to:j,update_at_from:N,update_at_to:b,qty_inven_from:k,qty_inven_to:v,total_from:S,total_to:w,item_code:C}});h(t.result.map(s=>({...s,key:s.name})))})()},[f,j,k,v,S,w,C,N,b]),console.log("keydataCustomer",u),e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Báo cáo tồn kho khách hàng",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(ee,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-xl pt-4",children:[e.jsxs(i,{className:"justify-between items-center w-full",children:[e.jsx(l,{span:14,children:e.jsx(i,{gutter:8,children:e.jsx(l,{span:8,children:e.jsx("div",{className:"flex justify-start items-center",children:e.jsx(o,{className:"w-[200px] border-none p-4",children:e.jsx($,{filterOption:!1,onChange:t=>{E(t)},showSearch:!0,defaultValue:"",notFoundContent:null,onSearch:t=>V(t),options:[{label:"Sản phẩm",value:""},...R],optionRender:t=>(console.log("option:",t),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{role:"img","aria-label":t.data.label,className:"my-1",children:t.data.label}),e.jsx("span",{className:"text-xs !font-semibold",children:t.data.des})]})}))})})})})})}),e.jsx(l,{className:"mr-5",children:e.jsx("div",{className:"flex flex-wrap items-center",children:e.jsxs("div",{className:"flex justify-center items-center mr-4",children:[e.jsx(z,{placement:"bottom",dropdownRender:()=>e.jsxs("div",{className:"p-4 rounded-xl !bg-white w-[400px]",children:[e.jsx("div",{className:"text-base font-medium text-[#212B36] leading-5",children:"Bộ lọc"}),e.jsx("div",{className:"pt-6",children:e.jsxs(O,{form:d,onFinish:K,children:[e.jsx("div",{className:"font-semibold text-sm leading-5 text-[#212B36]",children:"Hạn sử dụng"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Ngày bắt đầu"}),e.jsx(o,{className:"pt-2",name:"expire_from",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:m})})]}),e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Kết thúc"}),e.jsx(o,{className:"pt-2",name:"expire_to",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:m})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Ngày cập nhật"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Ngày bắt đầu"}),e.jsx(o,{name:"update_at_from",className:"pt-2",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:m})})]}),e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Kết thúc"}),e.jsx(o,{name:"update_at_to",className:"pt-2",children:e.jsx(x,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8]",onChange:m})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Số lượng tồn kho"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Từ"}),e.jsx(o,{className:"pt-2",name:"qty_inven_from",children:e.jsx(p,{controls:!1,className:"w-full",placeholder:"0"})})]}),e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Đến"}),e.jsx(o,{className:"pt-2",name:"qty_inven_to",children:e.jsx(p,{controls:!1,className:"w-full",placeholder:"0"})})]})]}),e.jsx("div",{className:"pt-5 font-semibold text-sm leading-5 text-[#212B36]",children:"Tổng giá trị"}),e.jsxs(i,{className:"pt-1",gutter:16,children:[e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Từ"}),e.jsx(o,{className:"pt-2",name:"total_from",children:e.jsx(p,{controls:!1,className:"!bg-[#F5F7FA] w-full",placeholder:"0",suffix:"VND"})})]}),e.jsxs(l,{span:12,children:[e.jsx("span",{className:"font-normal text-sm leading-5 text-[#637381]",children:"Đến"}),e.jsx(o,{className:"pt-2",name:"total_to",children:e.jsx(p,{controls:!1,className:"!bg-[#F5F7FA] w-full",placeholder:"0",suffix:"VND"})})]})]}),e.jsxs(i,{className:"justify-between pt-6 pb-4",children:[e.jsx("div",{}),e.jsxs("div",{children:[e.jsx(c,{className:"mr-3",onClick:t=>{t.preventDefault(),d.resetFields()},children:"Đặt lại"}),e.jsx(c,{type:"primary",onClick:()=>{d.submit()},children:"Áp dụng"})]})]})]})})]}),children:e.jsx(c,{onClick:t=>t.preventDefault(),className:"flex items-center text-nowrap !text-[13px] !leading-[21px] !font-normal  border-r-[0.1px] rounded-r-none h-9",icon:e.jsx(J,{style:{fontSize:"20px"}}),children:"Bộ lọc"})}),e.jsx(c,{className:"border-l-[0.1px] rounded-l-none h-9",children:e.jsx(W,{style:{fontSize:"20px"}})})]})})})]}),e.jsx("div",{className:"p-4",children:e.jsx(U,{columns:te,expandable:{expandedRowRender:A,defaultExpandedRowKeys:["0"]},dataSource:u})})]})]})}function ce(){return e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx("title",{children:" ReportCustomer"})}),e.jsx(se,{})]})}export{ce as default};
