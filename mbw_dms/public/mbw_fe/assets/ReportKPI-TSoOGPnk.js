import{W as d,a0 as o,L as e,O as m,a2 as w,br as t,a6 as Y}from"./index-rKCjVRKV.js";import{H as z}from"./header-page-K_T5-PEx.js";import{T as k}from"./tableCustom-ruB7dXRQ.js";import{u as y}from"./useDebount-_Gx7jrlI.js";import{d as x}from"./dayjs.min-aC8aHvbn.js";import{t as M}from"./index-HLpRu8Zd.js";import{D as O}from"./index-2B7jmbNa.js";import{T as B}from"./index-GkFlMwK3.js";import{V as G}from"./VerticalAlignBottomOutlined-fvsKQ9HT.js";const U=[{label:"Tháng 1",value:"1"},{label:"Tháng 2",value:"2"},{label:"Tháng 3",value:"3"},{label:"Tháng 4",value:"4"},{label:"Tháng 5",value:"5"},{label:"Tháng 6",value:"6"},{label:"Tháng 7",value:"7"},{label:"Tháng 8",value:"8"},{label:"Tháng 9",value:"9"},{label:"Tháng 10",value:"10"},{label:"Tháng 11",value:"11"},{label:"Tháng 12",value:"12"}],{Column:a,ColumnGroup:h}=k;function W(){const[v,b]=d.useState([]),[C,T]=d.useState([]),[r,I]=d.useState(),[f,F]=d.useState(""),[c,N]=d.useState();let u=y(f);const[H,X]=d.useState(""),[g,K]=d.useState(1),j=20,[l,E]=d.useState([]),[S,L]=d.useState(""),[_,p]=d.useState(""),[P,D]=d.useState(0);y(H,300);const R=n=>{p(n?.$y.toString())},V=(x().month()+1).toString(),A=x().format("YYYY");return d.useEffect(()=>{(async()=>{let n=await o.get("/api/method/mbw_dms.api.router.get_team_sale");T(M({data:n.result.map(s=>({title:s.name,value:s.name,...s})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),d.useEffect(()=>{(async()=>{let n=await o.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:r,key_search:u}}),{message:s}=n;b(s.map(i=>({value:i.employee_code,label:i.employee_name||i.employee_code})))})()},[r,u]),d.useEffect(()=>{(_===void 0||_==="")&&p(A),(async()=>{const n=await o.get("/api/method/mbw_dms.api.report.kpi.kpi_report",{params:{page_size:j,page_number:g,month:S,year:_,sales_team:r,employee:c}});E(n?.result),D(n?.result?.totals)})()},[S,_,r,c,g]),e.jsxs(e.Fragment,{children:[e.jsx(z,{title:"Báo cáo KPI",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(G,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),e.jsxs("div",{className:"bg-white rounded-md py-7 px-4 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs("div",{className:"flex justify-start items-center",children:[e.jsx(m,{className:"w-[200px] border-none mr-2",children:e.jsx(w,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",defaultValue:V,options:U,onChange:n=>{L(n)},showSearch:!0})}),e.jsx(m,{className:"w-[200px] border-none mr-2",children:e.jsx(O,{className:"!bg-[#F4F6F8]",onChange:R,picker:"year",defaultValue:x().startOf("year")})}),e.jsx(m,{className:"w-[200px] border-none mr-2",children:e.jsx(B,{showSearch:!0,defaultValue:"",treeData:[{label:"Tất cả nhân viên",value:""},...C],onChange:n=>{I(n)}})}),e.jsx(m,{className:"w-[200px] border-none mr-2",children:e.jsx(w,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:[{label:"Tất cả nhân viên",value:""},...v],showSearch:!0,defaultValue:"",notFoundContent:null,onSearch:F,onChange:n=>{N(n)},allowClear:!0})})]}),e.jsx("div",{className:"pt-5",children:e.jsxs(k,{dataSource:l?.data?.map(n=>({key:n.name,...n})),bordered:!0,scroll:{x:!0},pagination:{defaultPageSize:j,total:P,onChange(n,s){K(n)}},summary:()=>e.jsxs(t.Summary.Row,{children:[e.jsx(t.Summary.Cell,{index:0}),e.jsx(t.Summary.Cell,{index:1,children:"Tổng"}),e.jsx(t.Summary.Cell,{index:2}),e.jsx(t.Summary.Cell,{index:3}),e.jsx(t.Summary.Cell,{index:4,children:l?.sum?.tong_kh_vt}),e.jsx(t.Summary.Cell,{index:5,children:l?.sum?.tong_th_vt}),e.jsx(t.Summary.Cell,{index:6}),e.jsx(t.Summary.Cell,{index:7,children:l?.sum?.tong_kh_vt_dn}),e.jsx(t.Summary.Cell,{index:8,children:l?.sum?.tong_th_vt_dn}),e.jsx(t.Summary.Cell,{index:9}),e.jsx(t.Summary.Cell,{index:10,children:l?.sum?.tong_kh_dat_hang}),e.jsx(t.Summary.Cell,{index:11,children:l?.sum?.tong_th_dat_hang}),e.jsx(t.Summary.Cell,{index:12}),e.jsx(t.Summary.Cell,{index:13,children:l?.sum?.tong_kh_kh_moi}),e.jsx(t.Summary.Cell,{index:14,children:l?.sum?.tong_th_kh_moi}),e.jsx(t.Summary.Cell,{index:15}),e.jsx(t.Summary.Cell,{index:16,children:l?.sum?.tong_kh_don_hang}),e.jsx(t.Summary.Cell,{index:17,children:l?.sum?.tong_th_don_hang}),e.jsx(t.Summary.Cell,{index:18}),e.jsx(t.Summary.Cell,{index:19,children:l?.sum?.tong_kh_doanh_so}),e.jsx(t.Summary.Cell,{index:20,children:l?.sum?.tong_th_doanh_so}),e.jsx(t.Summary.Cell,{index:21}),e.jsx(t.Summary.Cell,{index:22,children:l?.sum?.tong_kh_doanh_thu}),e.jsx(t.Summary.Cell,{index:23,children:l?.sum?.tong_th_doanh_thu}),e.jsx(t.Summary.Cell,{index:24}),e.jsx(t.Summary.Cell,{index:25,children:l?.sum?.tong_kh_san_lg}),e.jsx(t.Summary.Cell,{index:26,children:l?.sum?.tong_th_san_lg}),e.jsx(t.Summary.Cell,{index:27}),e.jsx(t.Summary.Cell,{index:28,children:l?.sum?.tong_kh_sku}),e.jsx(t.Summary.Cell,{index:29,children:l?.sum?.tong_th_sku}),e.jsx(t.Summary.Cell,{index:30}),e.jsx(t.Summary.Cell,{index:31,children:l?.sum?.tong_kh_so_gio_lam_viec}),e.jsx(t.Summary.Cell,{index:32,children:l?.sum?.tong_th_so_gio_lam_viec}),e.jsx(t.Summary.Cell,{index:33})]}),children:[e.jsx(a,{title:"STT",dataIndex:"stt",fixed:"left",width:60,render:(n,s,i)=>i+1},"stt"),e.jsx(a,{title:"Mã Nhân viên",dataIndex:"nhan_vien_ban_hang",fixed:"left",width:130},"nhan_vien_ban_hang"),e.jsx(a,{title:"Nhân viên",dataIndex:"ten_nv",fixed:"left",width:200},"ten_nv"),e.jsx(a,{title:"Phòng/nhóm",dataIndex:"nhom_ban_hang",render:(n,s)=>e.jsx("div",{className:"!w-[180px]",children:s.nhom_ban_hang})},"nhom_ban_hang"),e.jsxs(h,{className:"!whitespace-normal",title:"Số khách hàng viếng thăm",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_vt"},"kh_vt"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_vt"},"th_vt"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_vt",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_vt,"%"]})},"tl_vt")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Số khách hàng viếng thăm duy nhất",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_vt_dn"},"kh_vt_dn"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_vt_dn"},"th_vt_dn"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_vt_dn",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_vt_dn,"%"]})},"tl_vt_dn")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Số khách hàng đặt hàng",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_dat_hang"},"kh_dat_hang"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_dat_hang"},"th_dat_hang"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_dat_hang",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_dat_hang,"%"]})},"tl_dat_hang")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Số khách hàng thêm mới",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_kh_moi"},"kh_kh_moi"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_kh_moi"},"th_kh_moi"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_kh_moi",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_kh_moi,"%"]})},"tl_kh_moi")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Số đơn hàng",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_don_hang"},"kh_don_hang"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_don_hang"},"th_don_hang"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_don_hang",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_don_hang,"%"]})},"tl_don_hang")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Doanh số",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_doanh_so"},"kh_doanh_so"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_doanh_so"},"th_doanh_so"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_don_hang",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_don_hang,"%"]})},"tl_don_hang")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Doanh thu",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_doanh_thu"},"kh_doanh_thu"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_doanh_thu"},"th_doanh_thu"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_doanh_thu",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_doanh_thu,"%"]})},"tl_doanh_thu")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Sản lượng",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_san_lg"},"kh_san_lg"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_san_lg"},"th_san_lg"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_san_luong",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_san_luong,"%"]})},"tl_san_luong")]}),e.jsxs(h,{className:"!whitespace-normal",title:"SKU",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_sku"},"kh_sku"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_sku"},"th_sku"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_sku",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_sku,"%"]})},"tl_sku")]}),e.jsxs(h,{className:"!whitespace-normal",title:"Số giờ làm việc",width:210,children:[e.jsx(a,{title:"KH",width:70,dataIndex:"kh_so_gio_lam_viec"},"kh_so_gio_lam_viec"),e.jsx(a,{title:"TH",width:70,dataIndex:"th_so_gio_lam_viec"},"th_so_gio_lam_viec"),e.jsx(a,{title:"TL",width:70,dataIndex:"tl_so_gio_lam_viec",render:(n,s)=>e.jsxs(e.Fragment,{children:[s.tl_so_gio_lam_viec,"%"]})},"tl_so_gio_lam_viec")]})]})})]})]})}function le(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{children:e.jsx("title",{children:" ReportKPI"})}),e.jsx(W,{})]})}export{le as default};
