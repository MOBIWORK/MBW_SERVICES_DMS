import{ad as U,ag as ke,ah as je,ax as ce,aj as ge,bH as he,ak as ze,ai as Ie,h as W,W as l,av as Fe,aK as be,bw as Be,bk as He,ap as oe,ac as le,L as t,bC as Pe,R as de,P as Y,af as Q,Q as ne,a3 as Se,bI as Oe,aT as J,a1 as re,a0 as De,bJ as Ee,a7 as _e,b3 as Re,a8 as Ae}from"./index-Fp4LXqz2.js";import{D as We}from"./date-picker-233NyMeP.js";import{a as se,T as fe}from"./index-kEsMYCQq.js";import{H as Ve}from"./header-page-XzMrFyrx.js";import{W as ee,c as qe,d as G,r as Ge,l as Ze,p as K,f as pe,s as Xe,g as xe,e as Ye,b as ye}from"./WrapperCard-LGk5K0QS.js";import"./index-TEhC5UcC.js";const we=["wrap","nowrap","wrap-reverse"],Ce=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],$e=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],Ue=(e,i)=>{const r={};return we.forEach(n=>{r[`${e}-wrap-${n}`]=i.wrap===n}),r},Je=(e,i)=>{const r={};return $e.forEach(n=>{r[`${e}-align-${n}`]=i.align===n}),r[`${e}-align-stretch`]=!i.align&&!!i.vertical,r},Ke=(e,i)=>{const r={};return Ce.forEach(n=>{r[`${e}-justify-${n}`]=i.justify===n}),r};function Qe(e,i){return U(Object.assign(Object.assign(Object.assign({},Ue(e,i)),Je(e,i)),Ke(e,i)))}const et=e=>{const{componentCls:i}=e;return{[i]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},tt=e=>{const{componentCls:i}=e;return{[i]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},it=e=>{const{componentCls:i}=e,r={};return we.forEach(n=>{r[`${i}-wrap-${n}`]={flexWrap:n}}),r},nt=e=>{const{componentCls:i}=e,r={};return $e.forEach(n=>{r[`${i}-align-${n}`]={alignItems:n}}),r},rt=e=>{const{componentCls:i}=e,r={};return Ce.forEach(n=>{r[`${i}-justify-${n}`]={justifyContent:n}}),r},st=()=>({}),at=ke("Flex",e=>{const{paddingXS:i,padding:r,paddingLG:n}=e,o=je(e,{flexGapSM:i,flexGap:r,flexGapLG:n});return[et(o),tt(o),it(o),nt(o),rt(o)]},st,{resetStyle:!1});var ot=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const lt=ce.forwardRef((e,i)=>{const{prefixCls:r,rootClassName:n,className:o,style:c,flex:g,gap:x,children:S,vertical:f=!1,component:w="div"}=e,k=ot(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:T,direction:M,getPrefixCls:H}=ce.useContext(ge),$=H("flex",r),[d,I,a]=at($),C=f??T?.vertical,N=U(o,n,T?.className,$,I,a,Qe($,e),{[`${$}-rtl`]:M==="rtl",[`${$}-gap-${x}`]:he(x),[`${$}-vertical`]:C}),m=Object.assign(Object.assign({},T?.style),c);return g&&(m.flex=g),x&&!he(x)&&(m.gap=x),d(ce.createElement(w,Object.assign({ref:i,className:N,style:m},ze(k,["justify","wrap","align"])),S))}),ue=lt,ct=e=>{const{componentCls:i,calc:r}=e;return{[i]:Object.assign(Object.assign({},Ie(e)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:r(r(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${W(e.itemHeadSize)})`,borderInlineStart:`${W(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${W(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:r(e.itemHeadSize).div(2).equal(),insetInlineStart:r(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:r(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:r(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:r(e.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${W(e.marginXXS)})`,width:`calc(50% - ${W(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${W(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${W(r(r(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${W(r(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${W(e.margin)})`,borderInlineStart:`${W(e.tailWidth)} dotted ${e.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${W(e.margin)})`,borderInlineStart:`${W(e.tailWidth)} dotted ${e.tailColor}`},[`${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${W(e.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${W(e.marginSM)})`,width:`calc(50% - ${W(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},dt=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),pt=ke("Timeline",e=>{const i=je(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[ct(i)]},dt);var ut=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const gt=e=>{var{prefixCls:i,className:r,color:n="blue",dot:o,pending:c=!1,position:g,label:x,children:S}=e,f=ut(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:w}=l.useContext(ge),k=w("timeline",i),T=U(`${k}-item`,{[`${k}-item-pending`]:c},r),M=/blue|red|green|gray/.test(n||"")?void 0:n,H=U(`${k}-item-head`,{[`${k}-item-head-custom`]:!!o,[`${k}-item-head-${n}`]:!M});return l.createElement("li",Object.assign({},f,{className:T}),x&&l.createElement("div",{className:`${k}-item-label`},x),l.createElement("div",{className:`${k}-item-tail`}),l.createElement("div",{className:H,style:{borderColor:M,color:M}},o),l.createElement("div",{className:`${k}-item-content`},S))},Le=gt;var ve=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const mt=e=>{var{prefixCls:i,className:r,pending:n=!1,children:o,items:c,rootClassName:g,reverse:x=!1,direction:S,hashId:f,pendingDot:w,mode:k=""}=e,T=ve(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const M=(m,q)=>k==="alternate"?m==="right"?`${i}-item-right`:m==="left"?`${i}-item-left`:q%2===0?`${i}-item-left`:`${i}-item-right`:k==="left"?`${i}-item-left`:k==="right"?`${i}-item-right`:m==="right"?`${i}-item-right`:"",H=Fe(c||[]),$=typeof n=="boolean"?null:n;n&&H.push({pending:!!n,dot:w||l.createElement(be,null),children:$}),x&&H.reverse();const d=H.length,I=`${i}-item-last`,a=H.filter(m=>!!m).map((m,q)=>{var s;const P=q===d-2?I:"",u=q===d-1?I:"",{className:O}=m,V=ve(m,["className"]);return l.createElement(Le,Object.assign({},V,{className:U([O,!x&&n?P:u,M((s=m?.position)!==null&&s!==void 0?s:"",q)]),key:m?.key||q}))}),C=H.some(m=>!!m?.label),N=U(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!x,[`${i}-${k}`]:!!k&&!C,[`${i}-label`]:C,[`${i}-rtl`]:S==="rtl"},r,g,f);return l.createElement("ul",Object.assign({},T,{className:N}),a)},ht=mt;function ft(e,i){return e&&Array.isArray(e)?e:Be(i).map(r=>{var n,o;return Object.assign({children:(o=(n=r?.props)===null||n===void 0?void 0:n.children)!==null&&o!==void 0?o:""},r.props)})}var xt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const Te=e=>{const{getPrefixCls:i,direction:r,timeline:n}=l.useContext(ge),{prefixCls:o,children:c,items:g,className:x,style:S}=e,f=xt(e,["prefixCls","children","items","className","style"]),w=i("timeline",o),k=He(w),[T,M,H]=pt(w,k),$=ft(g,c);return T(l.createElement(ht,Object.assign({},f,{className:U(n?.className,x,H,k),style:Object.assign(Object.assign({},n?.style),S),prefixCls:w,direction:r,items:$,hashId:M})))};Te.Item=Le;const yt=Te;var vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const kt=vt;var jt=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:kt}))};const bt=l.forwardRef(jt);var St={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const wt=St;var Ct=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:wt}))};const $t=l.forwardRef(Ct);var Lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const Tt=Lt;var Nt=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:Tt}))};const Mt=l.forwardRef(Nt);var zt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const It=zt;var Ft=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:It}))};const Bt=l.forwardRef(Ft),Ht=({size:e=16})=>t.jsx("svg",{width:e,height:e+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function Pt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function Ot({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_start})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Dt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function Et({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_end})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function _t(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function Rt({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_checking})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.retail_name})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function At(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function Wt({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_moving})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),t.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[e.total_distance," Trip"]})]})]})}function Vt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function qt({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_stop})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Gt({options:e}){const[i,r]=l.useState([]),[n,o]=l.useState({summary:null,details:[]}),[c,g]=l.useState(!0),[x,S]=l.useState(null);l.useEffect(()=>{g(!0)},[e]);const f=d=>{S(d)};l.useEffect(()=>{let d=[];if(n.details!=null)for(let I=0;I<n.details.length;I++){let a=n.details[I];a.type=="start"?d.push({dot:t.jsx(Pt,{}),children:t.jsx(Ot,{data:{time_start:$(a.timestamp),address:a.address,index_item:I},onEventClickItem:f})}):a.type=="checkin"?d.push({dot:t.jsx(_t,{}),children:t.jsx(Rt,{data:{time_checking:`${$(a.startTime)} - ${$(a.endTime)}`,retail_name:a.storeName,address:a.address,total_time:`${k(a.startTime,a.endTime)}`,index_item:I},onEventClickItem:f})}):a.type=="move"?d.push({dot:t.jsx(At,{}),children:t.jsx(Wt,{data:{time_moving:`${$(a.startTime)} - ${$(a.endTime)}`,total_distance:`${T(a.distance)}`,total_time:`${k(a.startTime,a.endTime)}`,index_item:I},onEventClickItem:f})}):a.type=="stop"?d.push({dot:t.jsx(Vt,{}),children:t.jsx(qt,{data:{time_stop:`${$(a.startTime)} - ${$(a.endTime)}`,address:a.address,total_time:`${k(a.startTime,a.endTime)}`,index_item:I},onEventClickItem:f})}):a.type=="end"&&d.push({dot:t.jsx(Dt,{}),children:t.jsx(Et,{data:{time_end:`${$(a.timestamp)}`,address:a.address,index_item:I},onEventClickItem:f})})}r(d)},[n]);const w=d=>{d!=null?o(d):o({summary:null,details:[]}),g(!1)},k=(d,I)=>{const a=new Date(d),N=new Date(I)-a;if(N<6e4)return`${Math.round(N/1e3)} giây`;if(N>=6e4&&N<6e4*60)return`${Math.round(N/6e4)} phút`;{const m=Math.floor(N/36e5),q=Math.floor(N%(1e3*60*60)/(1e3*60));return`${m} giờ ${q} phút`}},T=d=>d<1e3?`${Math.round(d)} m`:`${Math.round(d/1e3)} km`,M=d=>d<60?`${Math.round(d)} giây`:d>=60&&d<3600?`${Math.round(d/60)} phút`:`${Math.round(d/3600)} giờ`,H=d=>Math.round(d*3.6),$=d=>{var I=new Date(d);return I.setUTCHours(I.getUTCHours()+7),`${I.getUTCHours()}:${I.getUTCMinutes()}`};return t.jsxs(t.Fragment,{children:[c&&t.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(Pe,{indicator:t.jsx(be,{style:{fontSize:30,color:"#fff"},spin:!0})})}),t.jsxs(de,{gutter:20,children:[t.jsx(Y,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&T(n.summary.move.distance)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),t.jsx(Y,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.move.totalTime)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),t.jsx(Y,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),n.summary!=null?t.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[n.summary&&H(n.summary.move.avgSpeed)," km/h"]}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),t.jsx(Y,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[t.jsxs("div",{style:{marginRight:"40px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.stop.count?n.summary.stop.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.stop.totalTime)?M(n.summary.stop.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})}),t.jsx(Y,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[t.jsxs("div",{style:{marginRight:"13px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.checkin.count?n.summary.checkin.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&M(n.summary.checkin.totalTime)?M(n.summary.checkin.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})})]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(de,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:t.jsx(qe,{children:t.jsxs(de,{children:[t.jsxs(Y,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[t.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),t.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?t.jsx(yt,{mode:"left",items:i}):t.jsx("div",{children:"Chưa có lộ trình"})})]}),t.jsx(Y,{span:18,style:{height:"615px"},children:t.jsx(ei,{options:e,onLoad:w,HistoryIndex:x})})]})})})})]})}function Zt(){const[e,i]=l.useState(!1),r=()=>{i(!e)},n={iconStart:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",iconEnd:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",iconCheckin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",iconStop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"};return t.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[t.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:r,children:[t.jsx("span",{className:`icon ${e?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),t.jsx("span",{children:"Chú giải bản đồ"})]}),t.jsx("div",{className:`ekmapplf_tracking-legend-body ${e?"open":""}`,style:{maxHeight:e?"none":"0"},children:t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStart})`}}),"Vị trí bắt đầu"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconEnd})`}}),"Vị trí kết thúc"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconCheckin})`}}),"Vị trí khách hàng"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStop})`}}),"Vị trí điểm dừng"]})]})})]})}function te(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Xt(e){return e.type==="Feature"?e.geometry:e}function Ne(e,i,r){r===void 0&&(r={});var n=te(e),o=te(i),c=G(o[1]-n[1]),g=G(o[0]-n[0]),x=G(n[1]),S=G(o[1]),f=Math.pow(Math.sin(c/2),2)+Math.pow(Math.sin(g/2),2)*Math.cos(x)*Math.cos(S);return Ge(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),r.units)}function Yt(e,i,r,n){n===void 0&&(n={});var o=te(e),c=G(o[0]),g=G(o[1]),x=G(r),S=Ze(i,n.units),f=Math.asin(Math.sin(g)*Math.cos(S)+Math.cos(g)*Math.sin(S)*Math.cos(x)),w=c+Math.atan2(Math.sin(x)*Math.sin(S)*Math.cos(g),Math.cos(S)-Math.sin(g)*Math.sin(f)),k=pe(w),T=pe(f);return K([k,T],n.properties)}function me(e,i,r){if(r===void 0&&(r={}),r.final===!0)return Ut(e,i);var n=te(e),o=te(i),c=G(n[0]),g=G(o[0]),x=G(n[1]),S=G(o[1]),f=Math.sin(g-c)*Math.cos(S),w=Math.cos(x)*Math.sin(S)-Math.sin(x)*Math.cos(S)*Math.cos(g-c);return pe(Math.atan2(f,w))}function Ut(e,i){var r=me(i,e);return r=(r+180)%360,r}function Jt(e,i,r){r===void 0&&(r={});for(var n=Xt(e),o=n.coordinates,c=0,g=0;g<o.length&&!(i>=c&&g===o.length-1);g++)if(c>=i){var x=i-c;if(x){var S=me(o[g],o[g-1])-180,f=Yt(o[g],x,S,r);return f}else return K(o[g])}else c+=Ne(o[g],o[g+1],r);return K(o[o.length-1])}function Kt(e,i){return i===void 0&&(i={}),Xe(e,function(r,n){var o=n.geometry.coordinates;return r+Ne(o[0],o[1],i)},0)}const Qt=({map:e,segmentData:i,options:r,currentInfo:n,Animation:o})=>{const c=l.useRef(null),g=l.useRef(null),[x,S]=l.useState(r.animation.follow),[f,w]=l.useState(!1),[k,T]=l.useState(10),[M,H]=l.useState(!0),$=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[d,I]=l.useState(!0),a=l.useRef(0),C=l.useRef(0),N=l.useRef([]);function m(z,y){C.current=z;const L=y[z];if(!L){if(M){C.current=0,N.current=[];try{e&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(_){w(!1),console.log(_)}i.length&&i[0].computed.time&&(g.current=setTimeout(m.bind(this),1e3,C.current,i))}else C.current=z-1,R();n(y[C.current]);return}if(n(L),L.computed.time){let _=L.computed.time*1e3/k;if(L.computed.speed){let A=function(v){D||(E=L.loc1.loc,D=v);const F=(v-D)/(Number(L.computed.time?.toString())*1e3/k);if(!(F>1||!f)){var h=xe([L.loc1.loc,L.loc2.loc]),j=Kt(h),p=Jt(h,j*F).geometry.coordinates,b=me(K(E),K(p));E[0]!==p[0]&&E[1]!==p[1]&&(a.current=b),E=p,N.current=N.current.concat([p]);try{e&&x&&e.panTo(p,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:a.current}),e&&e.getSource("locationMarker")&&e.getSource("locationMarker").setData({type:"FeatureCollection",features:[K(p,{bearing:a.current})]}),e&&N.current.length>1&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[xe(N.current)]}),c.current=window.requestAnimationFrame(A)}catch(B){w(!1),console.log(B)}}};var D,E;c.current=window.requestAnimationFrame(A)}z++,N.current=y.slice(0,z).map(A=>A.loc1.loc),g.current=setTimeout(m.bind(this),_,z,y)}}l.useEffect(()=>{R(),c.current&&cancelAnimationFrame(c.current),g.current&&clearTimeout(g.current),C.current=0,i.length&&r.animation.animate&&w(!0)},[i,r]),l.useEffect(()=>{o?O():R()},[o]),l.useEffect(()=>{if(f){C.current===0&&(N.current=[],e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc)),i.length&&i[0].computed.time&&(g.current=setTimeout(m.bind(void 0),500,C.current,i));try{e.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),e.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),e.setLayoutProperty("ek-tracking-his-LineString","visibility","none"),e.setLayoutProperty("locationMarker","visibility","visible"),e.setLayoutProperty("LocationHistory","visibility","visible"),e.getSource("RouteHistory")&&(e.removeLayer("RouteHistory"),e.removeLayer("RouteHistory-arrow"),e.removeSource("RouteHistory"))}catch(z){console.log(z)}}else{n(null),c.current&&cancelAnimationFrame(c.current);try{e.setPaintProperty("ek-tracking-his-LineString","line-color",r.route.lineCorlor),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",r.route.lineOpacity),e.setLayoutProperty("ek-tracking-his-LineString","visibility","visible"),e.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),e.setLayoutProperty("locationMarker","visibility","none"),e.setLayoutProperty("LocationHistory","visibility","none")}catch(z){console.log(z)}}return()=>{c.current&&cancelAnimationFrame(c.current),g.current&&clearTimeout(g.current)}},[f,k,x,M]);const[q,s]=l.useState(r.animation.animate);l.useEffect(()=>{const z=()=>{I(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",z),()=>{document.removeEventListener("visibilitychange",z)}},[]),l.useEffect(()=>{d?q===r.animation.animate?w(!0):w(!1):(s(f),w(!1))},[d]);const P=z=>{T(z)},u=z=>{z.target.checked&&e.setZoom(17),S(!x)},O=()=>{w(!0)},V=()=>{w(!1)},R=()=>{V();try{e&&(e.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc))}catch(z){console.log(z)}C.current=0},Z=()=>{H(!M)};return t.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:t.jsxs(ue,{gap:"small",align:"center",justify:"center",children:[t.jsx(Q,{title:"Play",children:t.jsx(ne,{icon:t.jsx($t,{}),disabled:f,onClick:O})}),t.jsx(Q,{title:"Pause",children:t.jsx(ne,{icon:t.jsx(Mt,{}),disabled:!f,onClick:V})}),t.jsx(Q,{title:"Stop",children:t.jsx(ne,{icon:t.jsx(bt,{}),onClick:R})}),t.jsx(Q,{title:"Replay",children:t.jsx(ne,{type:M?"primary":"default",icon:t.jsx(Bt,{}),onClick:Z})}),t.jsx(Q,{title:"Speed",children:t.jsx(Se,{defaultValue:k,style:{width:"75px"},onChange:P,options:$})}),t.jsx(Oe,{onChange:u,checked:x,children:"Theo dõi lộ trình"})]})})},ae=window.ekmapplf;function ei({options:e,onLoad:i,HistoryIndex:r}){const n=l.useRef(null),o=l.useState(null),[c,g]=l.useState(null),[x,S]=l.useState({ready:!1,Data:[],options:null}),[f,w]=l.useState({date:null,time:null,speed:0}),k=l.useRef(null),T=l.useRef(null),M=l.useRef(null),[H,$]=l.useState(!1),d=l.useRef(null),a=Ye({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{track:"https://files.ekgis.vn/sdks/tracking/assets/custom_marker.png",navigation:"https://files.ekgis.vn/sdks/tracking/assets/arrow.png",checkin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",start:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",end:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",stop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"},route:{visible:!0,lineCorlor:"#01579B",lineWidth:4,lineOpacity:.8},animation:{follow:!0,animate:!0}},e),C=()=>{try{let R=function(){var v={type:"FeatureCollection",features:[]};s.getSource("LocationHistory")?s.getSource("LocationHistory").setData(v):(s.addSource("LocationHistory",{type:"geojson",data:v}),s.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity},filter:["==","$type","LineString"]}))};o.current&&(o.animation_current&&cancelAnimationFrame(o.animation_current),o.timeout_current&&clearTimeout(o.timeout_current),o.current.remove()),o.current=new J.Map({container:n.current,center:a.center,zoom:a.zoom,minZoom:1});var s=o.current;g(s);const Z=s.getContainer();s.setPadding({top:100,bottom:100,left:100,right:100}),new ae.VectorBaseMap("OSM:Bright",a.apiKey).addTo(s);var P=new ae.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+Z.id,baseLayers:[{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});s.addControl(P,"bottom-left"),P.on("changeBaseLayer",async function(v){await new ae.VectorBaseMap(v.layer,a.apiKey).addTo(s),setTimeout(()=>{y(a.from_time,a.to_time,a.pageNumber,a.pageSize)},500)}),s.addControl(new J.NavigationControl({visualizePitch:!0}),"bottom-right");var u=!1;s.getPitch()>0?u=!0:u=!1;var O="maplibregl-terrain2d-control",V="Hiển thị 2D";u||(O="maplibregl-terrain3d-control",V="Bản đồ 3D");let z=new ae.control.Button({className:"btn-ctl-group "+O,icon:"none",tooltip:V});z.on("click",v=>{u=!u,u?(v._div.className=v._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),v._div.title="Hiển thị 2D"):(v._div.className=v._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),v._div.title="Hiển thị 3D"),u?(s.easeTo({pitch:60}),s.setLayoutProperty("building-3d","visibility","visible")):(s.easeTo({pitch:0}),s.setLayoutProperty("building-3d","visibility","none"))}),s.addControl(z,"bottom-right"),s.addControl(new J.FullscreenControl,"top-right"),s.on("load",()=>{try{if(!a.objectId||a.objectId===""||a.objectId==="null"||!a.from_time||a.from_time===""||a.from_time==="null"||!a.to_time||a.to_time===""||a.to_time==="null"){i(null);return}y(a.from_time,a.to_time,a.pageNumber,a.pageSize)}catch(v){console.error("Error:",v)}});const y=async(v,F,h,j)=>{let p=await L(v,F,h,j);await D(p);let b=await N(p);p.length&&p[0].coordinates&&s.easeTo({center:p[0].coordinates,duration:100,zoom:16}),setTimeout(()=>S({ready:!0,Data:b,options:a}),500)},L=async(v,F,h,j)=>{let p=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${a.projectId}/${a.objectId}?api_key=${a.apiKey}&from_time=${v}&to_time=${F}`;const B=await(await fetch(p)).json();M.current=B,i(M.current);var X=B.details;return X||[]},D=async v=>{let F={type:"FeatureCollection",features:[]},h={type:"FeatureCollection",features:[]},j={type:"FeatureCollection",features:[]};if(v.forEach(b=>{const B={type:"Feature",properties:b.type!=="move"?b:{},geometry:b.type==="move"?b.route.geometry:{type:"Point",coordinates:b.coordinates}};F.features.push(B),b.type!=="move"&&(b.type==="checkin"?h.features.push(B):j.features.push(B))}),v.length){var p=ye(F);s.fitBounds(p,{padding:100,maxZoom:14,duration:1e3})}await E(F),await _(h,j),await R(),await A()},E=v=>{try{if(!s.getImage("icon_arrow")){var F='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',h=new Image;h.onload=function(){s.hasImage("icon_arrow")||s.addImage("icon_arrow",h)},h.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(F)}s.getSource("ek-tracking-his-line-source")?s.getSource("ek-tracking-his-line-source").setData(v):(s.addSource("ek-tracking-his-line-source",{type:"geojson",data:v}),s.addLayer({id:"ek-tracking-his-LineString",type:"line",source:"ek-tracking-his-line-source",layout:{"line-join":"round","line-cap":"round",visibility:a.route.visible?"visible":"none"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity},filter:["==","$type","LineString"]}),s.addLayer({id:"ek-tracking-his-LineString-arrow",type:"symbol",source:"ek-tracking-his-line-source",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}))}catch(j){console.error("Error setLine:",j)}},_=async(v,F)=>{try{if(!s.getImage("marker-start")){const h=await s.loadImage(a.icon.start);s.addImage("marker-start",h.data)}if(!s.getImage("marker-end")){const h=await s.loadImage(a.icon.end);s.addImage("marker-end",h.data)}if(!s.getImage("marker-check")){const h=await s.loadImage(a.icon.checkin);s.addImage("marker-check",h.data)}if(!s.getImage("marker-stop")){const h=await s.loadImage(a.icon.stop);s.addImage("marker-stop",h.data)}s.getSource("ek-tracking-his-track-source")?s.getSource("ek-tracking-his-track-source").setData(F):(s.addSource("ek-tracking-his-track-source",{type:"geojson",data:F}),s.addLayer({id:"ek-tracking-his-track-point",type:"symbol",source:"ek-tracking-his-track-source",layout:{"icon-image":["match",["get","type"],"start","marker-start","end","marker-end","marker-stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),s.on("mouseenter","ek-tracking-his-track-point",h=>{s.getCanvas().style.cursor="pointer";const j=[[h.point.x-5,h.point.y-5],[h.point.x+5,h.point.y+5]];let b=s.queryRenderedFeatures(j,{layers:["ek-tracking-his-track-point"]})[0],B="default";b.properties.type!="stop"&&(B=b.properties.type),d.current&&d.current.remove(),d.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(b.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${B}-color"></span>
                                            <span>${b.properties.address}</span>
                                        </div>
                                        ${b.properties.type!=="stop"?`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${B}-color"></span>
                                            <span>${m(b.properties.timestamp)}</span>
                                        </div>`:`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                </svg>
                                            </span>
                                            <span>${m(b.properties.startTime)}</span>
                                        </div>
                                        ${b.properties.endTime!==""?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                    </svg>
                                                </span>
                                                <span>${m(b.properties.endTime)}</span>
                                            </div>`:""} `}
                                    `).setOffset([0,-20]).addTo(s)}),s.on("mouseleave","ek-tracking-his-track-point",()=>{s.getCanvas().style.cursor="",d.current&&d.current.remove()})),s.getSource("ek-tracking-his-check-source")?s.getSource("ek-tracking-his-check-source").setData(v):(s.addSource("ek-tracking-his-check-source",{type:"geojson",data:v,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),s.addLayer({id:"ek-tracking-his-check-clusters",type:"circle",source:"ek-tracking-his-check-source",paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),s.addLayer({id:"ek-tracking-his-check-cluster-count",type:"symbol",source:"ek-tracking-his-check-source",layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),s.addLayer({id:"ek-tracking-his-check-point",type:"symbol",source:"ek-tracking-his-check-source",layout:{"icon-image":"marker-check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),s.on("mouseenter","ek-tracking-his-check-clusters",()=>{s.getCanvas().style.cursor="pointer"}),s.on("mouseleave","ek-tracking-his-check-clusters",()=>{s.getCanvas().style.cursor=""}),s.on("click","ek-tracking-his-check-clusters",async h=>{const j=s.queryRenderedFeatures(h.point,{layers:["ek-tracking-his-check-clusters"]}),p=j[0].properties.cluster_id,b=await s.getSource("ek-tracking-his-check-source").getClusterExpansionZoom(p);s.easeTo({center:j[0].geometry.coordinates,zoom:b})}),s.on("mouseenter","ek-tracking-his-check-point",h=>{s.getCanvas().style.cursor="pointer";const j=[[h.point.x-5,h.point.y-5],[h.point.x+5,h.point.y+5]],p=s.queryRenderedFeatures(j,{layers:["ek-tracking-his-check-point"]});d.current&&d.current.remove(),d.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(p[0].geometry.coordinates).setHTML(`<div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${p[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${m(p[0].properties.startTime)}</span>
                                </div>
                                ${p[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${m(p[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(s)}),s.on("mouseleave","ek-tracking-his-check-point",()=>{s.getCanvas().style.cursor="",d.current&&d.current.remove()}))}catch(h){console.error("Error setPoints:",h)}};async function A(){if(!s.getImage("marker-navigation")){const F=await s.loadImage(a.icon.navigation);s.addImage("marker-navigation",F.data)}var v={type:"FeatureCollection",features:[]};s.getSource("locationMarker")?s.getSource("locationMarker").setData(v):(s.addSource("locationMarker",{type:"geojson",data:v}),s.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker-navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}}catch(R){console.error("Error initializing map:",R)}},N=async s=>{var P,u,O={type:"FeatureCollection",features:[]};return s.forEach(y=>{if(y.type==="move")for(let L=0;L<y.route.locations.length;L++){let D=y.route.locations[L];if(new Date(D.timestamp).getTime()>=new Date(y.startTime).getTime()&&new Date(D.timestamp).getTime()<=new Date(y.endTime).getTime()){let E={type:"Feature",properties:{time:D.timestamp,ele:0,type:y.type},geometry:{type:"Point",coordinates:D.coordinates}};O.features.push(E)}}else if(y.type==="stop"||y.type==="checkin"){let L={type:"Feature",properties:{time:y.startTime,ele:0,type:y.type},geometry:{type:"Point",coordinates:y.coordinates}},D={type:"Feature",properties:{time:y.endTime,ele:0,type:y.type},geometry:{type:"Point",coordinates:y.coordinates}};O.features.push(L,D)}else{let L={type:"Feature",properties:{time:y.timestamp,ele:0,type:y.type},geometry:{type:"Point",coordinates:y.coordinates}};O.features.push(L)}}),P=V(O),u=R(P),u||[];function V(y){var L={segments:[],id:e.objectId};let D=[];L.segments.push(D);for(let _=0;_<y.features.length;_++){var E=y.features[_];let A={loc:E.geometry.coordinates,time:new Date(E.properties.time).getTime(),ele:E.properties.ele};D.push(A)}return L}function R(y){const L=[];for(let v=0;v<y.segments.length;v++){const F=y.segments[v];for(let h=1;h<F.length;h++){const j=F[h-1],p=F[h];var D=j.time,E=p.time,_=new Date(D),A=new Date(E);let b=0;_.getDate()===A.getDate()&&_.getMonth()===A.getMonth()&&_.getFullYear()===A.getFullYear()&&(b=Z(j.loc[1],j.loc[0],p.loc[1],p.loc[0],j.ele,p.ele));const B={computed:{distance:b},loc1:j,loc2:p};if(j.ele&&p.ele&&(B.computed.ele=p.ele),j.time&&p.time&&j.time!==p.time){const{speed:X,time:ie}=z(b,j.time,p.time),Me=X;B.computed.speed=X,B.computed.time=ie,B.computed.filteredSpeed=Me}j.temp&&p.temp&&(B.computed.temp=(j.temp+p.temp)/2),p.hr&&(B.computed.hr=p.hr),p.cad&&(B.computed.cad=p.cad),B.computed.speed&&L.push(B)}}return L}function Z(y,L,D,E,_,A){const F=y*Math.PI/180,h=D*Math.PI/180,j=(D-y)*Math.PI/180,p=(E-L)*Math.PI/180,b=Math.sin(j/2)*Math.sin(j/2)+Math.cos(F)*Math.cos(h)*Math.sin(p/2)*Math.sin(p/2);let X=6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)));if(_!==void 0&&A!==void 0){const ie=A-_;ie!==0&&(X=Math.sqrt(Math.pow(X,2)+Math.pow(ie,2)))}return X}function z(y,L,D){const E=D/1e3-L/1e3;return{speed:(y/E||0)*3.6,time:E}}};l.useEffect(()=>(H||$(!0),w({date:null,time:null,speed:0}),S({ready:!1,Data:[],options:null}),C(),()=>{k.current&&cancelAnimationFrame(k.current),T.current&&clearTimeout(T.current),d.current&&d.current.remove(),o.current&&o.current.remove()}),[e]),l.useEffect(()=>{if(r!==null){$(!1);const u=M.current.details[r];if(!u)return;if(u.type==="move")setTimeout(async()=>{c.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),c.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),c.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none");var O={type:"FeatureCollection",features:[{type:"Feature",geometry:u.route.geometry}]};if(!c.getImage("icon_arrow")&&!c.hasImage("icon_arrow")){var V='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',R=new Image;R.onload=function(){c.hasImage("icon_arrow")||c.addImage("icon_arrow",R)},R.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(V)}if(c.getSource("RouteHistory")?c.getSource("RouteHistory").setData(O):(c.addSource("RouteHistory",{type:"geojson",data:O}),c.addLayer({id:"RouteHistory",type:"line",source:"RouteHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":a.route.lineCorlor,"line-width":a.route.lineWidth,"line-opacity":a.route.lineOpacity}}),c.addLayer({id:"RouteHistory-arrow",type:"symbol",source:"RouteHistory",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}})),u.route.geometry.coordinates.length){var Z=ye(O);c.fitBounds(Z,{padding:100,maxZoom:16,duration:1e3})}},300);else if(u.type==="start"||u.type==="end"||u.type==="stop"||u.type==="checkin"){c.easeTo({center:u.coordinates,duration:100,zoom:16,bearing:0});var s;if(u.type==="start"||u.type==="end"){let O="default";u.type!="stop"&&(O=u.type),s=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${O}-color"></span>
                                <span>${u.address}</span>
                            </div>
                            ${u.type!=="stop"?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${O}-color"></span>
                                <span>${m(u.timestamp)}</span>
                            </div>`:`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                    </svg>
                                </span>
                                <span>${m(u.startTime)}</span>
                            </div>
                            ${u.endTime!==""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                        </svg>
                                    </span>
                                    <span>${m(u.endTime)}</span>
                                </div>`:""} `} `}(u.type==="stop"||u.type==="checkin")&&(s=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                <span>${u.address}</span>
                            </div>
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                </span>
                                <span>${m(u.startTime)}</span>
                            </div>
                            ${u.endTime!=""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                    </span>
                                    <span>${m(u.endTime)}</span>
                                </div>`:""}`),d.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!0,anchor:"bottom",focusAfterOpen:!1}).setLngLat(u.coordinates).setHTML(s).setOffset([0,-20]).addTo(c)}}return()=>{try{d.current&&d.current.remove(),c&&(c.setPaintProperty("ek-tracking-his-LineString","line-color",a.route.lineCorlor),c.setPaintProperty("ek-tracking-his-LineString","line-opacity",a.route.lineOpacity),c.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),c.getSource("RouteHistory")&&(c.removeLayer("RouteHistory"),c.removeLayer("RouteHistory-arrow"),c.removeSource("RouteHistory")))}catch(P){console.log(P)}}},[r]);function m(s){if(s||s!=""){const P=new Date(s);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(P)}else return"Không có thông tin"}const q=s=>{if(s){const P=new Date(s.loc1.time);P.setHours(P.getHours());const u=P.getDate(),O=P.getMonth()+1,V=P.getFullYear(),R=P.getHours(),Z=P.getMinutes(),z=`${u}/${O}/${V}`,y=`${R.toString().padStart(2,"0")}:${Z.toString().padStart(2,"0")}`;w({date:z,time:y,speed:Math.ceil(s.computed.speed*10)/10})}else w({date:null,time:null,speed:0})};return t.jsx(t.Fragment,{children:t.jsxs("div",{ref:n,id:"ekmap-tracking-his-map",children:[x.ready!==!1&&t.jsx(Qt,{map:c,segmentData:x.Data,options:x.options,Animation:H,currentInfo:q}),t.jsx(Zt,{}),f.date!==null&&f.time!==null&&t.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[t.jsxs(ue,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:f.date}),t.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:f.time})]}),t.jsxs(ue,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),t.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[f.speed," km/h"]})]})]})]})})}function ti({employee:e}){const[i,r]=l.useState(new Date("03-29-2024")),[n,o]=l.useState(se(new Date("03-29-2024").setHours(0,0,0).toString())),[c,g]=l.useState(se(new Date("03-29-2024").setHours(24,0,0).toString())),[x,S]=l.useState(""),[f,w]=l.useState([]),[k,T]=l.useState(""),M=a=>{setTimeout(()=>{r(a),o(se(fe(a).today)),g(se(fe(a).nextday))},200)},[H,$]=l.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:c}),d=async a=>{let C=await re.get("/api/method/mbw_dms.api.user.get_list_employees");if(C.message=="Thành công"){let N=C.result.map(function(m){return{value:m.name,label:m.employee_name}});w(N)}},I=async(a,C)=>{$(N=>({...N,objectId:C.object_id})),S(`${C.label} - ${a}`)};return l.useEffect(()=>{(async()=>{if(e==null||e==""){const a=await re.get("/api/method/mbw_dms.api.user.get_projectID");$(C=>({...C,projectId:a.result["Project ID"],objectId:""})),d(a.result["Project ID"]);return}try{const a=await re.get("/api/method/mbw_dms.api.user.get_projectID");console.log(a),$(N=>({...N,projectId:a.result["Project ID"],objectId:e})),d(a.result["Project ID"]),console.log(H);const C=await re.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${e}`);C.message=="Thành công"&&C.result.length>0&&(S(C.result[0].employee_name),T(C.result[0].name))}catch(a){De.error(a?.message||"Something was wrong!!!")}})()},[e]),l.useEffect(()=>{(async()=>$(a=>({...a,from_time:n,to_time:c})))()},[n,c]),t.jsxs(t.Fragment,{children:[t.jsx(Ve,{title:t.jsxs("div",{className:"flex items-center",children:[t.jsxs(Ee,{to:"/employee-monitor",children:[" ",t.jsx(Ht,{})]}),t.jsx("span",{className:"ml-4",children:x})]}),customButton:t.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(We,{defaultValue:_e(i),format:"DD-MM-YYYY",onChange:M})}),customSlect:t.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(Se,{defaultValue:k,style:{width:150},onChange:I,options:f})})}),t.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:t.jsx("div",{id:"travel",className:"relative",children:H.projectId&&t.jsx(Gt,{options:H})})})]})}function ii(){l.useState("list");const{employee_id:e}=Re();return t.jsx(t.Fragment,{children:t.jsx(ti,{employee:e})})}function ci(){return t.jsxs(t.Fragment,{children:[t.jsx(Ae,{children:t.jsx("title",{children:" EmployeeMonitor Detail"})}),t.jsx(ii,{})]})}export{ci as default};
