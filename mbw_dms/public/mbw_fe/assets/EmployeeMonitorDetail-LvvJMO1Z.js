import{ad as Y,ag as Ne,ah as Le,ax as ye,aj as be,bH as we,ak as Pe,ai as _e,h as _,W as m,av as Re,aK as Me,bw as Ae,bk as We,ap as he,ac as fe,L as t,R as ve,P as Z,af as ie,Q as me,a3 as ze,bI as Ve,aT as ne,a1 as ge,a0 as qe,bC as Ge,bJ as Ze,a7 as Ye,bB as Ue,b3 as Xe,a8 as Ke}from"./index-RGOXgH6R.js";import{D as Je}from"./date-picker-sezwgTfI.js";import{a as pe,T as Ce}from"./index-0nCdV72N.js";import{H as Qe}from"./header-page-3esrL7Ru.js";import{W as re,c as et,d as V,r as tt,l as it,p as J,f as je,s as nt,g as $e,e as rt,b as at}from"./WrapperCard-zz5W3Aap.js";import"./index-9JoAzA46.js";const Ie=["wrap","nowrap","wrap-reverse"],Ee=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],Fe=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],st=(e,i)=>{const r={};return Ie.forEach(n=>{r[`${e}-wrap-${n}`]=i.wrap===n}),r},ot=(e,i)=>{const r={};return Fe.forEach(n=>{r[`${e}-align-${n}`]=i.align===n}),r[`${e}-align-stretch`]=!i.align&&!!i.vertical,r},lt=(e,i)=>{const r={};return Ee.forEach(n=>{r[`${e}-justify-${n}`]=i.justify===n}),r};function ct(e,i){return Y(Object.assign(Object.assign(Object.assign({},st(e,i)),ot(e,i)),lt(e,i)))}const dt=e=>{const{componentCls:i}=e;return{[i]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},mt=e=>{const{componentCls:i}=e;return{[i]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},gt=e=>{const{componentCls:i}=e,r={};return Ie.forEach(n=>{r[`${i}-wrap-${n}`]={flexWrap:n}}),r},pt=e=>{const{componentCls:i}=e,r={};return Fe.forEach(n=>{r[`${i}-align-${n}`]={alignItems:n}}),r},ut=e=>{const{componentCls:i}=e,r={};return Ee.forEach(n=>{r[`${i}-justify-${n}`]={justifyContent:n}}),r},ht=()=>({}),ft=Ne("Flex",e=>{const{paddingXS:i,padding:r,paddingLG:n}=e,o=Le(e,{flexGapSM:i,flexGap:r,flexGapLG:n});return[dt(o),mt(o),gt(o),pt(o),ut(o)]},ht,{resetStyle:!1});var xt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const yt=ye.forwardRef((e,i)=>{const{prefixCls:r,rootClassName:n,className:o,style:v,flex:h,gap:f,children:d,vertical:u=!1,component:p="div"}=e,c=xt(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:b,direction:O,getPrefixCls:$}=ye.useContext(be),a=$("flex",r),[F,M,z]=ft(a),E=u??b?.vertical,y=Y(o,n,b?.className,a,M,z,ct(a,e),{[`${a}-rtl`]:O==="rtl",[`${a}-gap-${f}`]:we(f),[`${a}-vertical`]:E}),l=Object.assign(Object.assign({},b?.style),v);return h&&(l.flex=h),f&&!we(f)&&(l.gap=f),F(ye.createElement(p,Object.assign({ref:i,className:y,style:l},Pe(c,["justify","wrap","align"])),d))}),ke=yt,vt=e=>{const{componentCls:i,calc:r}=e;return{[i]:Object.assign(Object.assign({},_e(e)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:r(r(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${_(e.itemHeadSize)})`,borderInlineStart:`${_(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${_(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:r(e.itemHeadSize).div(2).equal(),insetInlineStart:r(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:r(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:r(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:r(e.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${_(e.marginXXS)})`,width:`calc(50% - ${_(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${_(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${_(r(r(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${_(r(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${_(e.margin)})`,borderInlineStart:`${_(e.tailWidth)} dotted ${e.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${_(e.margin)})`,borderInlineStart:`${_(e.tailWidth)} dotted ${e.tailColor}`},[`${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${_(e.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${_(e.marginSM)})`,width:`calc(50% - ${_(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},jt=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),kt=Ne("Timeline",e=>{const i=Le(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[vt(i)]},jt);var bt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const St=e=>{var{prefixCls:i,className:r,color:n="blue",dot:o,pending:v=!1,position:h,label:f,children:d}=e,u=bt(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:p}=m.useContext(be),c=p("timeline",i),b=Y(`${c}-item`,{[`${c}-item-pending`]:v},r),O=/blue|red|green|gray/.test(n||"")?void 0:n,$=Y(`${c}-item-head`,{[`${c}-item-head-custom`]:!!o,[`${c}-item-head-${n}`]:!O});return m.createElement("li",Object.assign({},u,{className:b}),f&&m.createElement("div",{className:`${c}-item-label`},f),m.createElement("div",{className:`${c}-item-tail`}),m.createElement("div",{className:$,style:{borderColor:O,color:O}},o),m.createElement("div",{className:`${c}-item-content`},d))},Be=St;var Te=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const wt=e=>{var{prefixCls:i,className:r,pending:n=!1,children:o,items:v,rootClassName:h,reverse:f=!1,direction:d,hashId:u,pendingDot:p,mode:c=""}=e,b=Te(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const O=(l,S)=>c==="alternate"?l==="right"?`${i}-item-right`:l==="left"?`${i}-item-left`:S%2===0?`${i}-item-left`:`${i}-item-right`:c==="left"?`${i}-item-left`:c==="right"?`${i}-item-right`:l==="right"?`${i}-item-right`:"",$=Re(v||[]),a=typeof n=="boolean"?null:n;n&&$.push({pending:!!n,dot:p||m.createElement(Me,null),children:a}),f&&$.reverse();const F=$.length,M=`${i}-item-last`,z=$.filter(l=>!!l).map((l,S)=>{var H;const R=S===F-2?M:"",G=S===F-1?M:"",{className:Q}=l,ee=Te(l,["className"]);return m.createElement(Be,Object.assign({},ee,{className:Y([Q,!f&&n?R:G,O((H=l?.position)!==null&&H!==void 0?H:"",S)]),key:l?.key||S}))}),E=$.some(l=>!!l?.label),y=Y(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!f,[`${i}-${c}`]:!!c&&!E,[`${i}-label`]:E,[`${i}-rtl`]:d==="rtl"},r,h,u);return m.createElement("ul",Object.assign({},b,{className:y}),z)},Ct=wt;function $t(e,i){return e&&Array.isArray(e)?e:Ae(i).map(r=>{var n,o;return Object.assign({children:(o=(n=r?.props)===null||n===void 0?void 0:n.children)!==null&&o!==void 0?o:""},r.props)})}var Tt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)i.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};const He=e=>{const{getPrefixCls:i,direction:r,timeline:n}=m.useContext(be),{prefixCls:o,children:v,items:h,className:f,style:d}=e,u=Tt(e,["prefixCls","children","items","className","style"]),p=i("timeline",o),c=We(p),[b,O,$]=kt(p,c),a=$t(h,v);return b(m.createElement(Ct,Object.assign({},u,{className:Y(n?.className,f,$,c),style:Object.assign(Object.assign({},n?.style),d),prefixCls:p,direction:r,items:a,hashId:O})))};He.Item=Be;const Nt=He;var Lt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const Mt=Lt;var zt=function(i,r){return m.createElement(he,fe({},i,{ref:r,icon:Mt}))};const It=m.forwardRef(zt);var Et={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const Ft=Et;var Bt=function(i,r){return m.createElement(he,fe({},i,{ref:r,icon:Ft}))};const Ht=m.forwardRef(Bt);var Dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const Ot=Dt;var Pt=function(i,r){return m.createElement(he,fe({},i,{ref:r,icon:Ot}))};const _t=m.forwardRef(Pt);var Rt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const At=Rt;var Wt=function(i,r){return m.createElement(he,fe({},i,{ref:r,icon:At}))};const Vt=m.forwardRef(Wt),qt=({size:e=16})=>t.jsx("svg",{width:e,height:e+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function Gt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function Zt({data:e}){return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_start})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Yt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function Ut({data:e}){return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_end})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Xt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function Kt({data:e}){return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_checking})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.retail_name})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Jt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function Qt({data:e}){return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_moving})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),t.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[e.total_distance," Trip"]})]})]})}function ei(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function ti({data:e}){return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_stop})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function ii({options:e}){const[i,r]=m.useState([]);m.useEffect(()=>{let d=[];if(e.details!=null)for(let u=0;u<e.details.length;u++){let p=e.details[u];p.type=="start"?d.push({dot:t.jsx(Gt,{}),children:t.jsx(Zt,{data:{time_start:f(p.timestamp),address:p.address}})}):p.type=="checkin"?d.push({dot:t.jsx(Xt,{}),children:t.jsx(Kt,{data:{time_checking:`${f(p.startTime)} - ${f(p.endTime)}`,retail_name:p.storeName,address:p.address,total_time:`${n(p.startTime,p.endTime)}`}})}):p.type=="move"?d.push({dot:t.jsx(Jt,{}),children:t.jsx(Qt,{data:{time_moving:`${f(p.startTime)} - ${f(p.endTime)}`,total_distance:`${o(p.distance)}`,total_time:`${n(p.startTime,p.endTime)}`}})}):p.type=="stop"?d.push({dot:t.jsx(ei,{}),children:t.jsx(ti,{data:{time_stop:`${f(p.startTime)} - ${f(p.endTime)}`,address:p.address,total_time:`${n(p.startTime,p.endTime)}`}})}):p.type=="end"&&d.push({dot:t.jsx(Yt,{}),children:t.jsx(Ut,{data:{time_end:`${f(p.timestamp)}`,address:p.address}})})}r(d)},[e]);const n=(d,u)=>{const p=new Date(d),b=new Date(u)-p;if(console.log(b),b<6e4)return`${Math.round(b/1e3)} giây`;if(b>=6e4&&b<6e4*60)return`${Math.round(b/6e4)} phút`;{const O=Math.floor(b/36e5),$=Math.floor(b%(1e3*60*60)/(1e3*60));return`${O} giờ ${$} phút`}},o=d=>d<1e3?`${Math.round(d)} m`:`${Math.round(d/1e3)} km`,v=d=>d<60?`${Math.round(d)} giây`:d>=60&&d<3600?`${Math.round(d/60)} phút`:`${Math.round(d/3600)} giờ`,h=d=>Math.round(d*3.6),f=d=>{var u=new Date(d);return u.setUTCHours(u.getUTCHours()+7),`${u.getUTCHours()}:${u.getUTCMinutes()}`};return t.jsxs(t.Fragment,{children:[t.jsxs(ve,{gutter:20,children:[t.jsx(Z,{span:4,className:"card-container",children:t.jsx(re,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),e.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&o(e.summary.move.distance)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),t.jsx(Z,{span:4,className:"card-container",children:t.jsx(re,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),e.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&v(e.summary.move.totalTime)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),t.jsx(Z,{span:4,className:"card-container",children:t.jsx(re,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),e.summary!=null?t.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[e.summary&&h(e.summary.move.avgSpeed)," km/h"]}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),t.jsx(Z,{span:6,className:"card-container",children:t.jsx(re,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[t.jsxs("div",{style:{marginRight:"40px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&e.summary.stop.count?e.summary.stop.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&v(e.summary.stop.totalTime)?v(e.summary.stop.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})}),t.jsx(Z,{span:6,className:"card-container",children:t.jsx(re,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[t.jsxs("div",{style:{marginRight:"13px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&e.summary.checkin.count?e.summary.checkin.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:e.summary&&v(e.summary.checkin.totalTime)?v(e.summary.checkin.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})})]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(ve,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:t.jsx(et,{children:t.jsxs(ve,{children:[t.jsxs(Z,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[t.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),t.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?t.jsx(Nt,{mode:"left",items:i}):t.jsx("div",{children:"Chưa có lộ trình"})})]}),t.jsx(Z,{span:18,style:{height:"615px"},children:t.jsx(di,{options:e})})]})})})})]})}function ni(){const[e,i]=m.useState(!1),r=()=>{i(!e)},n={iconStart:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",iconEnd:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",iconCheckin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",iconStop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"};return t.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[t.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:r,children:[t.jsx("span",{className:`icon ${e?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),t.jsx("span",{children:"Chú giải bản đồ"})]}),t.jsx("div",{className:`ekmapplf_tracking-legend-body ${e?"open":""}`,style:{maxHeight:e?"none":"0"},children:t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStart})`}}),"Vị trí bắt đầu"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconEnd})`}}),"Vị trí kết thúc"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconCheckin})`}}),"Vị trí khách hàng"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStop})`}}),"Vị trí điểm dừng"]})]})})]})}function ae(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ri(e){return e.type==="Feature"?e.geometry:e}function De(e,i,r){r===void 0&&(r={});var n=ae(e),o=ae(i),v=V(o[1]-n[1]),h=V(o[0]-n[0]),f=V(n[1]),d=V(o[1]),u=Math.pow(Math.sin(v/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(f)*Math.cos(d);return tt(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),r.units)}function ai(e,i,r,n){n===void 0&&(n={});var o=ae(e),v=V(o[0]),h=V(o[1]),f=V(r),d=it(i,n.units),u=Math.asin(Math.sin(h)*Math.cos(d)+Math.cos(h)*Math.sin(d)*Math.cos(f)),p=v+Math.atan2(Math.sin(f)*Math.sin(d)*Math.cos(h),Math.cos(d)-Math.sin(h)*Math.sin(u)),c=je(p),b=je(u);return J([c,b],n.properties)}function Se(e,i,r){if(r===void 0&&(r={}),r.final===!0)return si(e,i);var n=ae(e),o=ae(i),v=V(n[0]),h=V(o[0]),f=V(n[1]),d=V(o[1]),u=Math.sin(h-v)*Math.cos(d),p=Math.cos(f)*Math.sin(d)-Math.sin(f)*Math.cos(d)*Math.cos(h-v);return je(Math.atan2(u,p))}function si(e,i){var r=Se(i,e);return r=(r+180)%360,r}function oi(e,i,r){r===void 0&&(r={});for(var n=ri(e),o=n.coordinates,v=0,h=0;h<o.length&&!(i>=v&&h===o.length-1);h++)if(v>=i){var f=i-v;if(f){var d=Se(o[h],o[h-1])-180,u=ai(o[h],f,d,r);return u}else return J(o[h])}else v+=De(o[h],o[h+1],r);return J(o[o.length-1])}function li(e,i){return i===void 0&&(i={}),nt(e,function(r,n){var o=n.geometry.coordinates;return r+De(o[0],o[1],i)},0)}const ci=({_map:e,segmentData:i,options:r,currentInfo:n})=>{const o=m.useRef(null),v=m.useRef(null),[h,f]=m.useState(r.animation.follow),[d,u]=m.useState(!1),[p,c]=m.useState(10),[b,O]=m.useState(!0),$=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[a,F]=m.useState(!0),M=m.useRef(0),z=m.useRef(0),E=m.useRef([]),y=m.useRef(e);var l=y.current.getContainer();function S(j,L){z.current=j;const x=L[j];if(!x){if(b){z.current=0,E.current=[];try{y.current&&y.current.getSource("LocationHistory")&&y.current.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(I){u(!1),console.log(I)}i.length&&i[0].computed.time&&(v.current=setTimeout(S.bind(this),1e3,z.current,i))}else z.current=j-1,oe();n(L[z.current]);return}if(n(x),x.computed.time){let I=x.computed.time*1e3/p;if(x.computed.speed){let W=function(le){T||(N=x.loc1.loc,T=le);const xe=(le-T)/(Number(x.computed.time?.toString())*1e3/p);if(!(xe>1||!d)){var k=$e([x.loc1.loc,x.loc2.loc]),s=li(k),C=oi(k,s*xe).geometry.coordinates,g=Se(J(N),J(C));N[0]!==C[0]&&N[1]!==C[1]&&(M.current=g),N=C,E.current=E.current.concat([C]);try{y.current&&h&&y.current.panTo(C,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:M.current}),y.current&&y.current.getSource("locationMarker")&&y.current.getSource("locationMarker").setData({type:"FeatureCollection",features:[J(C,{bearing:M.current})]}),y.current&&E.current.length>1&&y.current.getSource("LocationHistory")&&y.current.getSource("LocationHistory").setData({type:"FeatureCollection",features:[$e(E.current)]}),o.current=window.requestAnimationFrame(W)}catch(D){u(!1),console.log(D)}}};var T,N;o.current=window.requestAnimationFrame(W)}j++,E.current=L.slice(0,j).map(W=>W.loc1.loc),v.current=setTimeout(S.bind(this),I,j,L)}}m.useEffect(()=>{u(!1),o.current&&cancelAnimationFrame(o.current),v.current&&clearTimeout(v.current),z.current=0,i.length&&r.animation.animate&&u(!0)},[e,i,r]),m.useEffect(()=>{if(d){z.current===0&&(E.current=[],y.current.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})),i.length&&i[0].computed.time&&(v.current=setTimeout(S.bind(void 0),500,z.current,i));try{y.current.setPaintProperty(`ek-tracking-his-${l.id}-LineString`,"line-color","#b5b5b5"),y.current.setPaintProperty(`ek-tracking-his-${l.id}-LineString`,"line-opacity",.5),y.current.setLayoutProperty(`ek-tracking-his-${l.id}-LineString-arrow`,"visibility","none"),y.current.setLayoutProperty(`ek-tracking-his-${l.id}-LineString`,"visibility","none"),y.current.setLayoutProperty("locationMarker","visibility","visible"),y.current.setLayoutProperty("LocationHistory","visibility","visible")}catch(j){console.log(j)}}else{n(null),o.current&&cancelAnimationFrame(o.current);try{y.current.setPaintProperty(`ek-tracking-his-${l.id}-LineString`,"line-color",r.route.lineCorlor),y.current.setPaintProperty(`ek-tracking-his-${l.id}-LineString`,"line-opacity",r.route.lineOpacity),y.current.setLayoutProperty(`ek-tracking-his-${l.id}-LineString`,"visibility","visible"),y.current.setLayoutProperty(`ek-tracking-his-${l.id}-LineString-arrow`,"visibility","visible"),y.current.setLayoutProperty("locationMarker","visibility","none"),y.current.setLayoutProperty("LocationHistory","visibility","none")}catch(j){console.log(j)}}return()=>{o.current&&cancelAnimationFrame(o.current),v.current&&clearTimeout(v.current)}},[d,p,h,b]);const[H,R]=m.useState(r.animation.animate);m.useEffect(()=>{const j=()=>{F(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",j),()=>{document.removeEventListener("visibilitychange",j)}},[]),m.useEffect(()=>{a?H===r.animation.animate?u(!0):u(!1):(R(d),u(!1))},[a]);const G=j=>{c(j)},Q=j=>{j.target.checked&&y.current.setZoom(17),f(!h)},ee=()=>{u(!0)},se=()=>{u(!1)},oe=()=>{se();try{y.current.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),y.current.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),y.current.panTo(i[0].loc1.loc)}catch(j){console.log(j)}z.current=0},w=()=>{O(!b)};return t.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:t.jsxs(ke,{gap:"small",align:"center",justify:"center",children:[t.jsx(ie,{title:"Play",children:t.jsx(me,{icon:t.jsx(Ht,{}),disabled:d,onClick:ee})}),t.jsx(ie,{title:"Pause",children:t.jsx(me,{icon:t.jsx(_t,{}),disabled:!d,onClick:se})}),t.jsx(ie,{title:"Stop",children:t.jsx(me,{icon:t.jsx(It,{}),onClick:oe})}),t.jsx(ie,{title:"Replay",children:t.jsx(me,{type:b?"primary":"default",icon:t.jsx(Vt,{}),onClick:w})}),t.jsx(ie,{title:"Speed",children:t.jsx(ze,{defaultValue:p,style:{width:"75px"},onChange:G,options:$})}),t.jsx(Ve,{onChange:Q,checked:h,children:"Theo dõi lộ trình"})]})})},ue=window.ekmapplf;function di({options:e,onLoad:i}){const r=m.useRef(null),n=m.useState(null),[o,v]=m.useState({map:null,Data:[],options:null}),[h,f]=m.useState({date:null,time:null,speed:0}),d=m.useRef(null),u=m.useRef(null);m.useRef(null);const c=rt({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{track:"https://files.ekgis.vn/sdks/tracking/assets/custom_marker.png",navigation:"https://files.ekgis.vn/sdks/tracking/assets/arrow.png",checkin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",start:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",end:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",stop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"},route:{visible:!0,lineCorlor:"#01579B",lineWidth:4,lineOpacity:.8},animation:{follow:!0,animate:!0}},e),b=()=>{try{let y=function(){var w={type:"FeatureCollection",features:[]};a.getSource("LocationHistory")?a.getSource("LocationHistory").setData(w):(a.addSource("LocationHistory",{type:"geojson",data:w}),a.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":c.route.lineCorlor,"line-width":c.route.lineWidth,"line-opacity":c.route.lineOpacity}}))};var $;n.current&&(n.animation_current&&cancelAnimationFrame(n.animation_current),n.timeout_current&&clearTimeout(n.timeout_current),n.current.remove()),n.current=new ne.Map({container:r.current,center:c.center,zoom:c.zoom,minZoom:1});var a=n.current;const l=a.getContainer();a.setPadding({top:100,bottom:100,left:100,right:100}),new ue.VectorBaseMap("OSM:Bright",c.apiKey).addTo(a);var F=new ue.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+l.id,baseLayers:[{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});a.addControl(F,"bottom-left"),F.on("changeBaseLayer",async function(w){await new ue.VectorBaseMap(w.layer,c.apiKey).addTo(a),setTimeout(()=>{H(c.from_time,c.to_time,c.pageNumber,c.pageSize)},500)}),a.addControl(new ne.NavigationControl({visualizePitch:!0}),"bottom-right");var M=!1;a.getPitch()>0?M=!0:M=!1;var z="maplibregl-terrain2d-control",E="Hiển thị 2D";M||(z="maplibregl-terrain3d-control",E="Bản đồ 3D");let S=new ue.control.Button({className:"btn-ctl-group "+z,icon:"none",tooltip:E});S.on("click",w=>{M=!M,M?(w._div.className=w._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),w._div.title="Hiển thị 2D"):(w._div.className=w._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),w._div.title="Hiển thị 3D"),M?(a.easeTo({pitch:60}),a.setLayoutProperty("building-3d","visibility","visible")):(a.easeTo({pitch:0}),a.setLayoutProperty("building-3d","visibility","none"))}),a.addControl(S,"bottom-right"),a.addControl(new ne.FullscreenControl,"top-right"),a.on("load",()=>{try{if(!c.objectId||c.objectId===""||c.objectId==="null"||!c.from_time||c.from_time===""||c.from_time==="null"||!c.to_time||c.to_time===""||c.to_time==="null")return;H(c.from_time,c.to_time,c.pageNumber,c.pageSize)}catch(w){console.error("Error:",w)}});const H=async(w,j,L,x)=>{let T=await R(w,j,L,x);await G(T);let N=await oe(T);T.length&&T[0].coordinates&&a.easeTo({center:T[0].coordinates,duration:100,zoom:16}),setTimeout(()=>v({map:n.current,Data:N,options:c}),200),i(T)},R=async(w,j,L,x)=>{let T=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${c.projectId}/${c.objectId}?api_key=${c.apiKey}&from_time=${w}&to_time=${j}`;var W=(await(await fetch(T)).json()).details;return W||[]},G=async w=>{let j={type:"FeatureCollection",features:[]},L={type:"FeatureCollection",features:[]},x={type:"FeatureCollection",features:[]};if(w.forEach(N=>{const I={type:"Feature",properties:N.type!=="move"?N:{},geometry:N.type==="move"?N.route.geometry:{type:"Point",coordinates:N.coordinates}};j.features.push(I),N.type!=="move"&&(N.type==="checkin"?L.features.push(I):x.features.push(I))}),w.length){var T=at(j);a.fitBounds(T,{padding:100,maxZoom:14,duration:1e3})}await Q(j),await ee(L,x),await y(),await se()},Q=w=>{try{if(!a.getImage("icon_arrow")){var j='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',L=new Image;L.onload=function(){a.hasImage("icon_arrow")||a.addImage("icon_arrow",L)},L.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(j)}a.getSource(`ek-tracking-his-${l.id}-line-source`)?a.getSource(`ek-tracking-his-${l.id}-line-source`).setData(w):(a.addSource(`ek-tracking-his-${l.id}-line-source`,{type:"geojson",data:w}),a.addLayer({id:`ek-tracking-his-${l.id}-LineString`,type:"line",source:`ek-tracking-his-${l.id}-line-source`,layout:{"line-join":"round","line-cap":"round",visibility:c.route.visible?"visible":"none"},paint:{"line-color":c.route.lineCorlor,"line-width":c.route.lineWidth,"line-opacity":c.route.lineOpacity},filter:["==","$type","LineString"]}),a.addLayer({id:`ek-tracking-his-${l.id}-LineString-arrow`,type:"symbol",source:`ek-tracking-his-${l.id}-line-source`,layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}))}catch(x){console.error("Error setLine:",x)}},ee=async(w,j)=>{try{let L=function(x){if(x||x!=""){const T=new Date(x);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(T)}else return"Không có thông tin"};if(!a.getImage("marker-start")){const x=await a.loadImage(c.icon.start);a.addImage("marker-start",x.data)}if(!a.getImage("marker-end")){const x=await a.loadImage(c.icon.end);a.addImage("marker-end",x.data)}if(!a.getImage("marker-check")){const x=await a.loadImage(c.icon.checkin);a.addImage("marker-check",x.data)}if(!a.getImage("marker-stop")){const x=await a.loadImage(c.icon.stop);a.addImage("marker-stop",x.data)}a.getSource(`ek-tracking-his-${l.id}-track-source`)?a.getSource(`ek-tracking-his-${l.id}-track-source`).setData(j):(a.addSource(`ek-tracking-his-${l.id}-track-source`,{type:"geojson",data:j}),a.addLayer({id:`ek-tracking-his-${l.id}-track-point`,type:"symbol",source:`ek-tracking-his-${l.id}-track-source`,layout:{"icon-image":["match",["get","type"],"start","marker-start","end","marker-end","marker-stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),a.on("mouseenter",`ek-tracking-his-${l.id}-track-point`,x=>{a.getCanvas().style.cursor="pointer";const T=[[x.point.x-5,x.point.y-5],[x.point.x+5,x.point.y+5]];let I=a.queryRenderedFeatures(T,{layers:[`ek-tracking-his-${l.id}-track-point`]})[0],W="default";I.properties.type!="stop"&&(W=I.properties.type),$&&$.remove(),$=new ne.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(I.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${W}-color"></span>
                                            <span>${I.properties.address}</span>
                                        </div>
                                        ${I.properties.type!=="stop"?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${W}-color"></span>
                                                <span>${L(I.properties.timestamp)}</span>
                                            </div>`:`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                    </svg>
                                                </span>
                                                <span>${L(I.properties.startTime)}</span>
                                            </div>
                                            ${I.properties.endTime!==""?`
                                                <div class="ek-tracking-his-popup-info">
                                                    <span class="ek-tracking-his-popup-icon">
                                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                        </svg>
                                                    </span>
                                                    <span>${L(I.properties.endTime)}</span>
                                                </div>`:""} `}
                                    `).setOffset([0,-20]).addTo(a)}),a.on("mouseleave",`ek-tracking-his-${l.id}-track-point`,()=>{a.getCanvas().style.cursor="",$&&$.remove()})),a.getSource(`ek-tracking-his-${l.id}-check-source`)?a.getSource(`ek-tracking-his-${l.id}-check-source`).setData(w):(a.addSource(`ek-tracking-his-${l.id}-check-source`,{type:"geojson",data:w,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),a.addLayer({id:`ek-tracking-his-${l.id}-check-clusters`,type:"circle",source:`ek-tracking-his-${l.id}-check-source`,paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),a.addLayer({id:`ek-tracking-his-${l.id}-check-cluster-count`,type:"symbol",source:`ek-tracking-his-${l.id}-check-source`,layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),a.addLayer({id:`ek-tracking-his-${l.id}-check-point`,type:"symbol",source:`ek-tracking-his-${l.id}-check-source`,layout:{"icon-image":"marker-check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),a.on("mouseenter",`ek-tracking-his-${l.id}-check-clusters`,()=>{a.getCanvas().style.cursor="pointer"}),a.on("mouseleave",`ek-tracking-his-${l.id}-check-clusters`,()=>{a.getCanvas().style.cursor=""}),a.on("click",`ek-tracking-his-${l.id}-check-clusters`,async x=>{const T=a.queryRenderedFeatures(x.point,{layers:[`ek-tracking-his-${l.id}-check-clusters`]}),N=T[0].properties.cluster_id,I=await a.getSource(`ek-tracking-his-${l.id}-check-source`).getClusterExpansionZoom(N);a.easeTo({center:T[0].geometry.coordinates,zoom:I})}),a.on("mouseenter",`ek-tracking-his-${l.id}-check-point`,x=>{a.getCanvas().style.cursor="pointer";const T=[[x.point.x-5,x.point.y-5],[x.point.x+5,x.point.y+5]],N=a.queryRenderedFeatures(T,{layers:[`ek-tracking-his-${l.id}-check-point`]});$&&$.remove(),$=new ne.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(N[0].geometry.coordinates).setHTML(`<div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${N[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${L(N[0].properties.startTime)}</span>
                                </div>
                                ${N[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${L(N[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(a)}),a.on("mouseleave",`ek-tracking-his-${l.id}-check-point`,()=>{a.getCanvas().style.cursor="",$&&$.remove()}))}catch(L){console.error("Error setPoints:",L)}};async function se(){if(!a.getImage("marker-navigation")){const j=await a.loadImage(c.icon.navigation);a.addImage("marker-navigation",j.data)}var w={type:"FeatureCollection",features:[]};a.getSource("locationMarker")?a.getSource("locationMarker").setData(w):(a.addSource("locationMarker",{type:"geojson",data:w}),a.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker-navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}const oe=async w=>{var j,L,x,T={type:"FeatureCollection",features:[]};return w.forEach(k=>{if(k.type==="move")for(let s=0;s<k.route.locations.length;s++){let C=k.route.locations[s];if(new Date(C.timestamp).getTime()>=new Date(k.startTime).getTime()&&new Date(C.timestamp).getTime()<=new Date(k.endTime).getTime()){let g={type:"Feature",properties:{time:C.timestamp,ele:0,type:k.type},geometry:{type:"Point",coordinates:C.coordinates}};T.features.push(g)}}else if(k.type==="stop"||k.type==="checkin"){let s={type:"Feature",properties:{time:k.startTime,ele:0,type:k.type},geometry:{type:"Point",coordinates:k.coordinates}},C={type:"Feature",properties:{time:k.endTime,ele:0,type:k.type},geometry:{type:"Point",coordinates:k.coordinates}};T.features.push(s,C)}else{let s={type:"Feature",properties:{time:k.timestamp,ele:0,type:k.type},geometry:{type:"Point",coordinates:k.coordinates}};T.features.push(s)}}),j=N(T),L=I(j),L||[];function N(k){var s={segments:[],id:e.objectId};let C=[];s.segments.push(C);for(let D=0;D<k.features.length;D++){var g=k.features[D];let P={loc:g.geometry.coordinates,time:new Date(g.properties.time).getTime(),ele:g.properties.ele};C.push(P)}return s}function I(k){const s=[];for(let ce=0;ce<k.segments.length;ce++){const te=k.segments[ce];for(let U=1;U<te.length;U++){const A=te[U-1],B=te[U];var C=A.time,g=B.time,D=new Date(C),P=new Date(g);let X=0;D.getDate()===P.getDate()&&D.getMonth()===P.getMonth()&&D.getFullYear()===P.getFullYear()&&(X=W(A.loc[1],A.loc[0],B.loc[1],B.loc[0],A.ele,B.ele));const q={computed:{distance:X},loc1:A,loc2:B};if(A.ele&&B.ele&&(q.computed.ele=B.ele),A.time&&B.time&&A.time!==B.time){const{speed:K,time:de}=le(X,A.time,B.time),Oe=K;q.computed.speed=K,q.computed.time=de,q.computed.filteredSpeed=Oe}A.temp&&B.temp&&(q.computed.temp=(A.temp+B.temp)/2),B.hr&&(q.computed.hr=B.hr),B.cad&&(q.computed.cad=B.cad),q.computed.speed&&s.push(q)}}return s}function W(k,s,C,g,D,P){const te=k*Math.PI/180,U=C*Math.PI/180,A=(C-k)*Math.PI/180,B=(g-s)*Math.PI/180,X=Math.sin(A/2)*Math.sin(A/2)+Math.cos(te)*Math.cos(U)*Math.sin(B/2)*Math.sin(B/2);let K=6371e3*(2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X)));if(D!==void 0&&P!==void 0){const de=P-D;de!==0&&(K=Math.sqrt(Math.pow(K,2)+Math.pow(de,2)))}return K}function le(k,s,C){const g=C/1e3-s/1e3;return{speed:(k/g||0)*3.6,time:g}}function xe(k){let s={};s.distance=0;for(let C=0;C<k.length;C++){const g=k[C].computed;let D;if(k[C-1]&&(D=k[C-1].computed),s.distance+=g.distance,g.ele&&(s.maxEle=s.maxEle||0,s.minEle=s.minEle||0,s.gainEle=s.gainEle||0,s.totEle=s.totEle||0,g.ele>s.maxEle&&(s.maxEle=g.ele),g.ele<s.minEle&&(s.minEle=g.ele),D&&D.ele)){let P=g.ele-D.ele;P>0?(s.gainEle+=P,s.totEle+=P):P<0&&(s.totEle+=P)}g.time&&(s.totalTime=s.totalTime||0,s.totalTime+=g.time,g.speed&&g.filteredSpeed&&(s.avgSpeed=s.avgSpeed||0,s.avgMovingSpeed=s.avgMovingSpeed||0,s.movingTime=s.movingTime||0,s.maxSpeed=s.maxSpeed||0,s.avgSpeed+=g.speed*g.time,g.speed>5&&(s.avgMovingSpeed+=g.speed*g.time,s.movingTime+=g.time),g.filteredSpeed>s.maxSpeed&&g.filteredSpeed<200&&(s.maxSpeed=g.filteredSpeed,s.maxSpeedIndex=C)),g.temp&&(s.avgTemp=s.avgTemp||0,s.maxTemp=s.maxTemp||0,s.avgTemp+=g.temp*g.time,g.temp>s.maxTemp&&(s.maxTemp=g.temp)),g.hr&&(s.avgHr=s.avgHr||0,s.maxHr=s.maxHr||0,s.avgHr+=g.hr*g.time,g.hr>s.maxHr&&(s.maxHr=g.hr,s.maxHrIndex=C)),g.cad&&(s.avgCad=s.avgCad||0,s.maxCad=s.maxCad||0,s.avgCad+=g.cad*g.time,g.cad>s.maxCad&&(s.maxCad=g.cad,s.maxCadIndex=C)))}return s.totalTime&&(s.avgSpeed=s.avgSpeed||0,s.avgCad=s.avgCad||0,s.avgHr=s.avgHr||0,s.avgTemp=s.avgTemp||0,s.avgSpeed/=s.totalTime,s.avgCad/=s.totalTime,s.avgHr/=s.totalTime,s.avgTemp/=s.totalTime,s.totalTime/=3600),s.movingTime&&(s.avgMovingSpeed=s.avgMovingSpeed||0,s.avgMovingSpeed/=s.movingTime,s.movingTime/=3600),s}}}catch(y){console.error("Error initializing map:",y)}};m.useEffect(()=>(f({date:null,time:null,speed:0}),v({map:null,Data:[],options:null}),b(),()=>{d.current&&cancelAnimationFrame(d.current),u.current&&clearTimeout(u.current),n.current&&n.current.remove()}),[e]);const O=$=>{if($){const a=new Date($.loc1.time);a.setHours(a.getHours());const F=a.getDate(),M=a.getMonth()+1,z=a.getFullYear(),E=a.getHours(),y=a.getMinutes(),l=`${F}/${M}/${z}`,S=`${E.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`;f({date:l,time:S,speed:Math.ceil($.computed.speed*10)/10})}else f({date:null,time:null,speed:0})};return t.jsx(t.Fragment,{children:t.jsxs("div",{ref:r,id:"ekmap-tracking-his-map",children:[o.map!=null&&t.jsx(ci,{_map:o.map,segmentData:o.Data,options:o.options,currentInfo:O}),t.jsx(ni,{}),h.date!=null&&h.time!=null&&t.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[t.jsxs(ke,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:h.date}),t.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:h.time})]}),t.jsxs(ke,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),t.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[h.speed," km/h"]})]})]})]})})}var mi={VITE_BASE_PATH:"/mbw_desk",VITE_KEY_MAP:"wtpM0U1ZmE2s87LEZNSHf63Osc1a2sboaozCQNsy",VITE_API_KEY:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",BASE_URL:"/assets/mbw_dms/mbw_fe/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function gi({employee:e}){const[i,r]=m.useState(new Date("03-29-2024")),[n,o]=m.useState(pe(new Date("03-29-2024").setHours(0,0,0).toString())),[v,h]=m.useState(pe(new Date("03-29-2024").setHours(24,0,0).toString())),[f,d]=m.useState(""),[u,p]=m.useState([]),[c,b]=m.useState(""),O=l=>{setTimeout(()=>{r(l),o(pe(Ce(l).today)),h(pe(Ce(l).nextday))},200)},[$,a]=m.useState(!0),[F,M]=m.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:v}),z=async(l,S)=>{if(S!=null&&S!=""){let H=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${l}/${S}?from_time=${n}&to_time=${v}&api_key=${F.apiKey}`,R=await Ue.get(H);mi.VITE_BASE_URL&&(R=R.data),console.log("Dữ liệu lịch swr ",R),M(G=>({...G,summary:R?.summary,details:R?.details}))}else M(H=>({...H,summary:{move:{avgSpeed:0,count:0,distance:0,totalTime:0},stop:{count:0,totalTime:0},checkin:{count:0,totalTime:0}},details:[]}))},E=async l=>{let S=await ge.get("/api/method/mbw_dms.api.user.get_list_employees");if(S.message=="Thành công"){let H=S.result.map(function(R){return{value:R.name,label:R.employee_name}});p(H)}},y=async(l,S)=>{M(H=>({...H,objectId:S.object_id})),z(F.projectId,S.object_id),d(`${S.label} - ${l}`)};return m.useEffect(()=>{(async()=>{if(a(!0),e==null||e==""){const l=await ge.get("/api/method/mbw_dms.api.user.get_projectID");M(S=>({...S,projectId:l.result["Project ID"],objectId:""})),E(l.result["Project ID"]),a(!1);return}try{const l=await ge.get("/api/method/mbw_dms.api.user.get_projectID");console.log(l),M(H=>({...H,projectId:l.result["Project ID"],objectId:e})),E(l.result["Project ID"]),z(l.result["Project ID"],emnameployee),console.log(F);const S=await ge.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${e}`);S.message=="Thành công"&&S.result.length>0&&(d(S.result[0].employee_name),b(S.result[0].name)),a(!1)}catch(l){qe.error(l?.message||"Something was wrong!!!")}})()},[e]),m.useEffect(()=>{(async()=>(a(!0),await z(F.projectId,F.objectId),a(!1)))()},[n,v]),t.jsxs(t.Fragment,{children:[$&&t.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(Ge,{indicator:t.jsx(Me,{style:{fontSize:30,color:"#fff"},spin:!0})})}),t.jsx(Qe,{title:t.jsxs("div",{className:"flex items-center",children:[t.jsxs(Ze,{to:"/employee-monitor",children:[" ",t.jsx(qt,{})]}),t.jsx("span",{className:"ml-4",children:f})]}),customButton:t.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(Je,{defaultValue:Ye(i),format:"DD-MM-YYYY",onChange:O})}),customSlect:t.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(ze,{defaultValue:c,style:{width:150},onChange:y,options:u})})}),t.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:t.jsx("div",{id:"travel",className:"relative",children:F.projectId&&t.jsx(ii,{options:F})})})]})}function pi(){m.useState("list");const{employee_id:e}=Xe();return t.jsx(t.Fragment,{children:t.jsx(gi,{employee:e})})}function ji(){return t.jsxs(t.Fragment,{children:[t.jsx(Ke,{children:t.jsx("title",{children:" EmployeeMonitor Detail"})}),t.jsx(pi,{})]})}export{ji as default};
