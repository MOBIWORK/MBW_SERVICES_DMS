import{L as e,bE as s,Y as i,a1 as Y,R as k,P as N,ab as T,V as d,ad as b}from"./index-OI3Ih9_U.js";import{u as M,C as R}from"./index-mxdOabIu.js";import{a as F,u as f,P as g,R as E,F as z,D as P,m as G}from"./ReportHeader-mSyoAtG1.js";import"./index.esm-QGzp8oKP.js";import"./data-u-VkVTNg.js";import"./index-5XffbAo9.js";import"./VerticalAlignBottomOutlined-Qr2Thfny.js";const V=({summaryData:t})=>e.jsxs(s.Summary.Row,{children:[e.jsx(s.Summary.Cell,{index:0}),e.jsx(s.Summary.Cell,{index:1,children:"Tổng"}),e.jsx(s.Summary.Cell,{index:2}),e.jsx(s.Summary.Cell,{index:3}),e.jsx(s.Summary.Cell,{index:4}),e.jsx(s.Summary.Cell,{index:5}),e.jsx(s.Summary.Cell,{index:6}),e.jsx(s.Summary.Cell,{index:7}),e.jsx(s.Summary.Cell,{index:8}),e.jsx(s.Summary.Cell,{index:9}),e.jsx(s.Summary.Cell,{index:10}),e.jsx(s.Summary.Cell,{index:11}),e.jsx(s.Summary.Cell,{index:12}),e.jsx(s.Summary.Cell,{index:13}),e.jsx(s.Summary.Cell,{index:14}),e.jsx(s.Summary.Cell,{index:15,children:e.jsx("div",{className:"text-right",children:t?.sum_checkin})}),e.jsx(s.Summary.Cell,{index:16}),e.jsx(s.Summary.Cell,{index:17}),e.jsx(s.Summary.Cell,{index:18,children:e.jsx("div",{className:"text-right",children:t?.sum_so})}),e.jsx(s.Summary.Cell,{index:19})]}),$=V,A=[{title:"STT",dataIndex:"stt",key:"stt",className:"!text-center",width:60,render:(t,r,n)=>e.jsx("div",{className:"text-center",children:n+1})},{title:"Mã nhân viên",dataIndex:"sales_person_id",key:"sales_person_id"},{title:"Tên nhân viên",dataIndex:"sales_person",key:"sales_person",width:200},{title:"Nhóm bán hàng",dataIndex:"sales_team",key:"sales_team",width:200,render:(t,r)=>e.jsx("div",{className:"whitespace-normal",children:r.sales_team})},{title:"Mã khách hàng",dataIndex:"customer_code",key:"customer_code",render:(t,r)=>e.jsx("div",{children:r.customer_code})},{title:"Tên khách hàng",dataIndex:"customer_name",key:"customer_name",render:(t,r)=>e.jsx("div",{children:r.customer_name})},{title:"Loại khách hàng",dataIndex:"customer_type",key:"customer_type",render:(t,r)=>e.jsx("div",{children:r.customer_type})},{title:"Nhóm khách hàng",dataIndex:"customer_group",key:"customer_group",width:170,render:(t,r)=>e.jsx("div",{className:"truncate hover:whitespace-normal",children:r.customer_group})},{title:"Người liên hệ",dataIndex:"contact",key:"contact",render:(t,r)=>e.jsx("div",{children:r.contact})},{title:"SDT",dataIndex:"phone",key:"phone",render:(t,r)=>e.jsx("div",{children:r.phone})},{title:"Mã số thuế",dataIndex:"tax_id",key:"tax_id",render:(t,r)=>e.jsx("div",{children:r.tax_id})},{title:"Khu vưc",dataIndex:"territory",key:"territory",render:(t,r)=>e.jsx("div",{children:r.territory})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(t,r)=>e.jsx("div",{className:"truncate hover:whitespace-normal",children:r.address})},{title:"Ngày thu thập",dataIndex:"creation",key:"creation",render:(t,r)=>e.jsx("div",{children:d(r.creation*1e3).format("DD/MM/YYYY")})},{title:"Nguồn",dataIndex:"f1",key:"f1",className:"!text-center",render:t=>e.jsx("div",{className:"!text-center",children:t||"-"})},{title:e.jsx("div",{className:"!text-right",children:"Số lần VT"}),dataIndex:"totals_checkin",key:"totals_checkin",render:(t,r)=>e.jsx("div",{className:"!text-right",children:r.totals_checkin})},{title:"VT đầu",dataIndex:"first_checkin",key:"first_checkin",render:t=>t?e.jsx("p",{children:d(t*1e3).format("DD/MM/YYYY")}):e.jsx(e.Fragment,{})},{title:"VT cuối",dataIndex:"last_checkin",key:"last_checkin",render:t=>t?e.jsx("p",{children:d(t*1e3).format("DD/MM/YYYY")}):e.jsx(e.Fragment,{})},{title:e.jsx("div",{className:"!text-right",children:"Số đơn hàng"}),dataIndex:"totals_so",key:"totals_so",render:(t,r)=>e.jsx("div",{className:"!text-right",children:r.totals_so})},{title:"Đơn hàng cuối",dataIndex:"last_sale_order",key:"last_sale_order",render:t=>t?e.jsx("p",{children:d(t*1e3).format("DD/MM/YYYY")}):e.jsx(e.Fragment,{})}];function H(){const[t,r]=i.useState([]),[n,v]=i.useState(0),[S,l]=i.useState(1),w=M(),[D,I]=i.useState(!1),o=F(`${G}`),{startDate:m,endDate:c}=f(a=>a.date),{sales_team:u,employee:x,customer_type:h,customer_group:p,territory:_,has_sales_order:j}=f(a=>a.group);return i.useEffect(()=>{(async()=>{const a=await Y.get("/api/method/mbw_dms.api.report.customer_report.customer_report",{params:{page_size:g,page_number:S,customer_type:h,customer_group:p,territory:_,sales_person:x,sales_team:u,has_sales_order:j,from_date:m,to_date:c}});let{result:y}=a;r({...y,data:y.data?.map(C=>({...C,key:C.cus_id}))}),v(y?.totals_cus)})()},[S,h,p,_,x,j,D,m,c,u]),e.jsx(e.Fragment,{children:e.jsx(R,{header:e.jsx(E,{setRefresh:I,title:"Báo cáo khách hàng mới",params:{report_type:"Report Customer",data_filter:{customer_type:h,customer_group:p,territory:_,sales_person:x,sales_team:u,has_sales_order:j,startDate:m,endDate:c}},file_name:"Report Customer.xlsx"}),children:e.jsxs("div",{className:"bg-white rounded-2xl pt-4 pb-7 border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsxs(k,{gutter:[16,16],className:`flex ${o?"justify-end":"justify-between"} items-center w-full`,children:[!o&&e.jsx(N,{className:"ml-4 w-[78%]",children:e.jsx(k,{gutter:[8,8],className:"space-x-4",children:e.jsx(z,{setPage:l,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0})})}),e.jsx(N,{className:"!ml-4",children:e.jsx(P,{inputCustomerType:!0,inputCustomerGroup:!0,inputTerritory:!0,inputFromDate:!0,inputToDate:!0,inputSaleGroup:!0,inputEmployee:!0,inputOrder:!0,setPage:l,matchMedia:!o})})]}),e.jsx("div",{className:"pt-5",children:e.jsx(T,{dataSource:t?.data,bordered:!0,columns:A,scroll:{x:3e3,y:t?.data?.length>0?w?.h*.55:void 0},pagination:n&&n>g?{pageSize:g,showSizeChanger:!1,total:n,current:t?.page_number,onChange(a){l(a)}}:!1,summary:()=>e.jsx($,{summaryData:t?.sum})})})]})})})}function J(){return e.jsxs(e.Fragment,{children:[e.jsx(b,{children:e.jsx("title",{children:" ReportCustomNew"})}),e.jsx(H,{})]})}export{J as default};
