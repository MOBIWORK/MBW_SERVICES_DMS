import{aj as Y,at as ve,au as ke,ak as ce,ay as ue,bC as he,b3 as Me,aw as ze,h as A,Y as l,ag as Ie,aD as je,br as Fe,bf as Be,a9 as oe,aa as le,L as t,bx as He,R as ae,P as X,az as Q,Q as ie,a5 as be,bD as Pe,aM as J,a3 as ne,aR as De,bE as Oe,V as Ee,aZ as Re,a8 as _e}from"./index-QMghvkd6.js";import{D as Ae}from"./date-picker-zrFEkMGl.js";import{b as re,T as me}from"./index-9YYmqEz2.js";import{W as ee,c as We,d as q,r as Ve,l as qe,p as K,f as de,s as Ge,g as fe,e as Ze,b as xe}from"./WrapperCard-zQq_4bHY.js";import"./index-CT3M8Pvv.js";const Se=["wrap","nowrap","wrap-reverse"],we=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],Ce=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],Xe=(e,i)=>{const r={};return Se.forEach(n=>{r[`${e}-wrap-${n}`]=i.wrap===n}),r},Ye=(e,i)=>{const r={};return Ce.forEach(n=>{r[`${e}-align-${n}`]=i.align===n}),r[`${e}-align-stretch`]=!i.align&&!!i.vertical,r},Ue=(e,i)=>{const r={};return we.forEach(n=>{r[`${e}-justify-${n}`]=i.justify===n}),r};function Je(e,i){return Y(Object.assign(Object.assign(Object.assign({},Xe(e,i)),Ye(e,i)),Ue(e,i)))}const Ke=e=>{const{componentCls:i}=e;return{[i]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},Qe=e=>{const{componentCls:i}=e;return{[i]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},et=e=>{const{componentCls:i}=e,r={};return Se.forEach(n=>{r[`${i}-wrap-${n}`]={flexWrap:n}}),r},tt=e=>{const{componentCls:i}=e,r={};return Ce.forEach(n=>{r[`${i}-align-${n}`]={alignItems:n}}),r},it=e=>{const{componentCls:i}=e,r={};return we.forEach(n=>{r[`${i}-justify-${n}`]={justifyContent:n}}),r},nt=()=>({}),rt=ve("Flex",e=>{const{paddingXS:i,padding:r,paddingLG:n}=e,a=ke(e,{flexGapSM:i,flexGap:r,flexGapLG:n});return[Ke(a),Qe(a),et(a),tt(a),it(a)]},nt,{resetStyle:!1});var st=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const at=ce.forwardRef((e,i)=>{const{prefixCls:r,rootClassName:n,className:a,style:c,flex:g,gap:j,children:w,vertical:y=!1,component:T="div"}=e,v=st(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:N,direction:I,getPrefixCls:H}=ce.useContext(ue),h=H("flex",r),[m,o,d]=rt(h),L=y??N?.vertical,S=Y(a,n,N?.className,h,o,d,Je(h,e),{[`${h}-rtl`]:I==="rtl",[`${h}-gap-${j}`]:he(j),[`${h}-vertical`]:L}),C=Object.assign(Object.assign({},N?.style),c);return g&&(C.flex=g),j&&!he(j)&&(C.gap=j),m(ce.createElement(T,Object.assign({ref:i,className:S,style:C},Me(v,["justify","wrap","align"])),w))}),pe=at,ot=e=>{const{componentCls:i,calc:r}=e;return{[i]:Object.assign(Object.assign({},ze(e)),{margin:0,padding:0,listStyle:"none",[`${i}-item`]:{position:"relative",margin:0,paddingBottom:e.itemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.itemHeadSize,insetInlineStart:r(r(e.itemHeadSize).sub(e.tailWidth)).div(2).equal(),height:`calc(100% - ${A(e.itemHeadSize)})`,borderInlineStart:`${A(e.tailWidth)} ${e.lineType} ${e.tailColor}`},"&-pending":{[`${i}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${i}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.itemHeadSize,height:e.itemHeadSize,backgroundColor:e.dotBg,border:`${A(e.dotBorderWidth)} ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:r(e.itemHeadSize).div(2).equal(),insetInlineStart:r(e.itemHeadSize).div(2).equal(),width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.customHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.lineWidth).equal(),marginInlineStart:r(e.margin).add(e.itemHeadSize).equal(),marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${i}-item-tail`]:{display:"none"},[`> ${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}}},[`&${i}-alternate,
        &${i}-right,
        &${i}-label`]:{[`${i}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:r(e.marginXXS).mul(-1).equal(),"&-custom":{marginInlineStart:r(e.tailWidth).div(2).equal()}},"&-left":{[`${i}-item-content`]:{insetInlineStart:`calc(50% - ${A(e.marginXXS)})`,width:`calc(50% - ${A(e.marginSM)})`,textAlign:"start"}},"&-right":{[`${i}-item-content`]:{width:`calc(50% - ${A(e.marginSM)})`,margin:0,textAlign:"end"}}}},[`&${i}-right`]:{[`${i}-item-right`]:{[`${i}-item-tail,
            ${i}-item-head,
            ${i}-item-head-custom`]:{insetInlineStart:`calc(100% - ${A(r(r(e.itemHeadSize).add(e.tailWidth)).div(2).equal())})`},[`${i}-item-content`]:{width:`calc(100% - ${A(r(e.itemHeadSize).add(e.marginXS).equal())})`}}},[`&${i}-pending
        ${i}-item-last
        ${i}-item-tail`]:{display:"block",height:`calc(100% - ${A(e.margin)})`,borderInlineStart:`${A(e.tailWidth)} dotted ${e.tailColor}`},[`&${i}-reverse
        ${i}-item-last
        ${i}-item-tail`]:{display:"none"},[`&${i}-reverse ${i}-item-pending`]:{[`${i}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${A(e.margin)})`,borderInlineStart:`${A(e.tailWidth)} dotted ${e.tailColor}`},[`${i}-item-content`]:{minHeight:r(e.controlHeightLG).mul(1.2).equal()}},[`&${i}-label`]:{[`${i}-item-label`]:{position:"absolute",insetBlockStart:r(r(e.fontSize).mul(e.lineHeight).sub(e.fontSize)).mul(-1).add(e.tailWidth).equal(),width:`calc(50% - ${A(e.marginSM)})`,textAlign:"end"},[`${i}-item-right`]:{[`${i}-item-label`]:{insetInlineStart:`calc(50% + ${A(e.marginSM)})`,width:`calc(50% - ${A(e.marginSM)})`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${i}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},lt=e=>({tailColor:e.colorSplit,tailWidth:e.lineWidthBold,dotBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3,dotBg:e.colorBgContainer,itemPaddingBottom:e.padding*1.25}),ct=ve("Timeline",e=>{const i=ke(e,{itemHeadSize:10,customHeadPaddingVertical:e.paddingXXS,paddingInlineEnd:2});return[ot(i)]},lt);var dt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const pt=e=>{var{prefixCls:i,className:r,color:n="blue",dot:a,pending:c=!1,position:g,label:j,children:w}=e,y=dt(e,["prefixCls","className","color","dot","pending","position","label","children"]);const{getPrefixCls:T}=l.useContext(ue),v=T("timeline",i),N=Y(`${v}-item`,{[`${v}-item-pending`]:c},r),I=/blue|red|green|gray/.test(n||"")?void 0:n,H=Y(`${v}-item-head`,{[`${v}-item-head-custom`]:!!a,[`${v}-item-head-${n}`]:!I});return l.createElement("li",Object.assign({},y,{className:N}),j&&l.createElement("div",{className:`${v}-item-label`},j),l.createElement("div",{className:`${v}-item-tail`}),l.createElement("div",{className:H,style:{borderColor:I,color:I}},a),l.createElement("div",{className:`${v}-item-content`},w))},$e=pt;var ye=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const ut=e=>{var{prefixCls:i,className:r,pending:n=!1,children:a,items:c,rootClassName:g,reverse:j=!1,direction:w,hashId:y,pendingDot:T,mode:v=""}=e,N=ye(e,["prefixCls","className","pending","children","items","rootClassName","reverse","direction","hashId","pendingDot","mode"]);const I=(C,s)=>v==="alternate"?C==="right"?`${i}-item-right`:C==="left"?`${i}-item-left`:s%2===0?`${i}-item-left`:`${i}-item-right`:v==="left"?`${i}-item-left`:v==="right"?`${i}-item-right`:C==="right"?`${i}-item-right`:"",H=Ie(c||[]),h=typeof n=="boolean"?null:n;n&&H.push({pending:!!n,dot:T||l.createElement(je,null),children:h}),j&&H.reverse();const m=H.length,o=`${i}-item-last`,d=H.filter(C=>!!C).map((C,s)=>{var F;const u=s===m-2?o:"",P=s===m-1?o:"",{className:W}=C,R=ye(C,["className"]);return l.createElement($e,Object.assign({},R,{className:Y([W,!j&&n?u:P,I((F=C?.position)!==null&&F!==void 0?F:"",s)]),key:C?.key||s}))}),L=H.some(C=>!!C?.label),S=Y(i,{[`${i}-pending`]:!!n,[`${i}-reverse`]:!!j,[`${i}-${v}`]:!!v&&!L,[`${i}-label`]:L,[`${i}-rtl`]:w==="rtl"},r,g,y);return l.createElement("ul",Object.assign({},N,{className:S}),d)},gt=ut;function ht(e,i){return e&&Array.isArray(e)?e:Fe(i).map(r=>{var n,a;return Object.assign({children:(a=(n=r?.props)===null||n===void 0?void 0:n.children)!==null&&a!==void 0?a:""},r.props)})}var mt=function(e,i){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)i.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Le=e=>{const{getPrefixCls:i,direction:r,timeline:n}=l.useContext(ue),{prefixCls:a,children:c,items:g,className:j,style:w}=e,y=mt(e,["prefixCls","children","items","className","style"]),T=i("timeline",a),v=Be(T),[N,I,H]=ct(T,v),h=ht(g,c);return N(l.createElement(gt,Object.assign({},y,{className:Y(n?.className,j,H,v),style:Object.assign(Object.assign({},n?.style),w),prefixCls:T,direction:r,items:h,hashId:I})))};Le.Item=$e;const ft=Le;var xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"border",theme:"outlined"};const yt=xt;var vt=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:yt}))};const kt=l.forwardRef(vt);var jt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const bt=jt;var St=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:bt}))};const wt=l.forwardRef(St);var Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"};const $t=Ct;var Lt=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:$t}))};const Tt=l.forwardRef(Lt);var Nt={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M136 552h63.6c4.4 0 8-3.6 8-8V288.7h528.6v72.6c0 1.9.6 3.7 1.8 5.2a8.3 8.3 0 0011.7 1.4L893 255.4c4.3-5 3.6-10.3 0-13.2L749.7 129.8a8.22 8.22 0 00-5.2-1.8c-4.6 0-8.4 3.8-8.4 8.4V209H199.7c-39.5 0-71.7 32.2-71.7 71.8V544c0 4.4 3.6 8 8 8zm752-80h-63.6c-4.4 0-8 3.6-8 8v255.3H287.8v-72.6c0-1.9-.6-3.7-1.8-5.2a8.3 8.3 0 00-11.7-1.4L131 768.6c-4.3 5-3.6 10.3 0 13.2l143.3 112.4c1.5 1.2 3.3 1.8 5.2 1.8 4.6 0 8.4-3.8 8.4-8.4V815h536.6c39.5 0 71.7-32.2 71.7-71.8V480c-.2-4.4-3.8-8-8.2-8z"}}]},name:"retweet",theme:"outlined"};const Mt=Nt;var zt=function(i,r){return l.createElement(oe,le({},i,{ref:r,icon:Mt}))};const It=l.forwardRef(zt),Ft=({size:e=16})=>t.jsx("svg",{width:e,height:e+12,viewBox:"0 0 16 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M14 27.3438C13.8125 27.3438 13.6406 27.3073 13.4844 27.2344C13.3281 27.1615 13.1875 27.0729 13.0625 26.9688L1.0625 14.9375C0.9375 14.8333 0.838542 14.6979 0.765625 14.5312C0.692708 14.3646 0.65625 14.1875 0.65625 14C0.65625 13.8125 0.692708 13.6406 0.765625 13.4844C0.838542 13.3281 0.9375 13.1875 1.0625 13.0625L13.0625 1.0625C13.1875 0.9375 13.3281 0.838541 13.4844 0.765625C13.6406 0.692709 13.8229 0.65625 14.0312 0.65625C14.3854 0.65625 14.6927 0.786459 14.9531 1.04688C15.2135 1.30729 15.3438 1.625 15.3438 2C15.3438 2.1875 15.3073 2.36458 15.2344 2.53125C15.1615 2.69792 15.0625 2.83333 14.9375 2.9375L3.875 14L14.9375 25.0625C15.0625 25.1875 15.1615 25.3333 15.2344 25.5C15.3073 25.6667 15.3438 25.8333 15.3438 26C15.3438 26.375 15.2135 26.6927 14.9531 26.9531C14.6927 27.2135 14.375 27.3438 14 27.3438Z",fill:"#ABABAB"})});function Bt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_starting"})})})}function Ht({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Bắt đầu"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_start})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Pt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_ending"})})})}function Dt({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Kết thúc"})}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_end})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Ot(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_checking"})})})}function Et({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Viếng thăm"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_checking})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_user"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.retail_name})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Rt(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_distance"})})})}function _t({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Di chuyển"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_moving})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"18px",height:"20px",backgroundSize:"Cover",color:"#1877F2"},className:"icon_marker_blue"})}),t.jsxs("div",{style:{color:"#1877F2",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:[e.total_distance," Trip"]})]})]})}function At(){return t.jsx(t.Fragment,{children:t.jsx("div",{style:{height:"36px",width:"36px",borderRadius:"32px",border:"1px solid #DFE3E8",gap:"8px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"20px",height:"20px",backgroundSize:"Cover"},className:"icon_parking"})})})}function Wt({data:e,onEventClickItem:i}){const r=()=>{i(e.index_item)};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center",style:{cursor:"pointer"},onClick:r,children:[t.jsx("div",{style:{color:"#212B36",fontWeight:500,fontSize:"15px",lineHeight:"21px",marginLeft:"5px"},children:"Dừng"}),t.jsx("div",{className:"mx-3 h-2 w-2 rounded-full bg-black"}),t.jsx("div",{style:{color:"#212B36",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.total_time})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_clock_default"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.time_stop})]}),t.jsxs("div",{className:"flex",style:{marginTop:"5px"},children:[t.jsx("div",{style:{height:"20px",width:"20px",marginLeft:"5px",marginRight:"5px"},className:"flex items-center justify-center",children:t.jsx("div",{style:{width:"15px",height:"18px",backgroundSize:"Cover"},className:"icon_marker"})}),t.jsx("div",{style:{color:"#637381",fontWeight:400,fontSize:"14px",lineHeight:"21px"},children:e.address})]})]})}function Vt({options:e}){const[i,r]=l.useState([]),[n,a]=l.useState({summary:null,details:[]}),[c,g]=l.useState(!0),[j,w]=l.useState(null);l.useEffect(()=>{g(!0),w(null)},[e]);const y=m=>{j==m?w(null):w(m)};l.useEffect(()=>{let m=[];if(n.details!=null)for(let o=0;o<n.details.length;o++){let d=n.details[o];d.type=="start"?m.push({dot:t.jsx(Bt,{}),children:t.jsx(Ht,{data:{time_start:h(d.timestamp),address:d.address,index_item:o},onEventClickItem:y})}):d.type=="checkin"?m.push({dot:t.jsx(Ot,{}),children:t.jsx(Et,{data:{time_checking:`${h(d.startTime)} - ${h(d.endTime)}`,retail_name:d.storeName,address:d.address,total_time:`${v(d.startTime,d.endTime)}`,index_item:o},onEventClickItem:y})}):d.type=="move"?m.push({dot:t.jsx(Rt,{}),children:t.jsx(_t,{data:{time_moving:`${h(d.startTime)} - ${h(d.endTime)}`,total_distance:`${N(d.distance)}`,total_time:`${v(d.startTime,d.endTime)}`,index_item:o},onEventClickItem:y})}):d.type=="stop"?m.push({dot:t.jsx(At,{}),children:t.jsx(Wt,{data:{time_stop:`${h(d.startTime)} - ${h(d.endTime)}`,address:d.address,total_time:`${v(d.startTime,d.endTime)}`,index_item:o},onEventClickItem:y})}):d.type=="end"&&m.push({dot:t.jsx(Pt,{}),children:t.jsx(Dt,{data:{time_end:`${h(d.timestamp)}`,address:d.address,index_item:o},onEventClickItem:y})})}r(m)},[n]);const T=m=>{m!=null?a(m):a({summary:null,details:[]}),g(!1)},v=(m,o)=>{const d=new Date(m),S=new Date(o)-d;if(S<6e4)return`${Math.round(S/1e3)} giây`;if(S>=6e4&&S<6e4*60)return`${Math.round(S/6e4)} phút`;{const C=Math.floor(S/36e5),s=Math.floor(S%(1e3*60*60)/(1e3*60));return`${C} giờ ${s} phút`}},N=m=>m<1e3?`${Math.round(m)} m`:`${Math.round(m/1e3)} km`,I=m=>m<60?`${Math.round(m)} giây`:m>=60&&m<3600?`${Math.round(m/60)} phút`:`${Math.round(m/3600)} giờ`,H=m=>Math.round(m*3.6),h=m=>{var o=new Date(m);return o.setUTCHours(o.getUTCHours()+7),`${o.getUTCHours()}:${o.getUTCMinutes()}`};return t.jsxs(t.Fragment,{children:[c&&t.jsx("div",{style:{position:"fixed",width:"100%",height:"85%",backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(He,{indicator:t.jsx(je,{style:{fontSize:30,color:"#fff"},spin:!0})})}),t.jsxs(ae,{gutter:20,children:[t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#8E33FF1F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_distance"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Quãng đường di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&N(n.summary.move.distance)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 m"})]})]})})})}),t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#00B8D91F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_clock"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian di chuyển"}),n.summary!=null?t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&I(n.summary.move.totalTime)}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 giây"})]})]})})})}),t.jsx(X,{span:4,className:"card-container",children:t.jsx(ee,{children:t.jsx("div",{className:"wrap-card-container",children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FFAB001F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"30px",backgroundSize:"contain"},className:"icon_speeding"})}),t.jsxs("div",{style:{marginLeft:"10px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Tốc độ trung bình"}),n.summary!=null?t.jsxs("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:[n.summary&&H(n.summary.move.avgSpeed)," km/h"]}):t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:"0 km/h"})]})]})})})}),t.jsx(X,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#1877F21F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_parking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center",children:[t.jsxs("div",{style:{marginRight:"40px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.stop.count?n.summary.stop.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian dừng"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&I(n.summary.stop.totalTime)?I(n.summary.stop.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})}),t.jsx(X,{span:6,className:"card-container",children:t.jsx(ee,{children:t.jsxs("div",{className:"flex ",children:[t.jsx("div",{className:"flex items-center justify-center",style:{width:"64px",height:"64px",backgroundColor:"#FF56301F",gap:"8px",borderRadius:"15px"},children:t.jsx("div",{style:{width:"44px",height:"44px",backgroundSize:"Cover"},className:"icon_checking"})}),t.jsxs("div",{style:{marginLeft:"10px",width:"100%"},className:"flex items-center ",children:[t.jsxs("div",{style:{marginRight:"13px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Số lần viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&n.summary.checkin.count?n.summary.checkin.count:0})]}),t.jsx("div",{style:{border:"1px solid #D9D9D9",height:"100%"}}),t.jsxs("div",{style:{marginLeft:"25px"},children:[t.jsx("div",{style:{opacity:"70%",color:"#212B36",fontSize:"14px",fontWeight:500},children:"Thời gian viếng thăm"}),t.jsx("div",{style:{fontWeight:600,fontSize:"22px",color:"#212B36",marginTop:"8px"},children:n.summary&&I(n.summary.checkin.totalTime)?I(n.summary.checkin.totalTime):t.jsx("span",{children:"0 giây"})})]})]})]})})})]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(ae,{gutter:20,style:{marginLeft:"0px",marginRight:"0px"},children:t.jsx(We,{children:t.jsxs(ae,{children:[t.jsxs(X,{span:6,style:{paddingTop:"1rem",paddingLeft:"1rem"},children:[t.jsx("div",{style:{fontWeight:500,fontSize:"16px",color:"#000000",height:"45px"},children:"Quãng đường di chuyển"}),t.jsx("div",{style:{padding:"8px 16px 8px 16px",maxHeight:"530px",overflowY:"auto"},children:i.length>0?t.jsx(ft,{mode:"left",items:i}):t.jsx("div",{children:"Chưa có lộ trình"})})]}),t.jsx(X,{span:18,style:{height:"615px"},children:t.jsx(Kt,{options:e,onLoad:T,HistoryIndex:j})})]})})})})]})}function qt(){const[e,i]=l.useState(!1),r=()=>{i(!e)},n={iconStart:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",iconEnd:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",iconCheckin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",iconStop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"};return t.jsxs("div",{id:"ekmapplf_tracking_legend",className:"ekmapplf_tracking-map-legend",children:[t.jsxs("div",{className:"ekmapplf_tracking-legend-title",onClick:r,children:[t.jsx("span",{className:`icon ${e?"ekmapplf_tracking-icon-square-minus":"ekmapplf_tracking-icon-square-plus"}`,style:{filter:"invert(100%) sepia(100%) saturate(0%) hue-rotate(187deg) brightness(105%) contrast(103%)"}}),t.jsx("span",{children:"Chú giải bản đồ"})]}),t.jsx("div",{className:`ekmapplf_tracking-legend-body ${e?"open":""}`,style:{maxHeight:e?"none":"0"},children:t.jsxs("ul",{children:[t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStart})`}}),"Vị trí bắt đầu"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconEnd})`}}),"Vị trí kết thúc"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconCheckin})`}}),"Vị trí khách hàng"]}),t.jsxs("li",{children:[t.jsx("span",{className:"ekmapplf_tracking-legend-icon",style:{backgroundImage:`url(${n.iconStop})`}}),"Vị trí điểm dừng"]})]})})]})}function te(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return e.geometry.coordinates;if(e.type==="Point")return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Gt(e){return e.type==="Feature"?e.geometry:e}function Te(e,i,r){r===void 0&&(r={});var n=te(e),a=te(i),c=q(a[1]-n[1]),g=q(a[0]-n[0]),j=q(n[1]),w=q(a[1]),y=Math.pow(Math.sin(c/2),2)+Math.pow(Math.sin(g/2),2)*Math.cos(j)*Math.cos(w);return Ve(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),r.units)}function Zt(e,i,r,n){n===void 0&&(n={});var a=te(e),c=q(a[0]),g=q(a[1]),j=q(r),w=qe(i,n.units),y=Math.asin(Math.sin(g)*Math.cos(w)+Math.cos(g)*Math.sin(w)*Math.cos(j)),T=c+Math.atan2(Math.sin(j)*Math.sin(w)*Math.cos(g),Math.cos(w)-Math.sin(g)*Math.sin(y)),v=de(T),N=de(y);return K([v,N],n.properties)}function ge(e,i,r){if(r===void 0&&(r={}),r.final===!0)return Xt(e,i);var n=te(e),a=te(i),c=q(n[0]),g=q(a[0]),j=q(n[1]),w=q(a[1]),y=Math.sin(g-c)*Math.cos(w),T=Math.cos(j)*Math.sin(w)-Math.sin(j)*Math.cos(w)*Math.cos(g-c);return de(Math.atan2(y,T))}function Xt(e,i){var r=ge(i,e);return r=(r+180)%360,r}function Yt(e,i,r){r===void 0&&(r={});for(var n=Gt(e),a=n.coordinates,c=0,g=0;g<a.length&&!(i>=c&&g===a.length-1);g++)if(c>=i){var j=i-c;if(j){var w=ge(a[g],a[g-1])-180,y=Zt(a[g],j,w,r);return y}else return K(a[g])}else c+=Te(a[g],a[g+1],r);return K(a[a.length-1])}function Ut(e,i){return i===void 0&&(i={}),Ge(e,function(r,n){var a=n.geometry.coordinates;return r+Te(a[0],a[1],i)},0)}const Jt=({map:e,segmentData:i,options:r,currentInfo:n,Animation:a})=>{const c=l.useRef(null),g=l.useRef(null),[j,w]=l.useState(r.animation.follow),[y,T]=l.useState(!1),[v,N]=l.useState(10),[I,H]=l.useState(!0),h=[{value:1,label:"x1"},{value:2,label:"x2"},{value:5,label:"x5"},{value:10,label:"x10"},{value:20,label:"x20"},{value:100,label:"x100"}],[m,o]=l.useState(!0),d=l.useRef(0),L=l.useRef(0),S=l.useRef([]);function C(p,z){L.current=p;const M=z[p];if(!M){if(I){L.current=0,S.current=[];try{e&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]})}catch(_){T(!1),console.log(_)}i.length&&i[0].computed.time&&(g.current=setTimeout(C.bind(this),1e3,L.current,i))}else L.current=p-1,V();n(z[L.current]);return}if(n(M),M.computed.time){let _=M.computed.time*1e3/v;if(M.computed.speed){let b=function(B){E||(O=M.loc1.loc,E=B);const f=(B-E)/(Number(M.computed.time?.toString())*1e3/v);if(!(f>1||!y)){var $=fe([M.loc1.loc,M.loc2.loc]),k=Ut($),x=Yt($,k*f).geometry.coordinates,D=ge(K(O),K(x));O[0]!==x[0]&&O[1]!==x[1]&&(d.current=D),O=x,S.current=S.current.concat([x]);try{e&&j&&e.panTo(x,{animate:!0,essential:!0,curve:1.42,duration:100,pitch:60,bearing:d.current}),e&&e.getSource("locationMarker")&&e.getSource("locationMarker").setData({type:"FeatureCollection",features:[K(x,{bearing:d.current})]}),e&&S.current.length>1&&e.getSource("LocationHistory")&&e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[fe(S.current)]}),c.current=window.requestAnimationFrame(b)}catch(Z){T(!1),console.log(Z)}}};var E,O;c.current=window.requestAnimationFrame(b)}p++,S.current=z.slice(0,p).map(b=>b.loc1.loc),g.current=setTimeout(C.bind(this),_,p,z)}}l.useEffect(()=>{T(!1),c.current&&cancelAnimationFrame(c.current),g.current&&clearTimeout(g.current),L.current=0,i.length},[i,r]),l.useEffect(()=>{a===!0&&W(),a===!1&&R(),a===null&&V()},[a]),l.useEffect(()=>{if(y){L.current===0&&(S.current=[],e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc)),i.length&&i[0].computed.time&&(g.current=setTimeout(C.bind(void 0),500,L.current,i));try{e.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",.4),e.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),e.setLayoutProperty("locationMarker","visibility","visible"),e.setLayoutProperty("LocationHistory","visibility","visible"),e.getSource("RouteHistory")&&(e.removeLayer("RouteHistory"),e.removeLayer("RouteHistory-arrow"),e.removeSource("RouteHistory"))}catch(p){console.log(p)}}else{n(null),c.current&&cancelAnimationFrame(c.current);try{e.setPaintProperty("ek-tracking-his-LineString","line-color",r.route.lineCorlor),e.setPaintProperty("ek-tracking-his-LineString","line-opacity",r.route.lineOpacity),e.setLayoutProperty("ek-tracking-his-LineString","visibility","visible"),e.setLayoutProperty("locationMarker","visibility","none"),e.setLayoutProperty("LocationHistory","visibility","none")}catch(p){console.log(p)}}return()=>{c.current&&cancelAnimationFrame(c.current),g.current&&clearTimeout(g.current)}},[y,v,j,I]);const[s,F]=l.useState(null);l.useEffect(()=>{const p=()=>{o(document.visibilityState==="visible")};return document.addEventListener("visibilitychange",p),()=>{document.removeEventListener("visibilitychange",p)}},[]),l.useEffect(()=>{m?T(!!(s&&s===!0)):(F(y),T(!1))},[m]);const u=p=>{N(p)},P=p=>{p.target.checked&&e.setZoom(17),w(!j)},W=()=>{T(!0)},R=()=>{T(!1)},V=()=>{R();try{e&&(e.getSource("locationMarker").setData({type:"FeatureCollection",features:[]}),e.getSource("LocationHistory").setData({type:"FeatureCollection",features:[]}),i.length&&e.panTo(i[0].loc1.loc))}catch(p){console.log(p)}L.current=0},G=()=>{H(!I)};return t.jsx("div",{id:"ekmapplf_tracking_control",className:"ekmapplf_tracking-map-control",children:t.jsxs(pe,{gap:"small",align:"center",justify:"center",children:[t.jsx(Q,{title:"Play",children:t.jsx(ie,{icon:t.jsx(wt,{}),disabled:y,onClick:W})}),t.jsx(Q,{title:"Pause",children:t.jsx(ie,{icon:t.jsx(Tt,{}),disabled:!y,onClick:R})}),t.jsx(Q,{title:"Stop",children:t.jsx(ie,{icon:t.jsx(kt,{}),onClick:V})}),t.jsx(Q,{title:"Replay",children:t.jsx(ie,{type:I?"primary":"default",icon:t.jsx(It,{}),onClick:G})}),t.jsx(Q,{title:"Speed",children:t.jsx(be,{defaultValue:v,style:{width:"75px"},onChange:u,options:h})}),t.jsx(Pe,{onChange:P,checked:j,children:"Theo dõi lộ trình"})]})})},se=window.ekmapplf;function Kt({options:e,onLoad:i,HistoryIndex:r}){const n=l.useRef(null),a=l.useState(null),[c,g]=l.useState(null),[j,w]=l.useState({ready:!1,Data:[],options:null}),[y,T]=l.useState({date:null,time:null,speed:0}),v=l.useRef(null),N=l.useRef(null),[I,H]=l.useState(!1),h=l.useRef(null),o=Ze({},{center:[105,17],zoom:5,pageNumber:1,pageSize:5e3,icon:{track:"https://files.ekgis.vn/sdks/tracking/assets/custom_marker.png",navigation:"https://files.ekgis.vn/sdks/tracking/assets/arrow.png",checkin:"https://files.ekgis.vn/sdks/tracking/assets/check-icon.png",start:"https://files.ekgis.vn/sdks/tracking/assets/start-icon.png",end:"https://files.ekgis.vn/sdks/tracking/assets/end-icon.png",stop:"https://files.ekgis.vn/sdks/tracking/assets/stop-icon.png"},route:{visible:!0,lineCorlor:"#0F53FF",lineWidth:6.5,lineOpacity:.9},animation:{follow:!0,animate:!1}},e),d=()=>{try{let R=function(){var b={type:"FeatureCollection",features:[]};s.getSource("LocationHistory")?s.getSource("LocationHistory").setData(b):(s.addSource("LocationHistory",{type:"geojson",data:b}),s.addLayer({id:"LocationHistory",type:"line",source:"LocationHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":o.route.lineCorlor,"line-width":o.route.lineWidth,"line-opacity":o.route.lineOpacity},filter:["==","$type","LineString"]}))};a.current&&a.current.remove(),a.current=new J.Map({container:n.current,center:o.center,zoom:o.zoom,minZoom:1});var s=a.current;g(s);const V=s.getContainer();s.setPadding({top:100,bottom:100,left:100,right:100}),new se.VectorBaseMap("OSM:Night",o.apiKey).addTo(s);var F=new se.control.BaseMap({id:"ekmapplf_tracking_ctrl_basemap_"+V.id,baseLayers:[{id:"OSM:Night",title:"Bản đồ nền Đêm",thumbnail:"https://docs.ekgis.vn/assets/dem-map.png",width:"50px",height:"50px"},{id:"OSM:Bright",title:"Bản đồ nền Sáng",thumbnail:"https://docs.ekgis.vn/assets/map-sang.png",width:"50px",height:"50px"},{id:"OSM:Standard",title:"Bản đồ nền Tiêu chuẩn",thumbnail:"https://docs.ekgis.vn/assets/map-chuan.png",width:"50px",height:"50px"},{id:"OSM:Gray",title:"Bản đồ nền Xám",thumbnail:"https://docs.ekgis.vn/assets/xam-map.png",width:"50px",height:"50px"},{id:"OSM:Dark",title:"Bản đồ nền Đêm xanh coban",thumbnail:"https://docs.ekgis.vn/assets/xanhcoban-map.png",width:"50px",height:"50px"},{id:"OSM:Pencil",title:"Bản đồ nền Bút chì",thumbnail:"https://docs.ekgis.vn/assets/chi-map.png",width:"50px",height:"50px"},{id:"OSM:Pirates",title:"Bản đồ nền Cổ điển",thumbnail:"https://docs.ekgis.vn/assets/dien-map.png",width:"50px",height:"50px"},{id:"OSM:Wood",title:"Bản đồ nền Gỗ",thumbnail:"https://docs.ekgis.vn/assets/go-map.png",width:"50px",height:"50px"}]});s.addControl(F,"bottom-left"),F.on("changeBaseLayer",async function(b){H(!1),new se.VectorBaseMap(b.layer,o.apiKey).addTo(s),setTimeout(async()=>{await p(o.from_time,o.to_time,o.pageNumber,o.pageSize)},1e3)}),s.addControl(new J.NavigationControl({visualizePitch:!0}),"bottom-right");var u=!1;s.getPitch()>0?u=!0:u=!1;var P="maplibregl-terrain2d-control",W="Hiển thị 2D";u||(P="maplibregl-terrain3d-control",W="Bản đồ 3D");let G=new se.control.Button({className:"btn-ctl-group "+P,icon:"none",tooltip:W});G.on("click",b=>{u=!u,u?(b._div.className=b._div.className.replaceAll("maplibregl-terrain3d-control","maplibregl-terrain2d-control"),b._div.title="Hiển thị 2D"):(b._div.className=b._div.className.replaceAll("maplibregl-terrain2d-control","maplibregl-terrain3d-control"),b._div.title="Hiển thị 3D"),u?(s.easeTo({pitch:60}),s.setLayoutProperty("building-3d","visibility","visible")):(s.easeTo({pitch:0}),s.setLayoutProperty("building-3d","visibility","none"))}),s.addControl(G,"bottom-right"),s.addControl(new J.FullscreenControl,"top-right"),s.on("load",()=>{try{if(!o.objectId||o.objectId===""||o.objectId==="null"||!o.from_time||o.from_time===""||o.from_time==="null"||!o.to_time||o.to_time===""||o.to_time==="null"){i(null);return}p(o.from_time,o.to_time,o.pageNumber,o.pageSize)}catch(b){console.error("Error:",b)}});const p=async(b,B,f,$)=>{H(!1);let k=await z(b,B,f,$);await M(k);let x=await L(k);N.current=x,k.length&&k[0].coordinates&&o.animation.animate&&s.easeTo({center:k[0].coordinates,duration:100,zoom:16}),setTimeout(()=>{w({ready:!0,Data:x,options:o})},300)},z=async(b,B,f,$)=>{if(!v.current){let k=`https://api.ekgis.vn/v2/tracking/locationHistory/summary/${o.projectId}/${o.objectId}?api_key=${o.apiKey}&from_time=${b}&to_time=${B}`;const D=await(await fetch(k)).json();v.current=D,i(v.current)}return v.current.details||[]},M=async b=>{let B={type:"FeatureCollection",features:[]},f={type:"FeatureCollection",features:[]},$={type:"FeatureCollection",features:[]};if(b.forEach(x=>{const D={type:"Feature",properties:x.type!=="move"?x:{},geometry:x.type==="move"?x.route.geometry:{type:"Point",coordinates:x.coordinates}};if(B.features.push(D),x.type==="move"&&x.route.geometry.coordinates.length===0){let Z=x.route.locations.map(U=>U.coordinates);B.features.push({type:"Feature",geometry:{type:"LineString",coordinates:Z}})}x.type!=="move"&&(x.type==="checkin"?f.features.push(D):$.features.push(D))}),b.length){var k=xe(B);s.fitBounds(k,{maxZoom:16,duration:1e3})}await E(B),await O(f,$),await R(),await _()},E=b=>{try{if(!s.getImage("icon_arrow")){var B='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',f=new Image;f.onload=function(){s.hasImage("icon_arrow")||s.addImage("icon_arrow",f)},f.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(B)}s.getSource("ek-tracking-his-line-source")?s.getSource("ek-tracking-his-line-source").setData(b):(s.addSource("ek-tracking-his-line-source",{type:"geojson",data:b}),s.addLayer({id:"ek-tracking-his-LineString",type:"line",source:"ek-tracking-his-line-source",layout:{"line-join":"round","line-cap":"round",visibility:o.route.visible?"visible":"none"},paint:{"line-color":o.route.lineCorlor,"line-width":o.route.lineWidth,"line-opacity":o.route.lineOpacity},filter:["==","$type","LineString"]}),s.addLayer({id:"ek-tracking-his-LineString-arrow",type:"symbol",source:"ek-tracking-his-line-source",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}},paint:{"icon-opacity":.9}}))}catch($){console.error("Error setLine:",$)}},O=async(b,B)=>{try{if(!s.getImage("marker-start")){const f=await s.loadImage(o.icon.start);s.addImage("marker-start",f.data)}if(!s.getImage("marker-end")){const f=await s.loadImage(o.icon.end);s.addImage("marker-end",f.data)}if(!s.getImage("marker-check")){const f=await s.loadImage(o.icon.checkin);s.addImage("marker-check",f.data)}if(!s.getImage("marker-stop")){const f=await s.loadImage(o.icon.stop);s.addImage("marker-stop",f.data)}s.getSource("ek-tracking-his-track-source")?s.getSource("ek-tracking-his-track-source").setData(B):(s.addSource("ek-tracking-his-track-source",{type:"geojson",data:B}),s.addLayer({id:"ek-tracking-his-track-point",type:"symbol",source:"ek-tracking-his-track-source",layout:{"icon-image":["match",["get","type"],"start","marker-start","end","marker-end","marker-stop"],"icon-overlap":"cooperative","icon-anchor":"bottom","icon-size":.7,"icon-offset":["case",["==",["get","type"],"start"],["literal",[20,5]],["==",["get","type"],"end"],["literal",[20,5]],["literal",[0,0]]]}}),s.on("mouseenter","ek-tracking-his-track-point",f=>{s.getCanvas().style.cursor="pointer";const $=[[f.point.x-5,f.point.y-5],[f.point.x+5,f.point.y+5]];let x=s.queryRenderedFeatures($,{layers:["ek-tracking-his-track-point"]})[0],D="default";x.properties.type!="stop"&&(D=x.properties.type),h.current&&h.current.remove(),h.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(x.geometry.coordinates).setHTML(`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${D}-color"></span>
                                            <span>${x.properties.address}</span>
                                        </div>
                                        ${x.properties.type!=="stop"?`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${D}-color"></span>
                                            <span>${S(x.properties.timestamp)}</span>
                                        </div>`:`
                                        <div class="ek-tracking-his-popup-info">
                                            <span class="ek-tracking-his-popup-icon">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                    <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                                </svg>
                                            </span>
                                            <span>${S(x.properties.startTime)}</span>
                                        </div>
                                        ${x.properties.endTime!==""?`
                                            <div class="ek-tracking-his-popup-info">
                                                <span class="ek-tracking-his-popup-icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                                    </svg>
                                                </span>
                                                <span>${S(x.properties.endTime)}</span>
                                            </div>`:""} `}
                                    `).setOffset([0,-20]).addTo(s)}),s.on("mouseleave","ek-tracking-his-track-point",()=>{s.getCanvas().style.cursor="",h.current&&h.current.remove()})),s.getSource("ek-tracking-his-check-source")?s.getSource("ek-tracking-his-check-source").setData(b):(s.addSource("ek-tracking-his-check-source",{type:"geojson",data:b,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),s.addLayer({id:"ek-tracking-his-check-clusters",type:"circle",source:"ek-tracking-his-check-source",paint:{"circle-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-radius":12,"circle-stroke-color":["step",["get","point_count"],"#90D667",10,"#EFCD41",50,"#FF0012"],"circle-stroke-opacity":.7,"circle-stroke-width":5},filter:["all",["has","point_count"]]}),s.addLayer({id:"ek-tracking-his-check-cluster-count",type:"symbol",source:"ek-tracking-his-check-source",layout:{"text-field":"{point_count_abbreviated}","text-size":12},filter:["all",["has","point_count"]]}),s.addLayer({id:"ek-tracking-his-check-point",type:"symbol",source:"ek-tracking-his-check-source",layout:{"icon-image":"marker-check","icon-overlap":"always","icon-anchor":"bottom","icon-size":.7},filter:["all",["!has","point_count"]]}),s.on("mouseenter","ek-tracking-his-check-clusters",()=>{s.getCanvas().style.cursor="pointer"}),s.on("mouseleave","ek-tracking-his-check-clusters",()=>{s.getCanvas().style.cursor=""}),s.on("click","ek-tracking-his-check-clusters",async f=>{const $=s.queryRenderedFeatures(f.point,{layers:["ek-tracking-his-check-clusters"]}),k=$[0].properties.cluster_id,x=await s.getSource("ek-tracking-his-check-source").getClusterExpansionZoom(k);s.easeTo({center:$[0].geometry.coordinates,zoom:x})}),s.on("mouseenter","ek-tracking-his-check-point",f=>{s.getCanvas().style.cursor="pointer";const $=[[f.point.x-5,f.point.y-5],[f.point.x+5,f.point.y+5]],k=s.queryRenderedFeatures($,{layers:["ek-tracking-his-check-point"]});h.current&&h.current.remove(),h.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!1,anchor:"bottom"}).setLngLat(k[0].geometry.coordinates).setHTML(`<div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                    <span>${k[0].properties.address}</span>
                                </div>
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                    </span>
                                    <span>${S(k[0].properties.startTime)}</span>
                                </div>
                                ${k[0].properties.endTime!=""?`
                                    <div class="ek-tracking-his-popup-info">
                                        <span class="ek-tracking-his-popup-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                        </span>
                                        <span>${S(k[0].properties.endTime)}</span>
                                    </div>`:""}
                                `).setOffset([0,-20]).addTo(s)}),s.on("mouseleave","ek-tracking-his-check-point",()=>{s.getCanvas().style.cursor="",h.current&&h.current.remove()}))}catch(f){console.error("Error setPoints:",f)}};async function _(){if(!s.getImage("marker-navigation")){const B=await s.loadImage(o.icon.navigation);s.addImage("marker-navigation",B.data)}var b={type:"FeatureCollection",features:[]};s.getSource("locationMarker")?s.getSource("locationMarker").setData(b):(s.addSource("locationMarker",{type:"geojson",data:b}),s.addLayer({id:"locationMarker",source:"locationMarker",type:"symbol",layout:{"icon-size":.7,"icon-offset":[0,-10],"icon-allow-overlap":!0,"icon-image":"marker-navigation","icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-overlap":"always","icon-ignore-placement":!0}}))}}catch(R){console.error("Error initializing map:",R)}},L=async s=>{var F,u,P={type:"FeatureCollection",features:[]};return s.forEach(p=>{if(p.type==="move")for(let z=0;z<p.route.locations.length;z++){let M=p.route.locations[z];if(new Date(M.timestamp).getTime()>=new Date(p.startTime).getTime()&&new Date(M.timestamp).getTime()<=new Date(p.endTime).getTime()){let E={type:"Feature",properties:{time:M.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:M.coordinates}};P.features.push(E)}}else if(p.type==="stop"||p.type==="checkin"){let z={type:"Feature",properties:{time:p.startTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}},M={type:"Feature",properties:{time:p.endTime,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};P.features.push(z,M)}else{let z={type:"Feature",properties:{time:p.timestamp,ele:0,type:p.type},geometry:{type:"Point",coordinates:p.coordinates}};P.features.push(z)}}),F=W(P),u=R(F),u||[];function W(p){var z={segments:[],id:e.objectId};let M=[];z.segments.push(M);for(let O=0;O<p.features.length;O++){var E=p.features[O];let _={loc:E.geometry.coordinates,time:new Date(E.properties.time).getTime(),ele:E.properties.ele};M.push(_)}return z}function R(p){const z=[];for(let b=0;b<p.segments.length;b++){const B=p.segments[b];for(let f=1;f<B.length;f++){const $=B[f-1],k=B[f];var M=$.time,E=k.time,O=new Date(M),_=new Date(E);let x=0;O.getDate()===_.getDate()&&O.getMonth()===_.getMonth()&&O.getFullYear()===_.getFullYear()&&(x=V($.loc[1],$.loc[0],k.loc[1],k.loc[0],$.ele,k.ele));const D={computed:{distance:x},loc1:$,loc2:k};if($.ele&&k.ele&&(D.computed.ele=k.ele),$.time&&k.time&&$.time!==k.time){const{speed:Z,time:U}=G(x,$.time,k.time),Ne=Z;D.computed.speed=Z,D.computed.time=U,D.computed.filteredSpeed=Ne}$.temp&&k.temp&&(D.computed.temp=($.temp+k.temp)/2),k.hr&&(D.computed.hr=k.hr),k.cad&&(D.computed.cad=k.cad),D.computed.speed&&z.push(D)}}return z}function V(p,z,M,E,O,_){const B=p*Math.PI/180,f=M*Math.PI/180,$=(M-p)*Math.PI/180,k=(E-z)*Math.PI/180,x=Math.sin($/2)*Math.sin($/2)+Math.cos(B)*Math.cos(f)*Math.sin(k/2)*Math.sin(k/2);let Z=6371e3*(2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x)));if(O!==void 0&&_!==void 0){const U=_-O;U!==0&&(Z=Math.sqrt(Math.pow(Z,2)+Math.pow(U,2)))}return Z}function G(p,z,M){const E=M/1e3-z/1e3;return{speed:(p/E||0)*3.6,time:E}}};l.useEffect(()=>(T({date:null,time:null,speed:0}),w({ready:!1,Data:[],options:null}),v.current=null,N.current=null,d(),()=>{h.current&&h.current.remove(),a.current&&a.current.remove()}),[e]),l.useEffect(()=>{if(H(null),r!==null){if(!v.current)return;const u=v.current.details[r];if(!u)return;if(u.type==="move")setTimeout(async()=>{c.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),c.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),c.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none");var P={type:"Feature",geometry:u.route.geometry};if(u.route.geometry.coordinates.length===0){let p=u.route.locations.map(z=>z.coordinates);P.geometry={type:"LineString",coordinates:p}}if(!c.getImage("icon_arrow")&&!c.hasImage("icon_arrow")){var W='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.2901 9.1698L7.70015 3.0698C4.95015 1.6198 1.96015 4.5498 3.35015 7.3298L4.97015 10.5698C5.42015 11.4698 5.42015 12.5298 4.97015 13.4298L3.35015 16.6698C1.96015 19.4498 4.95015 22.3698 7.70015 20.9298L19.2901 14.8298C21.5701 13.6298 21.5701 10.3698 19.2901 9.1698Z" stroke="#292D32" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" fill="#e50027"/></svg>',R=new Image;R.onload=function(){c.hasImage("icon_arrow")||c.addImage("icon_arrow",R)},R.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(W)}c.getSource("RouteHistory")?c.getSource("RouteHistory").setData(P):(c.addSource("RouteHistory",{type:"geojson",data:P}),c.addLayer({id:"RouteHistory",type:"line",source:"RouteHistory",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":o.route.lineCorlor,"line-width":o.route.lineWidth,"line-opacity":o.route.lineOpacity}}),c.addLayer({id:"RouteHistory-arrow",type:"symbol",source:"RouteHistory",layout:{"symbol-placement":"line","icon-ignore-placement":!0,"symbol-spacing":100,"icon-image":"icon_arrow","icon-size":{stops:[[13,.35],[16,.5],[18,.625],[21,.75]]}}}));var V=xe(P);c.fitBounds(V,{padding:100,maxZoom:17,duration:1e3});var G=await L([u]);setTimeout(()=>{w({ready:!0,Data:G,options:o})},200)},300);else if(u.type==="start"||u.type==="end"||u.type==="stop"||u.type==="checkin"){c.setPaintProperty("ek-tracking-his-LineString","line-color","#b5b5b5"),c.setPaintProperty("ek-tracking-his-LineString","line-opacity",.5),c.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","none"),c.easeTo({center:u.coordinates,duration:100,zoom:17,bearing:0});var s;if(u.type==="start"||u.type==="end"){let P="default";u.type!="stop"&&(P=u.type),s=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-${P}-color"></span>
                                <span>${u.address}</span>
                            </div>
                            ${u.type!=="stop"?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-clock ekmapplf_tracking-icon-${P}-color"></span>
                                <span>${S(u.timestamp)}</span>
                            </div>`:`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                        <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/>
                                    </svg>
                                </span>
                                <span>${S(u.startTime)}</span>
                            </div>
                            ${u.endTime!==""?`
                                <div class="ek-tracking-his-popup-info">
                                    <span class="ek-tracking-his-popup-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/>
                                        </svg>
                                    </span>
                                    <span>${S(u.endTime)}</span>
                                </div>`:""} `} `}(u.type==="stop"||u.type==="checkin")&&(s=`<div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon ekmapplf_tracking-icon-marker ekmapplf_tracking-icon-default-color"></span>
                                <span>${u.address}</span>
                            </div>
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#51CF66"/></svg>
                                </span>
                                <span>${S(u.startTime)}</span>
                            </div>
                            ${u.endTime!=""?`
                            <div class="ek-tracking-his-popup-info">
                                <span class="ek-tracking-his-popup-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120V256c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2V120c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="#FF6B6B"/></svg>
                                </span>
                                <span>${S(u.endTime)}</span>
                            </div>`:""}`),h.current=new J.Popup({className:"ek-tracking-his-popup",closeButton:!0,anchor:"bottom",focusAfterOpen:!1}).setLngLat(u.coordinates).setHTML(s).setOffset([0,-20]).addTo(c)}}else N.current&&w({ready:!0,Data:N.current,options:o});return()=>{try{h.current&&h.current.remove(),c&&(c.setPaintProperty("ek-tracking-his-LineString","line-color",o.route.lineCorlor),c.setPaintProperty("ek-tracking-his-LineString","line-opacity",o.route.lineOpacity),c.setLayoutProperty("ek-tracking-his-LineString-arrow","visibility","visible"),c.getSource("RouteHistory")&&(c.removeLayer("RouteHistory"),c.removeLayer("RouteHistory-arrow"),c.removeSource("RouteHistory")))}catch(F){console.log(F)}}},[r]);function S(s){if(s||s!=""){const F=new Date(s);return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}).format(F)}else return"Không có thông tin"}const C=s=>{if(s){const F=new Date(s.loc1.time);F.setHours(F.getHours());const u=F.getDate(),P=F.getMonth()+1,W=F.getFullYear(),R=F.getHours(),V=F.getMinutes(),G=`${u}/${P}/${W}`,p=`${R.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`;T({date:G,time:p,speed:Math.ceil(s.computed.speed*10)/10})}else T({date:null,time:null,speed:0})};return t.jsx(t.Fragment,{children:t.jsxs("div",{ref:n,id:"ekmap-tracking-his-map",children:[j.ready!==!1&&t.jsx(Jt,{map:c,segmentData:j.Data,options:j.options,Animation:I,currentInfo:C}),t.jsx(qt,{}),y.date!==null&&y.time!==null&&t.jsxs("div",{className:"ekmapplf_tracking-map-legend-his",children:[t.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"50%",fontWeight:600,textAlign:"center",borderRight:"1px solid"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:y.date}),t.jsx("span",{style:{color:"rgb(68, 68, 68)"},children:y.time})]}),t.jsxs(pe,{vertical:"true",align:"center",justify:"center",wrap:"wrap",style:{width:"49%",fontWeight:600,textAlign:"center"},children:[t.jsx("span",{style:{color:"rgb(132, 132, 132)"},children:"Tốc độ"}),t.jsxs("span",{style:{color:"rgb(54, 153, 255)"},children:[y.speed," km/h"]})]})]})]})})}function Qt({employee:e}){const[i,r]=l.useState(new Date("03-29-2024")),[n,a]=l.useState(re(new Date("03-29-2024").setHours(0,0,0).toString())),[c,g]=l.useState(re(new Date("03-29-2024").setHours(24,0,0).toString())),[j,w]=l.useState(""),[y,T]=l.useState([]),[v,N]=l.useState(""),I=d=>{setTimeout(()=>{r(d),a(re(me(d).today)),g(re(me(d).nextday))},200)},[H,h]=l.useState({apiKey:"w1Dlh2wRon7mE6sL196TgvLS45fw02uon74pJ0rc",projectId:"",objectId:"",from_time:n,to_time:c}),m=async d=>{let L=await ne.get("/api/method/mbw_dms.api.user.get_list_employees");if(L.message=="Thành công"){let S=L.result.map(function(C){return{value:C.name,label:C.employee_name}});T(S)}},o=async(d,L)=>{h(S=>({...S,objectId:L.object_id})),w(`${L.label} - ${d}`)};return l.useEffect(()=>{(async()=>{if(e==null||e==""){const d=await ne.get("/api/method/mbw_dms.api.user.get_projectID");h(L=>({...L,projectId:d.result["Project ID"],objectId:""})),m(d.result["Project ID"]);return}try{const d=await ne.get("/api/method/mbw_dms.api.user.get_projectID");console.log(d),h(S=>({...S,projectId:d.result["Project ID"],objectId:e})),m(d.result["Project ID"]),console.log(H);const L=await ne.get(`/api/method/mbw_dms.api.user.get_employee_info_by_objid?object_id=${e}`);L.message=="Thành công"&&L.result.length>0&&(w(L.result[0].employee_name),N(L.result[0].name))}catch(d){De.error(d?.message||"Something was wrong!!!")}})()},[e]),l.useEffect(()=>{(async()=>h(d=>({...d,from_time:n,to_time:c})))()},[n,c]),t.jsxs(t.Fragment,{children:[t.jsxs(ae,{className:"flex flex-wrap justify-between items-center px-0",children:[t.jsxs("div",{className:"flex justify-center items-center",children:[t.jsxs(Oe,{to:"/employee-monitor",children:[" ",t.jsx(Ft,{})]}),t.jsx("span",{className:"text-2xl font-semibold leading-[21px] mx-5",children:j})]}),t.jsxs("div",{className:"flex",children:[t.jsx("div",{className:"py-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(be,{defaultValue:v,style:{width:150},onChange:o,options:y})}),t.jsx("div",{className:"p-4 border border-solid border-transparent border-b-[#F5F5F5]",children:t.jsx(Ae,{defaultValue:Ee(i),format:"DD-MM-YYYY",onChange:I})})]})]}),t.jsx("div",{className:"border border-solid border-[#F5F5F5] rounded-lg",children:t.jsx("div",{id:"travel",className:"relative",children:H.projectId&&t.jsx(Vt,{options:H})})})]})}function ei(){l.useState("list");const{employee_id:e}=Re();return t.jsx(t.Fragment,{children:t.jsx(Qt,{employee:e})})}function ai(){return t.jsxs(t.Fragment,{children:[t.jsx(_e,{children:t.jsx("title",{children:" EmployeeMonitor Detail"})}),t.jsx(ei,{})]})}export{ai as default};
