import{Y as n,a3 as i,L as e,N as M,R as V,O as o,a5 as m,a6 as H,V as b,bv as A,a8 as P}from"./index-62sLaIyD.js";import{H as q}from"./header-page--5Xkz2Y-.js";import{C as B}from"./index-9ImTEgSp.js";import{u as h}from"./useDebount-mA3hHcZ0.js";import{e as X}from"./data-u-VkVTNg.js";import{t as z}from"./index-M1R9At94.js";import{D as N}from"./index-4AVz80Fq.js";import{T as W}from"./index-LD_RHdv2.js";import{V as J}from"./VerticalAlignBottomOutlined-xWkH8rEG.js";const Q=b().startOf("month"),U=b().endOf("month"),Z=[{title:"STT",dataIndex:"stt",key:"stt",render:(l,s,x)=>x+1},{title:"Mã nhân viên",dataIndex:"employee_code",key:"employee_code",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.employee_code})},{title:"Tên nhân viên",dataIndex:"employee_name",key:"employee_name",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.employee_name})},{title:"Nhóm bán hàng",dataIndex:"saleperson",key:"saleperson",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.saleperson})},{title:"Ngày",dataIndex:"days",key:"days",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.days})},{title:"Thứ",dataIndex:"date",key:"date",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.date})},{title:"Giờ làm",dataIndex:"startwork",key:"startwork",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.startwork})},{title:"Giờ viếng thăm",dataIndex:"checkin",key:"checkin",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.checkin})},{title:"Số km tự động (km)",dataIndex:"kmauto",key:"kmauto",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmauto})},{title:"Số km di chuyển (km)",dataIndex:"kmmove",key:"kmmove",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmmove})},{title:"Vận tốc (km/h)",dataIndex:"speed",key:"kmmove",render:(l,s)=>e.jsx("div",{className:"!w-[160px]",children:s.kmmove})},{title:"Ghi chú",key:"note",render:()=>e.jsx("div",{className:"!w-[160px]",children:e.jsx("a",{children:"Xem ghi chú"})})}];function $(){const[l,s]=n.useState([]),[x,f]=n.useState([]),[p,S]=n.useState(),[C,F]=n.useState(""),[ee,u]=n.useState();let y=h(C);const[T,te]=n.useState(""),[se,k]=n.useState(""),[I,E]=n.useState([]),[ae,j]=n.useState(""),[G,O]=n.useState("");let v=h(G,500);const[re,g]=n.useState(""),[D,Y]=n.useState([]),[K,L]=n.useState("");let w=h(K,500);h(T,300);const _=t=>{console.log(t)};n.useEffect(()=>{(async()=>{let t=await i.get("/api/method/mbw_dms.api.router.get_team_sale");f(z({data:t.result.map(c=>({title:c.name,value:c.name,...c})),keyValue:"value",parentField:"parent_sales_person"}))})()},[]),n.useEffect(()=>{(async()=>{let t=await i.get("/api/method/mbw_dms.api.router.get_sale_person",{params:{team_sale:p,key_search:y}}),{message:c}=t;s(c.map(r=>({value:r.employee_code,label:r.employee_name||r.employee_code})))})()},[p,y]),n.useEffect(()=>{(async()=>{let t=await i.get("/api/method/frappe.desk.search.search_link",{params:{txt:v,doctype:"Customer Group",ignore_user_permissions:0,query:""}}),{message:c}=t;E(c.map(r=>({value:r.value.trim(),label:r.value.trim()})))})()},[v]),n.useEffect(()=>{(async()=>{let t=await i.get("/api/method/frappe.desk.search.search_link",{params:{txt:w,doctype:"Territory",ignore_user_permissions:0,query:""}}),{message:c}=t;Y(c.map(r=>({value:r.value,label:r.value})))})()},[w]);const R=t=>{const c=[{title:"Khách hàng",dataIndex:"customer",key:"customer",render:(r,a,d)=>e.jsxs("div",{className:"!w-[200]",children:[e.jsx("div",{children:a.customer}),e.jsx("div",{className:"text-[#637381]",children:a.customer_code})]})},{title:"Địa chỉ",dataIndex:"address",key:"address",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.address})})},{title:"Loại khách",dataIndex:"typecustomer",key:"typecustomer",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.typecustomer})})},{title:"Nhóm khách",dataIndex:"groupcustomer",key:"groupcustomer",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.groupcustomer})})},{title:"Số điện thoại",dataIndex:"phonenumber",key:"phonenumber",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.phonenumber})})},{title:"Liên hệ",dataIndex:"contact",key:"contact",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.contact})})},{title:"Checkin",dataIndex:"checkin",key:"checkin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkin})})},{title:"Checkout",dataIndex:"checkout",key:"checkout",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.checkout})})},{title:"Số giờ viếng thăm",dataIndex:"timecheckin",key:"timecheckin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.timecheckin})})},{title:"Địa chỉ checkin",dataIndex:"addresscheckin",key:"addresscheckin",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.addresscheckin})})},{title:"Khoảng cách checkin(km)",dataIndex:"distance",key:"distance",render:(r,a,d)=>e.jsx("div",{className:"!w-[160]",children:e.jsx("div",{children:a.distance})})}];return e.jsx(A,{columns:c,pagination:!1})};return e.jsx(e.Fragment,{children:e.jsx(B,{header:e.jsx(q,{title:"Báo cáo viếng thăm",buttons:[{label:"Xuất dữ liệu",type:"primary",icon:e.jsx(J,{className:"text-xl"}),size:"20px",className:"flex items-center"}]}),children:e.jsxs("div",{className:"bg-white rounded-2xl pt-4 pb-7  border-[#DFE3E8] border-[0.2px] border-solid",children:[e.jsx(M,{layout:"vertical",className:"flex flex-wrap justify-start px-4 items-center",children:e.jsxs(V,{gutter:[8,8],children:[e.jsx(o,{label:"Từ ngày",className:"border-none mr-2 w-[200px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8] !h-7 rounded-lg mt-[-2px]",placeholder:"Từ ngày",onChange:_,defaultValue:Q})}),e.jsx(o,{label:"Đến ngày",className:"border-none mr-2 w-[200px]",children:e.jsx(N,{format:"DD-MM-YYYY",className:"!bg-[#F4F6F8] !h-7 rounded-lg mt-[-2px]",placeholder:"Đến ngày",onChange:_,defaultValue:U})}),e.jsx(o,{label:"Nhóm bán hàng",className:"border-none mr-2 w-[200px]",children:e.jsx(W,{placeholder:"Tất cả nhóm bán hàng",allowClear:!0,treeData:x,onChange:t=>{S(t)},dropdownStyle:{maxHeight:400,overflow:"auto",minWidth:400}})}),e.jsx(o,{label:"Nhân viên",className:"border-none mr-2 w-[200px]",name:"employee",children:e.jsx(m,{filterOption:!1,notFoundContent:null,allowClear:!0,placeholder:"Tất cả nhân viên",onSearch:t=>{F(t)},options:l,onSelect:t=>{u(t)},onClear:()=>{u("")}})}),e.jsx(o,{label:"Loại khách hàng",className:"border-none mr-2 w-[200px]",children:e.jsx(m,{options:X,placeholder:"Tất cả loại khách hàng",filterOption:!1,allowClear:!0,onSelect:t=>{k(t)},onClear:()=>k("")})}),e.jsx(o,{label:"Nhóm khác hàng",className:"border-none mr-2 w-[200px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:I,onSelect:t=>{j(t)},onSearch:t=>{O(t)},onClear:()=>j(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả nhóm khách hàng"})}),e.jsx(o,{label:"Khu vực",className:"border-none mr-2 w-[200px]",children:e.jsx(m,{className:"!bg-[#F4F6F8] options:bg-[#F4F6F8]",options:D,onSelect:t=>{g(t)},onSearch:t=>{L(t)},onClear:()=>g(""),filterOption:!1,allowClear:!0,placeholder:"Tất cả khu vực"})})]})}),e.jsx("div",{className:"pt-5",children:e.jsx(H,{bordered:!0,scroll:{x:!0},columns:Z,expandable:{expandedRowRender:R,defaultExpandedRowKeys:["0"]}})})]})})})}function pe(){return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx("title",{children:" ReportCheckin"})}),e.jsx($,{})]})}export{pe as default};
